

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Obtaining, installing, and validating QMCPACK &mdash; QMC Manual 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Specifying the Simulation Cell" href="simulationcell.html" />
    <link rel="prev" title="Features of QMCPACK" href="features.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> QMC Manual
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="features.html">Features of QMCPACK</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Obtaining, installing, and validating QMCPACK</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation-steps">Installation steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="#obtaining-the-latest-release-version">Obtaining the latest release version</a></li>
<li class="toctree-l2"><a class="reference internal" href="#obtaining-the-latest-development-version">Obtaining the latest development version</a></li>
<li class="toctree-l2"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#c-14-standard-library">C++ 14 standard library</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#intel-compiler">Intel compiler</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#building-with-cmake">Building with CMake</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#quick-build-instructions-try-first">Quick build instructions (try first)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#environment-variables">Environment variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-options">Configuration Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation-from-cmake">Installation from CMake</a></li>
<li class="toctree-l3"><a class="reference internal" href="#role-of-qmc-data">Role of QMC_DATA</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configure-and-build-using-cmake-and-make">Configure and build using CMake and make</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-configure-and-build">Example configure and build</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-scripts">Build scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-vendor-optimized-numerical-libraries-e-g-intel-mkl">Using vendor-optimized numerical libraries (e.g., Intel MKL)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="simulationcell.html">Specifying the Simulation Cell</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">QMC Manual</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Obtaining, installing, and validating QMCPACK</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/installation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="obtaining-installing-and-validating-qmcpack">
<span id="obtaininginstalling"></span><h1>Obtaining, installing, and validating QMCPACK<a class="headerlink" href="#obtaining-installing-and-validating-qmcpack" title="Permalink to this headline">¶</a></h1>
<p>This chapter describes how to obtain, build, and validate QMCPACK. This
process is designed to be as simple as possible and should be no harder
than building a modern plane-wave density functional theory code such as
Quantum ESPRESSO, QBox, or VASP. Parallel builds enable a complete
compilation in under 2 minutes on a fast multicore system. If you are
unfamiliar with building codes we suggest working with your system
administrator to install QMCPACK.</p>
<div class="section" id="installation-steps">
<h2>Installation steps<a class="headerlink" href="#installation-steps" title="Permalink to this headline">¶</a></h2>
<p>To install QMCPACK, follow the steps below. Full details of each step
are given in the referenced sections.</p>
<ol class="arabic simple">
<li><p>Download the source code from <a class="reference internal" href="#obrelease"><span class="std std-ref">Obtaining the latest release version</span></a>
or <a class="reference internal" href="#obdevelopment"><span class="std std-ref">Obtaining the latest development version</span></a>.</p></li>
<li><p>Verify that you have the required compilers, libraries, and tools
installed (<a class="reference internal" href="#prerequisites"><span class="std std-ref">Prerequisites</span></a>).</p></li>
<li><p>If you will use Quantum ESPRESSO, download and patch it. The patch
adds the pw2qmcpack utility
(<span class="xref std std-ref">buildqe</span>).</p></li>
<li><p>Run the cmake configure step and build with make
(<a class="reference internal" href="#cmake"><span class="std std-ref">Building with CMake</span></a> and <a class="reference internal" href="#cmakequick"><span class="std std-ref">Quick build instructions (try first)</span></a>). Examples for
common systems are given in
<span class="xref std std-ref">installexamples</span>.</p></li>
<li><p>Run the tests to verify QMCPACK
(<span class="xref std std-ref">testing</span>).</p></li>
<li><p>Build the ppconvert utility in QMCPACK
(<span class="xref std std-ref">buildppconvert</span>).</p></li>
</ol>
<p>Hints for high performance are in
<span class="xref std std-ref">buildperformance</span>.
Troubleshooting suggestions are in
<span class="xref std std-ref">troubleshoot</span>.</p>
<p>Note that there are two different QMCPACK executables that can be
produced: the general one, which is the default, and the “complex”
version, which supports periodic calculations at arbitrary twist angles
and k-points. This second version is enabled via a cmake configuration
parameter (see <a class="reference internal" href="#cmakeoptions"><span class="std std-ref">Configuration Options</span></a>).
The general version supports only wavefunctions that can be made real.
If you run a calculation that needs the complex version, QMCPACK will
stop and inform you.</p>
</div>
<div class="section" id="obtaining-the-latest-release-version">
<span id="obrelease"></span><h2>Obtaining the latest release version<a class="headerlink" href="#obtaining-the-latest-release-version" title="Permalink to this headline">¶</a></h2>
<p>Major releases of QMCPACK are distributed from <a class="reference external" href="http://www.qmcpack.org">http://www.qmcpack.org</a>.
Because these versions undergo the most testing, we encourage using them
for all production calculations unless there are specific reasons not to
do so.</p>
<p>Releases are usually compressed tar files that indicate the version
number, date, and often the source code revision control number
corresponding to the release. To obtain the latest release:</p>
<ul class="simple">
<li><p>Download the latest QMCPACK distribution from <a class="reference external" href="http://www.qmcpack.org">http://www.qmcpack.org</a>.</p></li>
<li><p>Untar the archive (e.g., <code class="docutils literal notranslate"><span class="pre">tar</span> <span class="pre">xvf</span> <span class="pre">qmcpack_v1.3.tar.gz</span></code>).</p></li>
</ul>
<p>Releases can also be obtained from the ‘master’ branch of the QMCPACK
git repository, similar to obtaining the development version
(<a class="reference internal" href="#obdevelopment"><span class="std std-ref">Obtaining the latest development version</span></a>).</p>
</div>
<div class="section" id="obtaining-the-latest-development-version">
<span id="obdevelopment"></span><h2>Obtaining the latest development version<a class="headerlink" href="#obtaining-the-latest-development-version" title="Permalink to this headline">¶</a></h2>
<p>The most recent development version of QMCPACK can be obtained
anonymously via</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">QMCPACK</span><span class="o">/</span><span class="n">qmcpack</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>Once checked out, updates can be made via the standard <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span></code>.</p>
<p>The ‘develop’ branch of the git repository contains the day-to-day
development source with the latest updates, bug fixes, etc. This version
might be useful for updates to the build system to support new machines,
for support of the latest versions of Quantum ESPRESSO, or for updates
to the documentation. Note that the development version might not be
fully consistent with the online documentation. We attempt to keep the
development version fully working. However, please be sure to run tests
and compare with previous release versions before using for any serious
calculations. We try to keep bugs out, but occasionally they crawl in!
Reports of any breakages are appreciated.</p>
</div>
<div class="section" id="prerequisites">
<span id="id1"></span><h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<p>The following items are required to build QMCPACK. For workstations,
these are available via the standard package manager. On shared
supercomputers this software is usually installed by default and is
often accessed via a modules environment—check your system
documentation.</p>
<p><strong>Use of the latest versions of all compilers and libraries is strongly
encouraged</strong> but not absolutely essential. Generally, newer versions are
faster; see <span class="xref std std-ref">buildperformance</span>
for performance suggestions.</p>
<ul class="simple">
<li><p>C/C++ compilers such as GNU, Clang, Intel, and IBM XL. C++ compilers
are required to support the C++ 14 standard. Use of recent (“current
year version”) compilers is strongly encouraged.</p></li>
<li><p>An MPI library such as OpenMPI (<a class="reference external" href="http://open-mpi.org">http://open-mpi.org</a>) or a
vendor-optimized MPI.</p></li>
<li><p>BLAS/LAPACK, numerical, and linear algebra libraries. Use
platform-optimized libraries where available, such as Intel MKL.
ATLAS or other optimized open source libraries can also be used
(<a class="reference external" href="http://math-atlas.sourceforge.net">http://math-atlas.sourceforge.net</a>).</p></li>
<li><p>CMake, build utility (<a class="reference external" href="http://www.cmake.org">http://www.cmake.org</a>).</p></li>
<li><p>Libxml2, XML parser (<a class="reference external" href="http://xmlsoft.org">http://xmlsoft.org</a>).</p></li>
<li><p>HDF5, portable I/O library (<a class="reference external" href="http://www.hdfgroup.org/HDF5/">http://www.hdfgroup.org/HDF5/</a>). Good
performance at large scale requires parallel version <span class="math notranslate nohighlight">\(&gt;=\)</span> 1.10.</p></li>
<li><p>BOOST, peer-reviewed portable C++ source libraries
(<a class="reference external" href="http://www.boost.org">http://www.boost.org</a>). Minimum version is 1.61.0.</p></li>
<li><p>FFTW, FFT library (<a class="reference external" href="http://www.fftw.org/">http://www.fftw.org/</a>).</p></li>
</ul>
<p>To build the GPU accelerated version of QMCPACK, an installation of
NVIDIA CUDA development tools is required. Ensure that this is
compatible with the C and C++ compiler versions you plan to use.
Supported versions are included in the NVIDIA release notes.</p>
<p>Many of the utilities provided with QMCPACK use Python (v2). The numpy
and matplotlib libraries are required for full functionality.</p>
<p>Note that the standalone einspline library used by previous versions of
QMCPACK is no longer required. A more optimized version is included
inside. The standalone version should <em>not</em> be on any standard search
paths because conflicts between the old and new include files can
result.</p>
</div>
<div class="section" id="c-14-standard-library">
<h2>C++ 14 standard library<a class="headerlink" href="#c-14-standard-library" title="Permalink to this headline">¶</a></h2>
<p>The C++ standard consists of language features—which are implemented in
the compiler—and library features—which are implemented in the standard
library. GCC includes its own standard library and headers, but many
compilers do not and instead reuse those from an existing GCC install.
Depending on setup and installation, some of these compilers might not
default to using a GCC with C++ 14 headers (e.g., GCC 4.8 is common as a
base system compiler, but its standard library only supports C++ 11).</p>
<p>The symptom of having header files that do not support the C++ 14
standard is usually compile errors involving standard include header
files. Look for the GCC library version, which should be present in the
path to the include file in the error message, and ensure that it is 5.0
or greater. To avoid these errors occurring at compile time, QMCPACK
tests for a C++ 14 standard library during configuration and will halt
with an error if one is not found.</p>
<p>At sites that use modules, running is often sufficient to load a newer
GCC and resolve the issue.</p>
<div class="section" id="intel-compiler">
<h3>Intel compiler<a class="headerlink" href="#intel-compiler" title="Permalink to this headline">¶</a></h3>
<p>The Intel compiler version must be 18 or newer. The version 17 compiler
cannot compile some of the C++ 14 constructs in the code.</p>
<p>If a newer GCC is needed, the <code class="docutils literal notranslate"><span class="pre">-cxxlib</span></code> option can be used to point to a different
GCC installation. (Alternately, the <code class="docutils literal notranslate"><span class="pre">-gcc-name</span></code> or <code class="docutils literal notranslate"><span class="pre">-gxx-name</span></code> options can be used.) Be sure to
pass this flag to the C compiler in addition to the C++ compiler. This
is necessary because CMake extracts some library paths from the C
compiler, and those paths usually also contain to the C++ library. The
symptom of this problem is C++ 14 standard library functions not found
at link time.</p>
</div>
</div>
<div class="section" id="building-with-cmake">
<span id="cmake"></span><h2>Building with CMake<a class="headerlink" href="#building-with-cmake" title="Permalink to this headline">¶</a></h2>
<p>The build system for QMCPACK is based on CMake. It will autoconfigure
based on the detected compilers and libraries. The most recent version
of CMake has the best detection for the greatest variety of systems. The
minimum required version of CMake is 3.6, which is the oldest version to
support correct application of C++ 14 flags for the Intel compiler. Most
computer installations have a sufficiently recent CMake, though it might
not be the default.</p>
<p>If no appropriate version CMake is available, building it from source is
straightforward. Download a version from <a class="reference external" href="https://cmake.org/download/">https://cmake.org/download/</a> and
unpack the files. Run <code class="docutils literal notranslate"><span class="pre">./bootstrap</span></code> from the CMake directory, and then run <code class="docutils literal notranslate"><span class="pre">make</span></code> when that
finishes. The resulting CMake executable will be in the directory. The
executable can be run directly from that location.</p>
<p>Previously, QMCPACK made extensive use of toolchains, but the build
system has since been updated to eliminate the use of toolchain files
for most cases. The build system is verified to work with GNU, Intel,
and IBM XLC compilers. Specific compile options can be specified either
through specific environment or CMake variables. When the libraries are
installed in standard locations (e.g., /usr, /usr/local), there is no
need to set environment or CMake variables for the packages.</p>
<div class="section" id="quick-build-instructions-try-first">
<span id="cmakequick"></span><h3>Quick build instructions (try first)<a class="headerlink" href="#quick-build-instructions-try-first" title="Permalink to this headline">¶</a></h3>
<p>If you are feeling lucky and are on a standard UNIX-like system such as
a Linux workstation, the following might quickly give a working QMCPACK:</p>
<p>The safest quick build option is to specify the C and C++ compilers
through their MPI wrappers. Here we use Intel MPI and Intel compilers.
Move to the build directory, run CMake, and make</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">build</span>
<span class="n">cmake</span> <span class="o">-</span><span class="n">DCMAKE_C_COMPILER</span><span class="o">=</span><span class="n">mpiicc</span> <span class="o">-</span><span class="n">DCMAKE_CXX_COMPILER</span><span class="o">=</span><span class="n">mpiicpc</span> <span class="o">..</span>
<span class="n">make</span> <span class="o">-</span><span class="n">j</span> <span class="mi">8</span>
</pre></div>
</div>
<p>You can increase the “8” to the number of cores on your system for
faster builds. Substitute mpicc and mpicxx or other wrapped compiler names to suit
your system. For example, with OpenMPI use</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">build</span>
<span class="n">cmake</span> <span class="o">-</span><span class="n">DCMAKE_C_COMPILER</span><span class="o">=</span><span class="n">mpicc</span> <span class="o">-</span><span class="n">DCMAKE_CXX_COMPILER</span><span class="o">=</span><span class="n">mpicxx</span> <span class="o">..</span>
<span class="n">make</span> <span class="o">-</span><span class="n">j</span> <span class="mi">8</span>
</pre></div>
</div>
<p>If you are feeling particularly lucky, you can skip the compiler specification:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">build</span>
<span class="n">cmake</span> <span class="o">..</span>
<span class="n">make</span> <span class="o">-</span><span class="n">j</span> <span class="mi">8</span>
</pre></div>
</div>
<p>The complexities of modern computer hardware and software systems are
such that you should check that the autoconfiguration system has made
good choices and picked optimized libraries and compiler settings
before doing significant production. That is, check the following details. We
give examples for a number of common systems in <span class="xref std std-ref">installexamples</span>.</p>
</div>
<div class="section" id="environment-variables">
<span id="envvar"></span><h3>Environment variables<a class="headerlink" href="#environment-variables" title="Permalink to this headline">¶</a></h3>
<p>A number of environment variables affect the build.  In particular
they can control the default paths for libraries, the default
compilers, etc.  The list of environment variables is given below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CXX</span>              <span class="n">C</span><span class="o">++</span> <span class="n">compiler</span>
<span class="n">CC</span>               <span class="n">C</span> <span class="n">Compiler</span>
<span class="n">MKL_ROOT</span>         <span class="n">Path</span> <span class="k">for</span> <span class="n">MKL</span>
<span class="n">HDF5_ROOT</span>        <span class="n">Path</span> <span class="k">for</span> <span class="n">HDF5</span>
<span class="n">BOOST_ROOT</span>       <span class="n">Path</span> <span class="k">for</span> <span class="n">Boost</span>
<span class="n">FFTW_HOME</span>        <span class="n">Path</span> <span class="k">for</span> <span class="n">FFTW</span>
</pre></div>
</div>
</div>
<div class="section" id="configuration-options">
<span id="cmakeoptions"></span><h3>Configuration Options<a class="headerlink" href="#configuration-options" title="Permalink to this headline">¶</a></h3>
<p>In addition to reading the environment variables, CMake provides a
number of optional variables that can be set to control the build and
configure steps.  When passed to CMake, these variables will take
precedent over the environment and default variables.  To set them,
add -D FLAG=VALUE to the configure line between the CMake command and
the path to the source directory.</p>
<ul>
<li><p>Key QMCPACK build options</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">QMC_CUDA</span>              <span class="n">Enable</span> <span class="n">CUDA</span> <span class="ow">and</span> <span class="n">GPU</span> <span class="n">acceleration</span> <span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">yes</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">no</span><span class="p">)</span>
<span class="n">QMC_COMPLEX</span>           <span class="n">Build</span> <span class="n">the</span> <span class="nb">complex</span> <span class="p">(</span><span class="n">general</span> <span class="n">twist</span><span class="o">/</span><span class="n">k</span><span class="o">-</span><span class="n">point</span><span class="p">)</span> <span class="n">version</span> <span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">yes</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">no</span><span class="p">)</span>
<span class="n">QMC_MIXED_PRECISION</span>   <span class="n">Build</span> <span class="n">the</span> <span class="n">mixed</span> <span class="n">precision</span> <span class="p">(</span><span class="n">mixing</span> <span class="n">double</span><span class="o">/</span><span class="nb">float</span><span class="p">)</span> <span class="n">version</span>
                      <span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">yes</span> <span class="p">(</span><span class="n">GPU</span> <span class="n">default</span><span class="p">),</span> <span class="mi">0</span><span class="p">:</span><span class="n">no</span> <span class="p">(</span><span class="n">CPU</span> <span class="n">default</span><span class="p">))</span><span class="o">.</span>
                      <span class="n">The</span> <span class="n">CPU</span> <span class="n">support</span> <span class="ow">is</span> <span class="n">experimental</span><span class="o">.</span>
                      <span class="n">Use</span> <span class="nb">float</span> <span class="ow">and</span> <span class="n">double</span> <span class="k">for</span> <span class="n">base</span> <span class="ow">and</span> <span class="n">full</span> <span class="n">precision</span><span class="o">.</span>
                      <span class="n">The</span> <span class="n">GPU</span> <span class="n">support</span> <span class="ow">is</span> <span class="n">quite</span> <span class="n">mature</span><span class="o">.</span>
                      <span class="n">Use</span> <span class="n">always</span> <span class="n">double</span> <span class="k">for</span> <span class="n">host</span> <span class="n">side</span> <span class="n">base</span> <span class="ow">and</span> <span class="n">full</span> <span class="n">precision</span>
                      <span class="ow">and</span> <span class="n">use</span> <span class="nb">float</span> <span class="ow">and</span> <span class="n">double</span> <span class="k">for</span> <span class="n">CUDA</span> <span class="n">base</span> <span class="ow">and</span> <span class="n">full</span> <span class="n">precision</span><span class="o">.</span>
<span class="n">ENABLE_SOA</span>            <span class="n">Enable</span> <span class="n">data</span> <span class="n">layout</span> <span class="ow">and</span> <span class="n">algorithm</span> <span class="n">optimizations</span> <span class="n">using</span>
                      <span class="n">Structure</span><span class="o">-</span><span class="n">of</span><span class="o">-</span><span class="n">Array</span> <span class="p">(</span><span class="n">SoA</span><span class="p">)</span> <span class="n">datatypes</span> <span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">yes</span> <span class="p">(</span><span class="n">default</span><span class="p">),</span> <span class="mi">0</span><span class="p">:</span><span class="n">no</span><span class="p">)</span><span class="o">.</span>
<span class="n">ENABLE_TIMERS</span>         <span class="n">Enable</span> <span class="n">fine</span><span class="o">-</span><span class="n">grained</span> <span class="n">timers</span> <span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">yes</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">no</span> <span class="p">(</span><span class="n">default</span><span class="p">))</span><span class="o">.</span>
                      <span class="n">Timers</span> <span class="n">are</span> <span class="n">off</span> <span class="n">by</span> <span class="n">default</span> <span class="n">to</span> <span class="n">avoid</span> <span class="n">potential</span> <span class="n">slowdown</span> <span class="ow">in</span> <span class="n">small</span>
                      <span class="n">systems</span><span class="o">.</span> <span class="n">For</span> <span class="n">large</span> <span class="n">systems</span> <span class="p">(</span><span class="mi">100</span><span class="o">+</span> <span class="n">electrons</span><span class="p">)</span> <span class="n">there</span> <span class="ow">is</span> <span class="n">no</span> <span class="n">risk</span><span class="o">.</span>
</pre></div>
</div>
</li>
<li><p>General build options</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CMAKE_BUILD_TYPE</span>     <span class="n">A</span> <span class="n">variable</span> <span class="n">which</span> <span class="n">controls</span> <span class="n">the</span> <span class="nb">type</span> <span class="n">of</span> <span class="n">build</span>
                     <span class="p">(</span><span class="n">defaults</span> <span class="n">to</span> <span class="n">Release</span><span class="p">)</span><span class="o">.</span> <span class="n">Possible</span> <span class="n">values</span> <span class="n">are</span><span class="p">:</span>
                     <span class="kc">None</span> <span class="p">(</span><span class="n">Do</span> <span class="ow">not</span> <span class="nb">set</span> <span class="n">debug</span><span class="o">/</span><span class="n">optmize</span> <span class="n">flags</span><span class="p">,</span> <span class="n">use</span>
                     <span class="n">CMAKE_C_FLAGS</span> <span class="ow">or</span> <span class="n">CMAKE_CXX_FLAGS</span><span class="p">)</span>
                     <span class="n">Debug</span> <span class="p">(</span><span class="n">create</span> <span class="n">a</span> <span class="n">debug</span> <span class="n">build</span><span class="p">)</span>
                     <span class="n">Release</span> <span class="p">(</span><span class="n">create</span> <span class="n">a</span> <span class="n">release</span><span class="o">/</span><span class="n">optimized</span> <span class="n">build</span><span class="p">)</span>
                     <span class="n">RelWithDebInfo</span> <span class="p">(</span><span class="n">create</span> <span class="n">a</span> <span class="n">release</span><span class="o">/</span><span class="n">optimized</span> <span class="n">build</span> <span class="k">with</span> <span class="n">debug</span> <span class="n">info</span><span class="p">)</span>
                     <span class="n">MinSizeRel</span> <span class="p">(</span><span class="n">create</span> <span class="n">an</span> <span class="n">executable</span> <span class="n">optimized</span> <span class="k">for</span> <span class="n">size</span><span class="p">)</span>
<span class="n">CMAKE_C_COMPILER</span>     <span class="n">Set</span> <span class="n">the</span> <span class="n">C</span> <span class="n">compiler</span>
<span class="n">CMAKE_CXX_COMPILER</span>   <span class="n">Set</span> <span class="n">the</span> <span class="n">C</span><span class="o">++</span> <span class="n">compiler</span>
<span class="n">CMAKE_C_FLAGS</span>        <span class="n">Set</span> <span class="n">the</span> <span class="n">C</span> <span class="n">flags</span><span class="o">.</span>  <span class="n">Note</span><span class="p">:</span> <span class="n">to</span> <span class="n">prevent</span> <span class="n">default</span>
                     <span class="n">debug</span><span class="o">/</span><span class="n">release</span> <span class="n">flags</span> <span class="kn">from</span> <span class="nn">being</span> <span class="n">used</span><span class="p">,</span> <span class="nb">set</span> <span class="n">the</span> <span class="n">CMAKE_BUILD_TYPE</span><span class="o">=</span><span class="kc">None</span>
                     <span class="n">Also</span> <span class="n">supported</span><span class="p">:</span> <span class="n">CMAKE_C_FLAGS_DEBUG</span><span class="p">,</span>
                     <span class="n">CMAKE_C_FLAGS_RELEASE</span><span class="p">,</span> <span class="ow">and</span> <span class="n">CMAKE_C_FLAGS_RELWITHDEBINFO</span>
<span class="n">CMAKE_CXX_FLAGS</span>      <span class="n">Set</span> <span class="n">the</span> <span class="n">C</span><span class="o">++</span> <span class="n">flags</span><span class="o">.</span>  <span class="n">Note</span><span class="p">:</span> <span class="n">to</span> <span class="n">prevent</span> <span class="n">default</span>
                     <span class="n">debug</span><span class="o">/</span><span class="n">release</span> <span class="n">flags</span> <span class="kn">from</span> <span class="nn">being</span> <span class="n">used</span><span class="p">,</span> <span class="nb">set</span> <span class="n">the</span> <span class="n">CMAKE_BUILD_TYPE</span><span class="o">=</span><span class="kc">None</span>
                     <span class="n">Also</span> <span class="n">supported</span><span class="p">:</span> <span class="n">CMAKE_CXX_FLAGS_DEBUG</span><span class="p">,</span>
                     <span class="n">CMAKE_CXX_FLAGS_RELEASE</span><span class="p">,</span> <span class="ow">and</span> <span class="n">CMAKE_CXX_FLAGS_RELWITHDEBINFO</span>
<span class="n">CMAKE_INSTALL_PREFIX</span> <span class="n">Set</span> <span class="n">the</span> <span class="n">install</span> <span class="n">location</span> <span class="p">(</span><span class="k">if</span> <span class="n">using</span> <span class="n">the</span> <span class="n">optional</span> <span class="n">install</span> <span class="n">step</span><span class="p">)</span>
<span class="n">INSTALL_NEXUS</span>        <span class="n">Install</span> <span class="n">Nexus</span> <span class="n">alongside</span> <span class="n">QMCPACK</span> <span class="p">(</span><span class="k">if</span> <span class="n">using</span> <span class="n">the</span> <span class="n">optional</span> <span class="n">install</span> <span class="n">step</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Additional QMCPACK build options</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">QE_BIN</span>                    <span class="n">Location</span> <span class="n">of</span> <span class="n">Quantum</span> <span class="n">Espresso</span> <span class="n">binaries</span> <span class="n">including</span> <span class="n">pw2qmcpack</span><span class="o">.</span><span class="n">x</span>
<span class="n">QMC_DATA</span>                  <span class="n">Specify</span> <span class="n">data</span> <span class="n">directory</span> <span class="k">for</span> <span class="n">QMCPACK</span> <span class="n">performance</span> <span class="ow">and</span> <span class="n">integration</span> <span class="n">tests</span>
<span class="n">QMC_INCLUDE</span>               <span class="n">Add</span> <span class="n">extra</span> <span class="n">include</span> <span class="n">paths</span>
<span class="n">QMC_EXTRA_LIBS</span>            <span class="n">Add</span> <span class="n">extra</span> <span class="n">link</span> <span class="n">libraries</span>
<span class="n">QMC_BUILD_STATIC</span>          <span class="n">Add</span> <span class="o">-</span><span class="n">static</span> <span class="n">flags</span> <span class="n">to</span> <span class="n">build</span>
<span class="n">QMC_SYMLINK_TEST_FILES</span>    <span class="n">Set</span> <span class="n">to</span> <span class="n">zero</span> <span class="n">to</span> <span class="n">require</span> <span class="n">test</span> <span class="n">files</span> <span class="n">to</span> <span class="n">be</span> <span class="n">copied</span><span class="o">.</span> <span class="n">Avoids</span> <span class="n">space</span>
                          <span class="n">saving</span> <span class="n">default</span> <span class="n">use</span> <span class="n">of</span> <span class="n">symbolic</span> <span class="n">links</span> <span class="k">for</span> <span class="n">test</span> <span class="n">files</span><span class="o">.</span> <span class="n">Useful</span>
                          <span class="k">if</span> <span class="n">the</span> <span class="n">build</span> <span class="ow">is</span> <span class="n">on</span> <span class="n">a</span> <span class="n">separate</span> <span class="n">filesystem</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">source</span><span class="p">,</span> <span class="k">as</span>
                          <span class="n">required</span> <span class="n">on</span> <span class="n">some</span> <span class="n">HPC</span> <span class="n">systems</span><span class="o">.</span>
<span class="n">QMC_VERBOSE_CONFIGURATION</span> <span class="n">Print</span> <span class="n">additional</span> <span class="n">information</span> <span class="n">during</span> <span class="n">cmake</span> <span class="n">configuration</span>
                          <span class="n">including</span> <span class="n">details</span> <span class="n">of</span> <span class="n">which</span> <span class="n">tests</span> <span class="n">are</span> <span class="n">enabled</span><span class="o">.</span>
</pre></div>
</div>
</li>
<li><p>Intel MKL related</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ENABLE_MKL</span>          <span class="n">Enable</span> <span class="n">Intel</span> <span class="n">MKL</span> <span class="n">libraries</span> <span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">yes</span> <span class="p">(</span><span class="n">default</span> <span class="k">for</span> <span class="n">intel</span> <span class="n">compiler</span><span class="p">),</span>
                                              <span class="mi">0</span><span class="p">:</span><span class="n">no</span> <span class="p">(</span><span class="n">default</span> <span class="n">otherwise</span><span class="p">))</span><span class="o">.</span>
<span class="n">MKL_ROOT</span>            <span class="n">Path</span> <span class="n">to</span> <span class="n">MKL</span> <span class="n">libraries</span> <span class="p">(</span><span class="n">only</span> <span class="n">necessary</span> <span class="k">for</span> <span class="n">non</span> <span class="n">intel</span> <span class="n">compilers</span>
                    <span class="ow">or</span> <span class="n">intel</span> <span class="n">without</span> <span class="n">standard</span> <span class="n">environment</span> <span class="n">variables</span><span class="o">.</span><span class="p">)</span>
                    <span class="n">One</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">environment</span> <span class="n">variables</span> <span class="n">can</span> <span class="n">be</span> <span class="n">used</span><span class="o">.</span>
</pre></div>
</div>
</li>
<li><p>libxml2 related</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LIBXML2_INCLUDE_DIR</span>   <span class="n">Include</span> <span class="n">directory</span> <span class="k">for</span> <span class="n">libxml2</span>

<span class="n">LIBXML2_LIBRARY</span>       <span class="n">Libxml2</span> <span class="n">library</span>
</pre></div>
</div>
</li>
<li><p>HDF5 related</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HDF5_PREFER_PARALLEL</span> <span class="mi">1</span><span class="p">(</span><span class="n">default</span> <span class="k">for</span> <span class="n">MPI</span> <span class="n">build</span><span class="p">)</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span> <span class="n">enables</span><span class="o">/</span><span class="n">disable</span> <span class="n">parallel</span> <span class="n">HDF5</span> <span class="n">library</span> <span class="n">searching</span><span class="o">.</span>
<span class="n">ENABLE_PHDF5</span>         <span class="mi">1</span><span class="p">(</span><span class="n">default</span> <span class="k">for</span> <span class="n">parallel</span> <span class="n">HDF5</span> <span class="n">library</span><span class="p">)</span><span class="o">/</span><span class="mi">0</span><span class="p">,</span> <span class="n">enables</span><span class="o">/</span><span class="n">disable</span> <span class="n">parallel</span> <span class="n">collective</span> <span class="n">I</span><span class="o">/</span><span class="n">O</span><span class="o">.</span>
</pre></div>
</div>
</li>
<li><p>FFTW related</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FFTW_INCLUDE_DIRS</span>   <span class="n">Specify</span> <span class="n">include</span> <span class="n">directories</span> <span class="k">for</span> <span class="n">FFTW</span>
<span class="n">FFTW_LIBRARY_DIRS</span>   <span class="n">Specify</span> <span class="n">library</span> <span class="n">directories</span> <span class="k">for</span> <span class="n">FFTW</span>
</pre></div>
</div>
</li>
<li><p>CTest related</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MPIEXEC_EXECUTABLE</span>     <span class="n">Specify</span> <span class="n">the</span> <span class="n">mpi</span> <span class="n">wrapper</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="n">srun</span><span class="p">,</span> <span class="n">aprun</span><span class="p">,</span> <span class="n">mpirun</span><span class="p">,</span> <span class="n">etc</span><span class="o">.</span>
<span class="n">MPIEXEC_NUMPROC_FLAG</span>   <span class="n">Specify</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">mpi</span> <span class="n">processes</span> <span class="n">flag</span><span class="p">,</span>
                       <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="s2">&quot;-n&quot;</span><span class="p">,</span> <span class="s2">&quot;-np&quot;</span><span class="p">,</span> <span class="n">etc</span><span class="o">.</span>
<span class="n">MPIEXEC_PREFLAGS</span>       <span class="n">Flags</span> <span class="n">to</span> <span class="k">pass</span> <span class="n">to</span> <span class="n">MPIEXEC_EXECUTABLE</span> <span class="n">directly</span> <span class="n">before</span> <span class="n">the</span> <span class="n">executable</span> <span class="n">to</span> <span class="n">run</span><span class="o">.</span>
</pre></div>
</div>
</li>
<li><p>LLVM/Clang Developer Options</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LLVM_SANITIZE_ADDRES</span>  <span class="n">link</span> <span class="k">with</span> <span class="n">the</span> <span class="n">Clang</span> <span class="n">address</span> <span class="n">sanitizer</span> <span class="n">library</span>
<span class="n">LLVM_SANITIZE_MEMORY</span>  <span class="n">link</span> <span class="k">with</span> <span class="n">the</span> <span class="n">Clang</span> <span class="n">memory</span> <span class="n">sanitizer</span> <span class="n">library</span>
</pre></div>
</div>
</li>
</ul>
<p><a class="reference external" href="https://clang.llvm.org/docs/AddressSanitizer.html">Clang address sanitizer library</a></p>
<p><a class="reference external" href="https://clang.llvm.org/docs/MemorySanitizer.html">Clang memory sanitizer library</a></p>
<p>See <span class="xref std std-ref">LLVM-Sanitizer-Libraries</span> for more information.</p>
</div>
<div class="section" id="installation-from-cmake">
<h3>Installation from CMake<a class="headerlink" href="#installation-from-cmake" title="Permalink to this headline">¶</a></h3>
<p>Installation is optional. The QMCPACK executable can be run from the <code class="docutils literal notranslate"><span class="pre">bin</span></code> directory in the build location.
If the install step is desired, run the <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">install</span></code> command to install the QMCPACK executable, the converter,
and some additional executables.
Also installed is the <code class="docutils literal notranslate"><span class="pre">qmcpack.settings</span></code> file that records options used to compile QMCPACK.
Specify the <code class="docutils literal notranslate"><span class="pre">CMAKE_INSTALL_PREFIX</span></code> CMake variable during configuration to set the install location.</p>
</div>
<div class="section" id="role-of-qmc-data">
<h3>Role of QMC_DATA<a class="headerlink" href="#role-of-qmc-data" title="Permalink to this headline">¶</a></h3>
<p>QMCPACK includes a variety of optional performance and integration
tests that use research quality wavefunctions to obtain meaningful
performance and to more thoroughly test the code. The necessarily
large input files are stored in the location pointed to by QMC_DATA (e.g., scratch or long-lived project space on a supercomputer). These
files are not included in the source code distribution to minimize
size. The tests are activated if CMake detects the files when
configured. See tests/performance/NiO/README,
tests/solids/NiO_afqmc/README, tests/performance/C-graphite/README, and tests/performance/C-molecule/README
for details of the current tests and input files and to download them.</p>
<p>Currently the files must be downloaded via <a class="reference external" href="https://anl.box.com/s/yxz1ic4kxtdtgpva5hcmlom9ixfl3v3c">https://anl.box.com/s/yxz1ic4kxtdtgpva5hcmlom9ixfl3v3c</a>.</p>
<p>The layout of current complete set of files is given below. If a file is missing, the appropriate performance test is skipped.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">QMC_DATA</span><span class="o">/</span><span class="n">C</span><span class="o">-</span><span class="n">graphite</span><span class="o">/</span><span class="n">lda</span><span class="o">.</span><span class="n">pwscf</span><span class="o">.</span><span class="n">h5</span>
<span class="n">QMC_DATA</span><span class="o">/</span><span class="n">C</span><span class="o">-</span><span class="n">molecule</span><span class="o">/</span><span class="n">C12</span><span class="o">-</span><span class="n">e48</span><span class="o">-</span><span class="n">pp</span><span class="o">.</span><span class="n">h5</span>
<span class="n">QMC_DATA</span><span class="o">/</span><span class="n">C</span><span class="o">-</span><span class="n">molecule</span><span class="o">/</span><span class="n">C12</span><span class="o">-</span><span class="n">e72</span><span class="o">-</span><span class="n">ae</span><span class="o">.</span><span class="n">h5</span>
<span class="n">QMC_DATA</span><span class="o">/</span><span class="n">C</span><span class="o">-</span><span class="n">molecule</span><span class="o">/</span><span class="n">C18</span><span class="o">-</span><span class="n">e108</span><span class="o">-</span><span class="n">ae</span><span class="o">.</span><span class="n">h5</span>
<span class="n">QMC_DATA</span><span class="o">/</span><span class="n">C</span><span class="o">-</span><span class="n">molecule</span><span class="o">/</span><span class="n">C18</span><span class="o">-</span><span class="n">e72</span><span class="o">-</span><span class="n">pp</span><span class="o">.</span><span class="n">h5</span>
<span class="n">QMC_DATA</span><span class="o">/</span><span class="n">C</span><span class="o">-</span><span class="n">molecule</span><span class="o">/</span><span class="n">C24</span><span class="o">-</span><span class="n">e144</span><span class="o">-</span><span class="n">ae</span><span class="o">.</span><span class="n">h5</span>
<span class="n">QMC_DATA</span><span class="o">/</span><span class="n">C</span><span class="o">-</span><span class="n">molecule</span><span class="o">/</span><span class="n">C24</span><span class="o">-</span><span class="n">e96</span><span class="o">-</span><span class="n">pp</span><span class="o">.</span><span class="n">h5</span>
<span class="n">QMC_DATA</span><span class="o">/</span><span class="n">C</span><span class="o">-</span><span class="n">molecule</span><span class="o">/</span><span class="n">C30</span><span class="o">-</span><span class="n">e120</span><span class="o">-</span><span class="n">pp</span><span class="o">.</span><span class="n">h5</span>
<span class="n">QMC_DATA</span><span class="o">/</span><span class="n">C</span><span class="o">-</span><span class="n">molecule</span><span class="o">/</span><span class="n">C30</span><span class="o">-</span><span class="n">e180</span><span class="o">-</span><span class="n">ae</span><span class="o">.</span><span class="n">h5</span>
<span class="n">QMC_DATA</span><span class="o">/</span><span class="n">C</span><span class="o">-</span><span class="n">molecule</span><span class="o">/</span><span class="n">C60</span><span class="o">-</span><span class="n">e240</span><span class="o">-</span><span class="n">pp</span><span class="o">.</span><span class="n">h5</span>
<span class="n">QMC_DATA</span><span class="o">/</span><span class="n">NiO</span><span class="o">/</span><span class="n">NiO</span><span class="o">-</span><span class="n">fcc</span><span class="o">-</span><span class="n">supertwist111</span><span class="o">-</span><span class="n">supershift000</span><span class="o">-</span><span class="n">S1</span><span class="o">.</span><span class="n">h5</span>
<span class="n">QMC_DATA</span><span class="o">/</span><span class="n">NiO</span><span class="o">/</span><span class="n">NiO</span><span class="o">-</span><span class="n">fcc</span><span class="o">-</span><span class="n">supertwist111</span><span class="o">-</span><span class="n">supershift000</span><span class="o">-</span><span class="n">S2</span><span class="o">.</span><span class="n">h5</span>
<span class="n">QMC_DATA</span><span class="o">/</span><span class="n">NiO</span><span class="o">/</span><span class="n">NiO</span><span class="o">-</span><span class="n">fcc</span><span class="o">-</span><span class="n">supertwist111</span><span class="o">-</span><span class="n">supershift000</span><span class="o">-</span><span class="n">S4</span><span class="o">.</span><span class="n">h5</span>
<span class="n">QMC_DATA</span><span class="o">/</span><span class="n">NiO</span><span class="o">/</span><span class="n">NiO</span><span class="o">-</span><span class="n">fcc</span><span class="o">-</span><span class="n">supertwist111</span><span class="o">-</span><span class="n">supershift000</span><span class="o">-</span><span class="n">S8</span><span class="o">.</span><span class="n">h5</span>
<span class="n">QMC_DATA</span><span class="o">/</span><span class="n">NiO</span><span class="o">/</span><span class="n">NiO</span><span class="o">-</span><span class="n">fcc</span><span class="o">-</span><span class="n">supertwist111</span><span class="o">-</span><span class="n">supershift000</span><span class="o">-</span><span class="n">S16</span><span class="o">.</span><span class="n">h5</span>
<span class="n">QMC_DATA</span><span class="o">/</span><span class="n">NiO</span><span class="o">/</span><span class="n">NiO</span><span class="o">-</span><span class="n">fcc</span><span class="o">-</span><span class="n">supertwist111</span><span class="o">-</span><span class="n">supershift000</span><span class="o">-</span><span class="n">S32</span><span class="o">.</span><span class="n">h5</span>
<span class="n">QMC_DATA</span><span class="o">/</span><span class="n">NiO</span><span class="o">/</span><span class="n">NiO</span><span class="o">-</span><span class="n">fcc</span><span class="o">-</span><span class="n">supertwist111</span><span class="o">-</span><span class="n">supershift000</span><span class="o">-</span><span class="n">S64</span><span class="o">.</span><span class="n">h5</span>
<span class="n">QMC_DATA</span><span class="o">/</span><span class="n">NiO</span><span class="o">/</span><span class="n">NiO</span><span class="o">-</span><span class="n">fcc</span><span class="o">-</span><span class="n">supertwist111</span><span class="o">-</span><span class="n">supershift000</span><span class="o">-</span><span class="n">S128</span><span class="o">.</span><span class="n">h5</span>
<span class="n">QMC_DATA</span><span class="o">/</span><span class="n">NiO</span><span class="o">/</span><span class="n">NiO</span><span class="o">-</span><span class="n">fcc</span><span class="o">-</span><span class="n">supertwist111</span><span class="o">-</span><span class="n">supershift000</span><span class="o">-</span><span class="n">S256</span><span class="o">.</span><span class="n">h5</span>
<span class="n">QMC_DATA</span><span class="o">/</span><span class="n">NiO</span><span class="o">/</span><span class="n">NiO_afm_fcidump</span><span class="o">.</span><span class="n">h5</span>
<span class="n">QMC_DATA</span><span class="o">/</span><span class="n">NiO</span><span class="o">/</span><span class="n">NiO_afm_wfn</span><span class="o">.</span><span class="n">dat</span>
<span class="n">QMC_DATA</span><span class="o">/</span><span class="n">NiO</span><span class="o">/</span><span class="n">NiO_nm_choldump</span><span class="o">.</span><span class="n">h5</span>
</pre></div>
</div>
</div>
<div class="section" id="configure-and-build-using-cmake-and-make">
<h3>Configure and build using CMake and make<a class="headerlink" href="#configure-and-build-using-cmake-and-make" title="Permalink to this headline">¶</a></h3>
<p>To configure and build QMCPACK, move to build directory, run CMake, and make</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">build</span>
<span class="n">cmake</span> <span class="o">..</span>
<span class="n">make</span> <span class="o">-</span><span class="n">j</span> <span class="mi">8</span>
</pre></div>
</div>
<p>As you will have gathered, CMake encourages “out of source” builds,
where all the files for a specific build configuration reside in their
own directory separate from the source files. This allows multiple
builds to be created from the same source files, which is very useful
when the file system is shared between different systems. You can also
build versions with different settings (e.g., QMC_COMPLEX) and
different compiler settings. The build directory does not have to be
called build—use something descriptive such as build_machinename or
build_complex. The “..” in the CMake line refers to the directory
containing CMakeLists.txt. Update the “..” for other build
directory locations.</p>
</div>
<div class="section" id="example-configure-and-build">
<h3>Example configure and build<a class="headerlink" href="#example-configure-and-build" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>Set the environments (the examples below assume bash, Intel compilers, and MKL library)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">CXX</span><span class="o">=</span><span class="n">icpc</span>
<span class="n">export</span> <span class="n">CC</span><span class="o">=</span><span class="n">icc</span>
<span class="n">export</span> <span class="n">MKL_ROOT</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">intel</span><span class="o">/</span><span class="n">mkl</span><span class="o">/</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">3.020</span>
<span class="n">export</span> <span class="n">HDF5_ROOT</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span>
<span class="n">export</span> <span class="n">BOOST_ROOT</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">boost</span>
<span class="n">export</span> <span class="n">FFTW_HOME</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">fftw</span>
</pre></div>
</div>
</li>
<li><p>Move to build directory, run CMake, and make</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">build</span>
<span class="n">cmake</span> <span class="o">-</span><span class="n">D</span> <span class="n">CMAKE_BUILD_TYPE</span><span class="o">=</span><span class="n">Release</span> <span class="o">..</span>
<span class="n">make</span> <span class="o">-</span><span class="n">j</span> <span class="mi">8</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="build-scripts">
<h3>Build scripts<a class="headerlink" href="#build-scripts" title="Permalink to this headline">¶</a></h3>
<p>We recommended creating a helper script that contains the
configure line for CMake.  This is particularly useful when avoiding
environment variables, packages are installed in custom locations,
or the configure line is long or complex.  In this case it is also
recommended to add “rm -rf CMake*” before the configure line to remove
existing CMake configure files to ensure a fresh configure each time
the script is called. Deleting all the files in the build
directory is also acceptable. If you do so we recommend adding some sanity
checks in case the script is run from the wrong directory (e.g.,
checking for the existence of some QMCPACK files).</p>
<p>Some build script examples for different systems are given in the
config directory. For example, on Cray systems these scripts might
load the appropriate modules to set the appropriate programming
environment, specific library versions, etc.</p>
<p>An example script build.sh is given below. It is much more complex
than usually needed for comprehensiveness:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">CXX</span><span class="o">=</span><span class="n">mpic</span><span class="o">++</span>
<span class="n">export</span> <span class="n">CC</span><span class="o">=</span><span class="n">mpicc</span>
<span class="n">export</span> <span class="n">ACML_HOME</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">acml</span><span class="o">-</span><span class="mf">5.3</span><span class="o">.</span><span class="mi">1</span><span class="o">/</span><span class="n">gfortran64</span>
<span class="n">export</span> <span class="n">HDF5_ROOT</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">hdf5</span>
<span class="n">export</span> <span class="n">BOOST_ROOT</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">boost</span>

<span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="n">CMake</span><span class="o">*</span>

<span class="n">cmake</span>                                                \
  <span class="o">-</span><span class="n">D</span> <span class="n">CMAKE_BUILD_TYPE</span><span class="o">=</span><span class="n">Debug</span>                         \
  <span class="o">-</span><span class="n">D</span> <span class="n">LIBXML2_INCLUDE_DIR</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">include</span><span class="o">/</span><span class="n">libxml2</span>      \
  <span class="o">-</span><span class="n">D</span> <span class="n">LIBXML2_LIBRARY</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">x86_64</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="o">/</span><span class="n">libxml2</span><span class="o">.</span><span class="n">so</span> \
  <span class="o">-</span><span class="n">D</span> <span class="n">FFTW_INCLUDE_DIRS</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">include</span>                 \
  <span class="o">-</span><span class="n">D</span> <span class="n">FFTW_LIBRARY_DIRS</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">x86_64</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span>    \
  <span class="o">-</span><span class="n">D</span> <span class="n">QMC_EXTRA_LIBS</span><span class="o">=</span><span class="s2">&quot;-ldl $</span><span class="si">{ACML_HOME}</span><span class="s2">/lib/libacml.a -lgfortran&quot;</span> \
  <span class="o">-</span><span class="n">D</span> <span class="n">QMC_DATA</span><span class="o">=/</span><span class="n">projects</span><span class="o">/</span><span class="n">QMCPACK</span><span class="o">/</span><span class="n">qmc</span><span class="o">-</span><span class="n">data</span>            \
  <span class="o">..</span>
</pre></div>
</div>
</div>
<div class="section" id="using-vendor-optimized-numerical-libraries-e-g-intel-mkl">
<h3>Using vendor-optimized numerical libraries (e.g., Intel MKL)<a class="headerlink" href="#using-vendor-optimized-numerical-libraries-e-g-intel-mkl" title="Permalink to this headline">¶</a></h3>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="simulationcell.html" class="btn btn-neutral float-right" title="Specifying the Simulation Cell" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="features.html" class="btn btn-neutral float-left" title="Features of QMCPACK" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, John Batson

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
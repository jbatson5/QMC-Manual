

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Trial wavefunction specificaion &mdash; QMC Manual 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Specifying the system to be simulated" href="simulationcell.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> QMC Manual
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="features.html">Features of QMCPACK</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Obtaining, installing, and validating QMCPACK</a></li>
<li class="toctree-l1"><a class="reference internal" href="running.html">Running QMCPACK</a></li>
<li class="toctree-l1"><a class="reference internal" href="units.html">Units used in QMCPACK</a></li>
<li class="toctree-l1"><a class="reference internal" href="input_overview.html">Input file overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulationcell.html">Specifying the system to be simulated</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Trial wavefunction specificaion</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#single-determinant-wavefunctons">Single determinant wavefunctons</a></li>
<li class="toctree-l2"><a class="reference internal" href="#single-particle-orbitals">Single-particle orbitals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#spline-basis-sets">Spline basis sets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gaussian-basis-tests">Gaussian basis tests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#detailed-description-of-attributes">Detailed description of attributes:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hyrbid-orbital-representation">Hyrbid orbital representation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plane-wave-basis-sets">Plane-wave basis sets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#homogeneous-electron-gas">Homogeneous electron gas</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">QMC Manual</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Trial wavefunction specificaion</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/intro_wavefunction.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="trial-wavefunction-specificaion">
<span id="intro-wavefunction"></span><h1>Trial wavefunction specificaion<a class="headerlink" href="#trial-wavefunction-specificaion" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<span id="trial-intro"></span><h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This section describes the input blocks associated with the specification of the trial wavefunction in a QMCPACK calculation. These sections are contained within the <code class="docutils literal notranslate"><span class="pre">&lt;wavefunction&gt;</span></code> <span class="math notranslate nohighlight">\(...\)</span>  <code class="docutils literal notranslate"><span class="pre">&lt;/wavefunction&gt;</span></code> xml blocks. <strong>Users are expected to rely on converters to generate the input blocks described in this section.</strong> The converters and the workflows are designed such that input blocks require minimum modifications from users. Unless the workflow requires modification of wavefunction blocks (e.g., setting the cutoff in a multideterminant calculation), only expert users should directly alter them.</p>
<p>The trial wavefunction in QMCPACK has a general product form:</p>
<div class="math notranslate nohighlight" id="equation-eq1">
<span class="eqno">(1)<a class="headerlink" href="#equation-eq1" title="Permalink to this equation">¶</a></span>\[\Psi_T(\vec{r}) = \prod_k \Theta_k(\vec{r}) ,\]</div>
<p>where each <span class="math notranslate nohighlight">\(\Theta_k(\vec{r})\)</span> is a function of the electron coordinates
(and possibly ionic coordinates and variational parameters).
For problems involving electrons, the overall trial wavefunction
must be antisymmetric with respect to electron exchange,
so at least one of the functions in the product must be
antisymmetric. Notice that, although QMCPACK allows for the
construction of arbitrary trial wavefunctions based on the
functions implemented in the code
(e.g., slater determinants, jastrow functions),
the user must make sure that a correct wavefunction is
used for the problem at hand. From here on, we assume a
standard trial wavefunction for an electronic structure problem</p>
<div class="math notranslate nohighlight" id="equation-eq2">
<span class="eqno">(2)<a class="headerlink" href="#equation-eq2" title="Permalink to this equation">¶</a></span>\[Psi_T(\vec{r}) =  \textit{A}(\vec{r}) \prod_k \textit{J}_k(\vec{r}),\]</div>
<p>where <span class="math notranslate nohighlight">\(\textit{A}(\vec{r})\)</span>
is one of the antisymmetric functions: (1) slater determinant, (2) multislater determinant, or (3) pfaffian and <span class="math notranslate nohighlight">\(\textit{J}_k\)</span>
is any of the Jastrow functions (described in <span class="xref std std-ref">jastrow</span>).  The antisymmetric functions are built from a set of single particle orbitals <code class="docutils literal notranslate"><span class="pre">(sposet)</span></code>. QMCPACK implements four different types of <code class="docutils literal notranslate"><span class="pre">sposet</span></code>, described in the following section. Each <code class="docutils literal notranslate"><span class="pre">sposet</span></code> is designed for a different type of calculation, so their definition and generation varies accordingly.</p>
</div>
<div class="section" id="single-determinant-wavefunctons">
<span id="singledeterminant"></span><h2>Single determinant wavefunctons<a class="headerlink" href="#single-determinant-wavefunctons" title="Permalink to this headline">¶</a></h2>
<p>Placing a single determinant for each spin is the most used ansatz for the antisymmetric part of a trial wavefunction.
The input xml block for <code class="docutils literal notranslate"><span class="pre">slaterdeterminant</span></code> is given in <a class="reference internal" href="#listing-1"><span class="std std-ref">Listing 1</span></a>. A list of options is given in
<a class="reference internal" href="#table2"><span class="std std-numref">Table 2</span></a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">slaterdeterminant</span></code> element:</p>
<table class="docutils align-default" id="table2">
<colgroup>
<col style="width: 46%" />
<col style="width: 54%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Parent elements</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">determinantset</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Child elements</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">determinant</span></code></p></td>
</tr>
</tbody>
</table>
<p>Attribute:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 14%" />
<col style="width: 11%" />
<col style="width: 12%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Datatype</p></th>
<th class="head"><p>Values</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delay_rank</span></code></p></td>
<td><p>Integer</p></td>
<td><p>&gt;=0</p></td>
<td><p>1</p></td>
<td><p>Number of delayed updates.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">optimize</span></code></p></td>
<td><p>Text</p></td>
<td><p>yes/no</p></td>
<td><p>yes</p></td>
<td><p>Enable orbital optimization.</p></td>
</tr>
</tbody>
</table>
<p class="centered">
<strong>Table 2 Options for the <code class="docutils literal notranslate"><span class="pre">slaterdeterminant</span></code> xml-block.</strong></p><div class="literal-block-wrapper docutils container" id="listing-1">
<div class="code-block-caption"><span class="caption-number">Listing 1 </span><span class="caption-text">Slaterdeterminant set XML element.</span><a class="headerlink" href="#listing-1" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">slaterdeterminant</span> <span class="n">delay_rank</span><span class="o">=</span><span class="s2">&quot;32&quot;</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">determinant</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;updet&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;208&quot;</span><span class="o">&gt;</span>
     <span class="o">&lt;</span><span class="n">occupation</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span> <span class="n">spindataset</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="o">&gt;</span>
     <span class="o">&lt;/</span><span class="n">occupation</span><span class="o">&gt;</span>
   <span class="o">&lt;/</span><span class="n">determinant</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">determinant</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;downdet&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;208&quot;</span><span class="o">&gt;</span>
     <span class="o">&lt;</span><span class="n">occupation</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span> <span class="n">spindataset</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="o">&gt;</span>
     <span class="o">&lt;/</span><span class="n">occupation</span><span class="o">&gt;</span>
   <span class="o">&lt;/</span><span class="n">determinant</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">slaterdeterminant</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<p>Additional information:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">delay_rank</span></code> This option enables delayed updates of the Slater matrix inverse when particle-by-particle move is used.
By default or if <code class="docutils literal notranslate"><span class="pre">delay_rank=0</span></code> given in the input file, QMCPACK sets 1 for Slater matrices with a leading dimension <span class="math notranslate nohighlight">\(&lt;192\)</span> and 32 otherwise.
<code class="docutils literal notranslate"><span class="pre">delay_rank=1</span></code> uses the Fahy’s variant <a class="bibtex reference internal" href="simulationcell.html#fahy1990" id="id1">[FWL90]</a> of the Sherman-Morrison rank-1 update, which is mostly using memory bandwidth-bound BLAS-2 calls.
With <code class="docutils literal notranslate"><span class="pre">delay_rank&gt;1</span></code>, the delayed update algorithm <a class="bibtex reference internal" href="simulationcell.html#luo2018delayedupdate" id="id2">[LK18]</a><a class="bibtex reference internal" href="simulationcell.html#mcdaniel2017" id="id3">[MDAzevedoL+17]</a> turns most of the computation to compute bound BLAS-3 calls.
Tuning this parameter is highly recommended to gain the best performance on medium-to-large problem sizes (<span class="math notranslate nohighlight">\(&gt;200\)</span> electrons).
We have seen up to an order of magnitude speedup on large problem sizes.
When studying the performance of QMCPACK, a scan of this parameter is required and we recommend starting from 32.
The best <code class="docutils literal notranslate"><span class="pre">delay_rank</span></code> giving the maximal speedup depends on the problem size.
Usually the larger <code class="docutils literal notranslate"><span class="pre">delay_rank</span></code> corresponds to a larger problem size.
On CPUs, <code class="docutils literal notranslate"><span class="pre">delay_rank</span></code> must be chosen as a multiple of SIMD vector length for good performance of BLAS libraries.
The best <code class="docutils literal notranslate"><span class="pre">delay_rank</span></code> depends on the processor microarchitecture.
GPU support is under development.</p></li>
</ul>
</div>
<div class="section" id="single-particle-orbitals">
<span id="singleparticle"></span><h2>Single-particle orbitals<a class="headerlink" href="#single-particle-orbitals" title="Permalink to this headline">¶</a></h2>
<div class="section" id="spline-basis-sets">
<span id="spo-spline"></span><h3>Spline basis sets<a class="headerlink" href="#spline-basis-sets" title="Permalink to this headline">¶</a></h3>
<p>In this section we describe the use of spline basis sets to expand the <code class="docutils literal notranslate"><span class="pre">sposet</span></code>.
Spline basis sets are designed to work seamlessly with plane wave DFT code (e.g.,Quantum ESPRESSO as a trial wavefunction generator).</p>
<p>In QMC algorithms, all the SPOs <span class="math notranslate nohighlight">\(\{\phi(\vec{r})\}\)</span> need to be updated
every time a single electron moves. Evaluating SPOs takes a very large portion of computation time.
In principle, PW basis set can be used to express SPOs directly in QMC, as in DFT.
But it introduces an unfavorable scaling because the basis set size increases linearly as the system size.
For this reason, it is efficient to use a localized basis with compact
support and a good transferability from the plane wave basis.</p>
<p>In particular, 3D tricubic B-splines provide a basis in which only
64 elements are nonzero at any given point in <a class="bibtex reference internal" href="simulationcell.html#blips4qmc" id="id4">[AlfeG04]</a>.
The 1D cubic B-spline is given by</p>
<div class="math notranslate nohighlight" id="equation-eq3">
<span class="eqno">(3)<a class="headerlink" href="#equation-eq3" title="Permalink to this equation">¶</a></span>\[f(x) = \sum_{i'=i-1}^{i+2} b^{i'\!,3}(x)\,\,  p_{i'},\]</div>
<p>where <span class="math notranslate nohighlight">\(b^{i}(x)\)</span> is the piecewise cubic polynomial basis functions
and <span class="math notranslate nohighlight">\(i = \text{floor}(\Delta^{-1} x)\)</span> is the index of the first
grid point <span class="math notranslate nohighlight">\(\le x\)</span>. Constructing a tensor product in each
Cartesian direction, we can represent a 3D orbital as</p>
<div class="math notranslate nohighlight" id="equation-eq4">
<span class="eqno">(4)<a class="headerlink" href="#equation-eq4" title="Permalink to this equation">¶</a></span>\[\phi_n(x,y,z) =
    \!\!\!\!\sum_{i'=i-1}^{i+2} \!\! b_x^{i'\!,3}(x)
    \!\!\!\!\sum_{j'=j-1}^{j+2} \!\! b_y^{j'\!,3}(y)
    \!\!\!\!\sum_{k'=k-1}^{k+2} \!\! b_z^{k'\!,3}(z) \,\, p_{i', j', k',n}.\]</div>
<p>This allows the rapid evaluation of each orbital in constant time.
Furthermore, this basis is systematically improvable with a single spacing
parameter so that accuracy is not compromised compared with the plane wave basis.</p>
<p>The use of 3D tricubic B-splines greatly improves computational efficiency.
The gain in computation time from a plane wave basis set to an equivalent B-spline basis set
becomes increasingly large as the system size grows.
On the downside, this computational efficiency comes at
the expense of increased memory use, which is easily overcome, however, by the large
aggregate memory available per node through OpenMP/MPI hybrid QMC.</p>
<p>The input xml block for the spline SPOs is given in <a class="reference internal" href="#listing-2"><span class="std std-ref">Listing 2</span></a>. A list of options is given in
<a class="reference internal" href="#table3"><span class="std std-numref">Table 3</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="listing-2">
<div class="code-block-caption"><span class="caption-number">Listing 2 </span><span class="caption-text">Determinant set XML element.</span><a class="headerlink" href="#listing-2" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">determinantset</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;bspline&quot;</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;i&quot;</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;pwscf.h5&quot;</span>
                <span class="n">tilematrix</span><span class="o">=</span><span class="s2">&quot;1 1 3 1 2 -1 -2 1 0&quot;</span> <span class="n">twistnum</span><span class="o">=</span><span class="s2">&quot;-1&quot;</span> <span class="n">gpu</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span> <span class="n">meshfactor</span><span class="o">=</span><span class="s2">&quot;0.8&quot;</span>
                <span class="n">twist</span><span class="o">=</span><span class="s2">&quot;0  0  0&quot;</span> <span class="n">precision</span><span class="o">=</span><span class="s2">&quot;double&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">slaterdeterminant</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">determinant</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;updet&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;208&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">occupation</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span> <span class="n">spindataset</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">occupation</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">determinant</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">determinant</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;downdet&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;208&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">occupation</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span> <span class="n">spindataset</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">occupation</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">determinant</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">slaterdeterminant</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">determinantset</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">determinantset</span></code> element:</p>
<table class="docutils align-default" id="table3">
<colgroup>
<col style="width: 43%" />
<col style="width: 58%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Parent elements</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wavefunction</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Child elements</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">slaterdeterminant</span></code></p></td>
</tr>
</tbody>
</table>
<p>attribute:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 10%" />
<col style="width: 22%" />
<col style="width: 8%" />
<col style="width: 36%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Datatype</p></th>
<th class="head"><p>Values</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p></td>
<td><p>Text</p></td>
<td><p>Bspline</p></td>
<td></td>
<td><p>Type of <code class="docutils literal notranslate"><span class="pre">sposet</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">href</span></code></p></td>
<td><p>Text</p></td>
<td></td>
<td></td>
<td><p>Path to hdf5 file from pw2qmcpack.x.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">tilematrix</span></code></p></td>
<td><p>9 integers</p></td>
<td></td>
<td></td>
<td><p>Tiling matrix used to expand supercell.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">twistnum</span></code></p></td>
<td><p>Integer</p></td>
<td></td>
<td></td>
<td><p>Index of the super twist.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">twist</span></code></p></td>
<td><p>3 floats</p></td>
<td></td>
<td></td>
<td><p>Super twist.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">meshfactor</span></code></p></td>
<td><p>Float</p></td>
<td><p><span class="math notranslate nohighlight">\(\le 1.0\)</span></p></td>
<td></td>
<td><p>Grid spacing ratio.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">precision</span></code></p></td>
<td><p>Text</p></td>
<td><p>Single/double</p></td>
<td></td>
<td><p>Precision of spline coefficients</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">gpu</span></code></p></td>
<td><p>Text</p></td>
<td><p>Yes/no</p></td>
<td></td>
<td><p>GPU switch.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">gpusharing</span></code></p></td>
<td><p>Text</p></td>
<td><p>Yes/no</p></td>
<td><p>No</p></td>
<td><p>Share B-spline table across GPUs.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Spline_Size_Limit_MB</span></code></p></td>
<td><p>Integer</p></td>
<td></td>
<td></td>
<td><p>Limit B-spline table size on GPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">check_orb_norm</span></code></p></td>
<td><p>Text</p></td>
<td><p>Yes/no</p></td>
<td><p>Yes</p></td>
<td><p>Check norms of orbitals from h5 file.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">save_coefs</span></code></p></td>
<td><p>Text</p></td>
<td><p>Yes/no</p></td>
<td><p>No</p></td>
<td><p>Save the spline coefficients to h5 file.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">source</span></code></p></td>
<td><p>Text</p></td>
<td><p>Any</p></td>
<td><p>Ion0</p></td>
<td><p>Particle set with atomic positions.</p></td>
</tr>
</tbody>
</table>
<p class="centered">
<strong>Table 3 Options for the <code class="docutils literal notranslate"><span class="pre">determinantset</span></code> xml-block associated with B-spline single particle orbital sets.</strong></p><p>Additional information:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">precision</span></code>. Only effective on CPU versions without mixed
precision, “single” is always imposed with mixed precision. Using
single precision not only saves memory use but also speeds up the
B-spline evaluation. We recommend using single precision since we saw
little chance of really compromising the accuracy of calculation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">meshfactor</span></code>. The ratio of actual grid spacing of B-splines used in
QMC calculation with respect to the original one calculated from h5.
A smaller meshfactor saves memory use but reduces accuracy. The
effects are similar to reducing plane wave cutoff in DFT
calculations. Use with caution!</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">twistnum</span></code>. If positive, it is the index. We recommend not taking
this way since the indexing might show some uncertainty. If negative,
the super twist is referred by <code class="docutils literal notranslate"><span class="pre">twist</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">save_coefs</span></code>. If yes, dump the real-space B-spline coefficient
table into an h5 file on the disk. When the orbital transformation
from k space to B-spline requires more than the available amount of
scratch memory on the compute nodes, users can perform this step on
fat nodes and transfer back the h5 file for QMC calculations.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gpusharing</span></code>. If enabled, spline data is shared across multiple
GPUs on a given computational node. For example, on a
two-GPU-per-node system, each GPU would have half of the orbitals.
This enables larger overall spline tables than would normally fit in
the memory of individual GPUs to be used, potentially up to the total
GPU memory on a node. To obtain high performance, large electron
counts or a high-performing CPU-GPU interconnect is required. To use
this feature, the following needs to be done:</p>
<blockquote>
<div><ul class="simple">
<li><p>The CUDA Multi-Process Service (MPS) needs to be used (e.g., on</p></li>
</ul>
<p>Summit/SummitDev use “-alloc_flags gpumps” for bsub). If MPS is not
detected, sharing will be disabled.</p>
<ul class="simple">
<li><p>CUDA_VISIBLE_DEVICES needs to be properly set to control each rank’s</p></li>
</ul>
<p>visible CUDA devices (e.g., on OLCF Summit/SummitDev one needs to
create a resource set containing all GPUs with the respective number
of ranks with “jsrun –task-per-rs Ngpus -g Ngpus”).</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Spline_Size_Limit_MB</span></code>. Allows distribution of the B-spline
coefficient table between the host and GPU memory. The compute kernels
access host memory via zero-copy. Although the performance penalty
introduced by it is significant, it allows large calculations to go
through.</p></li>
</ul>
</div>
<div class="section" id="gaussian-basis-tests">
<span id="gaussianbasis"></span><h3>Gaussian basis tests<a class="headerlink" href="#gaussian-basis-tests" title="Permalink to this headline">¶</a></h3>
<p>In this section we describe the use of localized basis sets to expand the <code class="docutils literal notranslate"><span class="pre">sposet</span></code>. The general form of a single particle orbital in this case is given by:</p>
<div class="math notranslate nohighlight" id="equation-eq5">
<span class="eqno">(5)<a class="headerlink" href="#equation-eq5" title="Permalink to this equation">¶</a></span>\[\phi_i(\vec{r}) = \sum_k C_{i,k} \ \eta_k(\vec{r}),\]</div>
<p>where <span class="math notranslate nohighlight">\(\{\eta_k(\vec{r})\}\)</span> is a set of M atom-centered basis
functions and <span class="math notranslate nohighlight">\(C_{i,k}\)</span> is a coefficient matrix. This should be
used in calculations of finite systems employing an atom-centered basis
set and is typically generated by the <em>convert4qmc</em> converter. Examples
include calculations of molecules using Gaussian basis sets or
Slater-type basis functions. Initial support for periodic systems is
described in <span class="xref std std-ref">LCAO</span>. Even though this section is called
“Gaussian basis sets” (by far the most common atom-centered basis set),
QMCPACK works with any atom-centered basis set based on either spherical
harmonic angular functions or Cartesian angular expansions. The radial
functions in the basis set can be expanded in either Gaussian functions,
Slater-type functions, or numerical radial functions.</p>
<p>In this section we describe the input sections for the atom-centered basis set and the <code class="docutils literal notranslate"><span class="pre">sposet</span></code> for a single Slater determinant trial wavefunction. The input sections for multideterminant trial wavefunctions are described in <span class="xref std std-ref">multideterminants</span>. The basic structure for the input block of a single Slater determinant is given in <a class="reference internal" href="#listing-3"><span class="std std-ref">Listing 3</span></a>.
A list of options for <code class="docutils literal notranslate"><span class="pre">determinantset</span></code> associated with this <code class="docutils literal notranslate"><span class="pre">sposet</span></code> is given in <a class="reference internal" href="#table4"><span class="std std-numref">Table 4</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="listing-3">
<div class="code-block-caption"><span class="caption-number">Listing 3 </span><span class="caption-text">Basic input block for a single determinant trial wavefunction using a <code class="docutils literal notranslate"><span class="pre">sposet</span></code> expanded on an atom-centered basis set.</span><a class="headerlink" href="#listing-3" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="o">&lt;</span><span class="n">wavefunction</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;psi0&quot;</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;e&quot;</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">determinantset</span><span class="o">&gt;</span>
     <span class="o">&lt;</span><span class="n">basisset</span><span class="o">&gt;</span>
       <span class="o">...</span>
     <span class="o">&lt;/</span><span class="n">basisset</span><span class="o">&gt;</span>
     <span class="o">&lt;</span><span class="n">slaterdeterminant</span><span class="o">&gt;</span>
       <span class="o">...</span>
     <span class="o">&lt;/</span><span class="n">slaterdeterminant</span><span class="o">&gt;</span>
   <span class="o">&lt;/</span><span class="n">determinantset</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">wavefunction</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<p>The definition of the set of atom-centered basis functions is given by the <code class="docutils literal notranslate"><span class="pre">basisset</span></code> block, and the <code class="docutils literal notranslate"><span class="pre">sposet</span></code> is defined within <code class="docutils literal notranslate"><span class="pre">slaterdeterminant</span></code>. The <code class="docutils literal notranslate"><span class="pre">basisset</span></code> input block is composed from a collection of <code class="docutils literal notranslate"><span class="pre">atomicBasisSet</span></code> input blocks, one for each atomic species in the simulation where basis functions are centered. The general structure for <code class="docutils literal notranslate"><span class="pre">basisset</span></code> and <code class="docutils literal notranslate"><span class="pre">atomicBasisSet</span></code> are given in <a class="reference internal" href="#listing-4"><span class="std std-ref">Listing 4</span></a>, and the corresponding lists of options are given in
<a class="reference internal" href="#table5"><span class="std std-numref">Table 5</span></a> and <a class="reference internal" href="#table6"><span class="std std-numref">Table 6</span></a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">determinantset</span></code> element:</p>
<table class="docutils align-default" id="table4">
<colgroup>
<col style="width: 19%" />
<col style="width: 81%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Parent elements</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wavefunction</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Child elements</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">basisset</span></code> , <code class="docutils literal notranslate"><span class="pre">slaterdeterminant</span></code> , <code class="docutils literal notranslate"><span class="pre">sposet</span></code> , <code class="docutils literal notranslate"><span class="pre">multideterminant</span></code></p></td>
</tr>
</tbody>
</table>
<p>Attribute:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 13%" />
<col style="width: 14%" />
<col style="width: 12%" />
<col style="width: 44%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">name/id</span></code></p></td>
<td><p>Text</p></td>
<td><p><em>Any</em></p></td>
<td><p>‘’ ‘’</p></td>
<td><p>Name of determinant set</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p></td>
<td><p>Text</p></td>
<td><p>See below</p></td>
<td><p>‘’ ‘’</p></td>
<td><p>Type of <code class="docutils literal notranslate"><span class="pre">sposet</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">keyword</span></code></p></td>
<td><p>Text</p></td>
<td><p>NMO, GTO, STO</p></td>
<td><p>NMO</p></td>
<td><p>Type of orbital set generated</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">transform</span></code></p></td>
<td><p>Text</p></td>
<td><p>Yes/no</p></td>
<td><p>Yes</p></td>
<td><p>Transform to numerical radial functions?</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">source</span></code></p></td>
<td><p>Text</p></td>
<td><p><em>Any</em></p></td>
<td><p>Ion0</p></td>
<td><p>Particle set with the position of atom centers</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cuspCorrection</span></code></p></td>
<td><p>Text</p></td>
<td><p>Yes/no</p></td>
<td><p>No</p></td>
<td><p>Apply cusp correction scheme to <code class="docutils literal notranslate"><span class="pre">sposet</span></code>?</p></td>
</tr>
</tbody>
</table>
<p class="centered">
<strong>Table 4 Options for the <code class="docutils literal notranslate"><span class="pre">determinantset</span></code> xml-block associated with atom-centered single particle orbital sets.</strong></p><div class="literal-block-wrapper docutils container" id="listing-4">
<div class="code-block-caption"><span class="caption-number">Listing 4 </span><span class="caption-text">Basic input block for <code class="docutils literal notranslate"><span class="pre">basisset</span></code>.</span><a class="headerlink" href="#listing-4" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">basisset</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;LCAOBSet&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">atomicBasisSet</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Gaussian-G2&quot;</span> <span class="n">angular</span><span class="o">=</span><span class="s2">&quot;cartesian&quot;</span> <span class="n">elementType</span><span class="o">=</span><span class="s2">&quot;C&quot;</span> <span class="n">normalized</span><span class="o">=</span><span class="s2">&quot;no&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">grid</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span> <span class="n">ri</span><span class="o">=</span><span class="s2">&quot;1.e-6&quot;</span> <span class="n">rf</span><span class="o">=</span><span class="s2">&quot;1.e2&quot;</span> <span class="n">npts</span><span class="o">=</span><span class="s2">&quot;1001&quot;</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="n">basisGroup</span> <span class="n">rid</span><span class="o">=</span><span class="s2">&quot;C00&quot;</span> <span class="n">n</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="n">l</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Gaussian&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">radfunc</span> <span class="n">exponent</span><span class="o">=</span><span class="s2">&quot;5.134400000000e-02&quot;</span> <span class="n">contraction</span><span class="o">=</span><span class="s2">&quot;1.399098787100e-02&quot;</span><span class="o">/&gt;</span>
      <span class="o">...</span>
    <span class="o">&lt;/</span><span class="n">basisGroup</span><span class="o">&gt;</span>
    <span class="o">...</span>
  <span class="o">&lt;/</span><span class="n">atomicBasisSet</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">atomicBasisSet</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Gaussian-G2&quot;</span> <span class="n">angular</span><span class="o">=</span><span class="s2">&quot;cartesian&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Gaussian&quot;</span> <span class="n">elementType</span><span class="o">=</span><span class="s2">&quot;C&quot;</span> <span class="n">normalized</span><span class="o">=</span><span class="s2">&quot;no&quot;</span><span class="o">&gt;</span>
    <span class="o">...</span>
  <span class="o">&lt;/</span><span class="n">atomicBasisSet</span><span class="o">&gt;</span>
  <span class="o">...</span>
<span class="o">&lt;/</span><span class="n">basisset</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">basisset</span></code> element:</p>
<table class="docutils align-default" id="table5">
<colgroup>
<col style="width: 47%" />
<col style="width: 53%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Parent elements</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">determinantset</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Child elements</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">atomicBasisSet</span></code></p></td>
</tr>
</tbody>
</table>
<p>Attribute:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 15%" />
<col style="width: 13%" />
<col style="width: 14%" />
<col style="width: 37%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">name</span></code> / <code class="docutils literal notranslate"><span class="pre">id</span></code></p></td>
<td><p>Text</p></td>
<td><p><em>Any</em></p></td>
<td><p>” “</p></td>
<td><p>Name of atom-centered basis set</p></td>
</tr>
</tbody>
</table>
<p class="centered">
<strong>Table 5 Options for the <code class="docutils literal notranslate"><span class="pre">basisset</span></code> xml-block associated with atom-centered single particle orbital sets.</strong></p><p><code class="docutils literal notranslate"><span class="pre">AtomicBasisSet</span></code> element:</p>
<table class="docutils align-default" id="table6">
<colgroup>
<col style="width: 40%" />
<col style="width: 60%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Parent elements</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">basisset</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Child elements</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">grid</span></code> , <code class="docutils literal notranslate"><span class="pre">basisGroup</span></code></p></td>
</tr>
</tbody>
</table>
<p>Attribute:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 13%" />
<col style="width: 11%" />
<col style="width: 12%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">name</span></code> / <code class="docutils literal notranslate"><span class="pre">id</span></code></p></td>
<td><p>Text</p></td>
<td><p><em>Any</em></p></td>
<td><p>” “</p></td>
<td><p>Name of atomic basis set</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">angular</span></code></p></td>
<td><p>Text</p></td>
<td><p>See below</p></td>
<td><p>Default</p></td>
<td><p>Type of angular functions</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">expandYlm</span></code></p></td>
<td><p>Text</p></td>
<td><p>See below</p></td>
<td><p>Yes</p></td>
<td><p>Expand Ylm shells?</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">expM</span></code></p></td>
<td><p>Text</p></td>
<td><p>See below</p></td>
<td><p>Yes</p></td>
<td><p>Add sign for <span class="math notranslate nohighlight">\((-1)^{m}\)</span>?</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">elementType/species</span></code></p></td>
<td><p>Text</p></td>
<td><p><em>Any</em></p></td>
<td><p>e</p></td>
<td><p>Atomic species where functions are centered</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">normalized</span></code></p></td>
<td><p>Text</p></td>
<td><p>Yes/no</p></td>
<td><p>Yes</p></td>
<td><p>Are single particle functions normalized?</p></td>
</tr>
</tbody>
</table>
<p class="centered">
<strong>Table 6 Options for the <code class="docutils literal notranslate"><span class="pre">atomicBasisSet</span></code> xml-block.</strong></p><p><code class="docutils literal notranslate"><span class="pre">basicGroup</span></code> element:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 47%" />
<col style="width: 53%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Parent elements</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">AtomicBasisSet</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Child elements</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">radfunc</span></code></p></td>
</tr>
</tbody>
</table>
<p>Attribute:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 17%" />
<col style="width: 14%" />
<col style="width: 16%" />
<col style="width: 37%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rid/id</span></code></p></td>
<td><p>Text</p></td>
<td><p><em>Any</em></p></td>
<td><p>‘’ ‘’</p></td>
<td><p>Name of the basisGroup</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p></td>
<td><p>Text</p></td>
<td><p><em>Any</em></p></td>
<td><p>‘’ ‘’</p></td>
<td><p>Type of basisGroup</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">n/l/m/s</span></code></p></td>
<td><p>Integer</p></td>
<td><p><em>Any</em></p></td>
<td><p>0</p></td>
<td><p>Quantum numbers of basisGroup</p></td>
</tr>
</tbody>
</table>
<p class="centered">
<strong>Table 7 Options for the <code class="docutils literal notranslate"><span class="pre">basisGroup</span></code> xml-block.</strong></p><div class="literal-block-wrapper docutils container" id="listing-5">
<div class="code-block-caption"><span class="caption-number">Listing 5 </span><span class="caption-text">Basic input block for <code class="docutils literal notranslate"><span class="pre">slaterdeterminant</span></code> with an atom-centered <code class="docutils literal notranslate"><span class="pre">sposet</span></code>.</span><a class="headerlink" href="#listing-5" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">&lt;</span><span class="n">slaterdeterminant</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">slaterdeterminant</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<p>element:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 71%" />
<col style="width: 29%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Parent elements:</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Child elements:</p></td>
<td></td>
</tr>
</tbody>
</table>
<p>Attribute:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 18%" />
<col style="width: 16%" />
<col style="width: 17%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">name/id</span></code></p></td>
<td><p>Text</p></td>
<td><p><em>Any</em></p></td>
<td><p>‘’ ‘’</p></td>
<td><p>Name of determinant set</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Text</p></td>
<td><p><em>Any</em></p></td>
<td><p>‘’ ‘’</p></td>
<td></td>
</tr>
</tbody>
</table>
<div class="section" id="detailed-description-of-attributes">
<h4>Detailed description of attributes:<a class="headerlink" href="#detailed-description-of-attributes" title="Permalink to this headline">¶</a></h4>
<p>In the following, we give a more detailed description of all the options presented in the various xml-blocks described in this section. Only nontrivial attributes are described. Those with simple yes/no options and whose previous description is enough to explain the intended behavior are not included.</p>
<p><code class="docutils literal notranslate"><span class="pre">determinantset</span></code> attributes:</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">type</span></code></dt><dd><p>Type of <code class="docutils literal notranslate"><span class="pre">sposet</span></code>. For atom-centered based <code class="docutils literal notranslate"><span class="pre">sposets</span></code>, use type=”MolecularOrbital” or type=“MO.”
Other options described elsewhere in this manual are “spline,”
“composite,” “pw,” “heg,” “linearopt,” etc.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">keyword/key</span></code></dt><dd><p>Type of basis set generated, which does not necessarily match the type of basis set on the input block. The three possible options are: NMO (numerical molecular orbitals), GTO (Gaussian-type orbitals), and STO (Slater-type orbitals). The default option is NMO. By default, QMCPACK will generate numerical orbitals from both GTO and STO types and use cubic or quintic spline interpolation to evaluate the radial functions. This is typically more efficient than evaluating the radial functions in the native basis (Gaussians or exponents) and allows for arbitrarily large contractions without any additional cost. To force use of the native expansion (not recommended), use GTO or STO for each type of input basis set.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">transform</span></code></dt><dd><p>Request (or avoid) a transformation of the radial functions to NMO type. The default and recommended behavior is to transform to numerical radial functions. If <code class="docutils literal notranslate"><span class="pre">transform</span></code> is set to <em>yes</em>, the option <code class="docutils literal notranslate"><span class="pre">keyword</span></code> is ignored.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">cuspCorrection</span></code></dt><dd><p>Enable (disable) use of the cusp correction algorithm (CASINO REFERENCE) for a <code class="docutils literal notranslate"><span class="pre">basisset</span></code> built with GTO functions. The algorithm is implemented as described in (CASINO REFERENCE) and works only with transform=”yes” and an input GTO basis set. No further input is needed.</p>
</dd>
</dl>
</li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">atomicBasisSet</span></code> attributes:</p>
<ul>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">name/id</span></code></dt><dd><p>Name of the basis set. Names should be unique.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">angular</span></code></dt><dd><p>Type of angular functions used in the expansion. In general, two angular basis functions are allowed: “spherical” (for spherical Ylm functions) and “Cartesian” (for functions of the type <span class="math notranslate nohighlight">\(x^{n}y^{m}z^{l}\)</span>).</p>
</dd>
</dl>
</li>
<li><dl>
<dt><code class="docutils literal notranslate"><span class="pre">expandYlm</span></code></dt><dd><p>Determines whether each basis group is expanded across the corresponding shell of m values (for spherical type) or consistent powers (for Cartesian functions). Options:</p>
<blockquote>
<div><ul class="simple">
<li><p>“No”: Do not expand angular functions across corresponding angular shell.</p></li>
<li><p>“Gaussian”: Expand according to Gaussian03 format. This function is compatible only with angular=”spherical.” For a given input (l,m), the resulting order of the angular functions becomes (1,-1,0) for l=1 and (0,1,-1,2,-2,…,l,-l) for general l.</p></li>
<li><p>“Natural”: Expand angular functions according to (-l,-l+1,…,l-1,l).</p></li>
<li><p>“Gamess”: Expand according to Gamess’ format for Cartesian functions. Notice that this option is compatible only with angular=”Cartesian.” If angular=”Cartesian” is used, this option is not necessary.</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">expM</span></code></dt><dd><p>Determines whether the sign of the spherical Ylm function associated with m (<span class="math notranslate nohighlight">\(-1^{m}\)</span>) is included in the coefficient matrix or not.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">elementType/species</span></code></dt><dd><p>Name of the species where basis functions are centered. Only one <code class="docutils literal notranslate"><span class="pre">atomicBasisSet</span></code> block is allowed per species. Additional blocks are ignored. The corresponding species must exist in the <code class="docutils literal notranslate"><span class="pre">particleset</span></code> given as the <code class="docutils literal notranslate"><span class="pre">source</span></code> option to <code class="docutils literal notranslate"><span class="pre">determinantset</span></code>. Basis functions for all the atoms of the corresponding species are included in the basis set, based on the order of atoms in the <code class="docutils literal notranslate"><span class="pre">particleset</span></code>.</p>
</dd>
</dl>
</li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">basisGroup</span></code> attributes:</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">type</span></code></dt><dd><p>Type of input basis radial function. Note that this refers to the type of radial function in the input xml-block, which might not match the radial function generated internally and used in the calculation (if <code class="docutils literal notranslate"><span class="pre">transform</span></code> is set to “yes”). Also note that different <code class="docutils literal notranslate"><span class="pre">basisGroup</span></code> blocks within a given <code class="docutils literal notranslate"><span class="pre">atomicBasisSet</span></code> can have different <code class="docutils literal notranslate"><span class="pre">types</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">n/l/m/s</span></code></dt><dd><p>Quantum numbers of the basis function. Note that if
<code class="docutils literal notranslate"><span class="pre">expandYlm</span></code> is set to <em>“yes”</em> in <code class="docutils literal notranslate"><span class="pre">atomicBasisSet</span></code>, a
full shell of basis functions with the appropriate values of
<em>“m”</em> will be defined for the corresponding value of
<em>“l.”</em> Otherwise a single basis function will be given for the
specific combination of <em>“(l,m).”</em></p>
</dd>
</dl>
</li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">radfunc</span></code> attributes for <code class="docutils literal notranslate"><span class="pre">type</span></code> = <em>“Gaussian”</em>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">TBDoc</span></code></p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">slaterdeterminant</span></code> attributes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">TBDoc</span></code></p></li>
</ul>
</div>
</div>
<div class="section" id="hyrbid-orbital-representation">
<span id="spo-hybrid"></span><h3>Hyrbid orbital representation<a class="headerlink" href="#hyrbid-orbital-representation" title="Permalink to this headline">¶</a></h3>
<p>The hybrid representation of the single particle orbitals combines a localized atomic basis set around atomic cores and B-splines in the interstitial regions to reduce memory use while retaining high evaluation speed and either retaining or increasing overall accuracy. Full details are provided in <span class="bibtex" id="id5">[Luo2018hyb]</span>, and <strong>users of this feature are kindly requested to cite this paper</strong>.
In practice, we have seen that using a meshfactor=0.5 is often possible and achieves huge memory savings.
<a class="reference internal" href="#fig3"><span class="std std-numref">Fig. 3</span></a> illustrates how the regions are assigned.</p>
<div class="figure align-center" id="id6">
<span id="fig3"></span><a class="reference internal image-reference" href="_images/hybrid_new.jpg"><img alt="_images/hybrid_new.jpg" src="_images/hybrid_new.jpg" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 3 </span><span class="caption-text">Regular and hybrid orbital representation. Regular B-spline representation (left panel) contains only one region and a sufficiently fine mesh to resolve orbitals near the nucleus. The hybrid orbital representation (right panel) contains near nucleus regions (A) where spherical harmonics and radial functions are used, buffers or interpolation regions (B), and an interstitial region (C) where a coarse B-spline mesh is used.</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
<p>Orbitals within region A are computed as</p>
<div class="math notranslate nohighlight">
\[\phi^A_n({\bf r})=R_{n,l,m}(r)Y_{l,m}(\hat{r})\]</div>
<p>Orbitals in region C are computed as the regular B-spline basis described in <a class="reference internal" href="#spo-spline"><span class="std std-ref">Spline basis sets</span></a> above. The region B interpolates between A and C as</p>
<div class="math notranslate nohighlight" id="equation-eq6">
<span class="eqno">(6)<a class="headerlink" href="#equation-eq6" title="Permalink to this equation">¶</a></span>\[\phi^B_n(r) = S(r) \phi^A_n(r) + (1-S(r))\phi^C_n(r)\]</div>
<div class="math notranslate nohighlight" id="equation-eq7">
<span class="eqno">(7)<a class="headerlink" href="#equation-eq7" title="Permalink to this equation">¶</a></span>\[(S(r) = \frac{1}{2}-\frac{1}{2} tanh \left[\alpha\left(\frac{r-r_{\rm A/B}}{r_{\rm B/C}-r_{\rm A/B}}-\frac{1}{2}\right)\right]\]</div>
<p>To enable hybrid orbital representation, the input XML needs to see the tag <code class="docutils literal notranslate"><span class="pre">hybridrep=&quot;yes&quot;</span></code> shown in <a class="reference internal" href="#listing-6"><span class="std std-ref">Listing 6</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="listing-6">
<div class="code-block-caption"><span class="caption-number">Listing 6 </span><span class="caption-text">Hybrid orbital representation input example.</span><a class="headerlink" href="#listing-6" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">determinantset</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;bspline&quot;</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;i&quot;</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;pwscf.h5&quot;</span>
              <span class="n">tilematrix</span><span class="o">=</span><span class="s2">&quot;1 1 3 1 2 -1 -2 1 0&quot;</span> <span class="n">twistnum</span><span class="o">=</span><span class="s2">&quot;-1&quot;</span> <span class="n">gpu</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span> <span class="n">meshfactor</span><span class="o">=</span><span class="s2">&quot;0.8&quot;</span>
              <span class="n">twist</span><span class="o">=</span><span class="s2">&quot;0  0  0&quot;</span> <span class="n">precision</span><span class="o">=</span><span class="s2">&quot;single&quot;</span> <span class="n">hybridrep</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="o">&gt;</span>
  <span class="o">...</span>
<span class="o">&lt;/</span><span class="n">determinantset</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<p>Second, the information describing the atomic regions is required in the particle set, shown in <a class="reference internal" href="#listing-7"><span class="std std-ref">Listing 7</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="listing-7">
<div class="code-block-caption"><span class="caption-number">Listing 7 </span><span class="caption-text">particleset elements for ions with information needed by hybrid orbital representation.</span><a class="headerlink" href="#listing-7" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">group</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Ni&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;charge&quot;</span><span class="o">&gt;</span>          <span class="mi">18</span> <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;valence&quot;</span><span class="o">&gt;</span>         <span class="mi">18</span> <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;atomicnumber&quot;</span> <span class="o">&gt;</span>   <span class="mi">28</span> <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;cutoff_radius&quot;</span> <span class="o">&gt;</span> <span class="mf">1.6</span> <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;inner_cutoff&quot;</span> <span class="o">&gt;</span>  <span class="mf">1.3</span> <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;lmax&quot;</span> <span class="o">&gt;</span>            <span class="mi">5</span> <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;spline_radius&quot;</span> <span class="o">&gt;</span> <span class="mf">1.8</span> <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;spline_npoints&quot;</span><span class="o">&gt;</span>  <span class="mi">91</span> <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">group</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<p>The parameters specific to hybrid representation are listed as</p>
<p><code class="docutils literal notranslate"><span class="pre">attrib</span></code> element</p>
<p>Attribute:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 14%" />
<col style="width: 12%" />
<col style="width: 13%" />
<col style="width: 39%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cutoff_radius</span></code></p></td>
<td><p>Real</p></td>
<td><p>&gt;=0.0</p></td>
<td><p><em>None</em></p></td>
<td><p>Cutoff radius for B/C boundary</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">lmax</span></code></p></td>
<td><p>Integer</p></td>
<td><p>&gt;=0</p></td>
<td><p><em>None</em></p></td>
<td><p>Largest angular channel</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">inner_cutoff</span></code></p></td>
<td><p>Real</p></td>
<td><p>&gt;=0.0</p></td>
<td><p>Dep.</p></td>
<td><p>Cutoff radius for A/B boundary</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">spline_radius</span></code></p></td>
<td><p>Real</p></td>
<td><p>&gt;0.0</p></td>
<td><p>Dep.</p></td>
<td><p>Radial function radius used in spine</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">spline_npoints</span></code></p></td>
<td><p>Integer</p></td>
<td><p>&gt;0</p></td>
<td><p>Dep.</p></td>
<td><p>Number of spline knots</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cutoff_radius</span></code>  is required for every species. If a species is intended to not be covered by atomic regions, setting the value 0.0 will put default values for all the reset parameters. A good value is usually a bit larger than the core radius listed in the pseudopotential file. After a parametric scan, pick the one from the flat energy region with the smallest variance.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lmax</span></code> is required if <code class="docutils literal notranslate"><span class="pre">cutoff_radius</span></code> <span class="math notranslate nohighlight">\(&gt;\)</span> 0.0. This value usually needs to be at least the highest angular momentum plus 2.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inner_cutoff</span></code> is optional and set as <code class="docutils literal notranslate"><span class="pre">cutof\_radius</span></code> <span class="math notranslate nohighlight">\(-0.3\)</span> by default, which is fine in most cases.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spline_radius}</span> <span class="pre">and</span> <span class="pre">``spline_npoints</span></code> are optional. By default, they are calculated based on <code class="docutils literal notranslate"><span class="pre">cutoff_radius</span></code> and a grid displacement 0.02 bohr.
If users prefer inputing them, it is required that <code class="docutils literal notranslate"><span class="pre">cutoff_radius</span></code> &lt;=  <code class="docutils literal notranslate"><span class="pre">spline_radius</span></code> <span class="math notranslate nohighlight">\(-\)</span> 2 <span class="math notranslate nohighlight">\(\times\)</span> <code class="docutils literal notranslate"><span class="pre">spline_radius</span></code>/(<code class="docutils literal notranslate"><span class="pre">spline_npoints</span></code> <span class="math notranslate nohighlight">\(-\)</span> 1).</p></li>
</ul>
<p>In addition, the hybrid orbital representation allows extra optimization to speed up the nonlocal pseudopotential evaluation using the batched algorithm listed in <span class="xref std std-ref">nlpp</span>.</p>
</div>
<div class="section" id="plane-wave-basis-sets">
<span id="pwbasis"></span><h3>Plane-wave basis sets<a class="headerlink" href="#plane-wave-basis-sets" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="homogeneous-electron-gas">
<span id="hegbasis"></span><h3>Homogeneous electron gas<a class="headerlink" href="#homogeneous-electron-gas" title="Permalink to this headline">¶</a></h3>
<p>The interacting Fermi liquid has its own special <code class="docutils literal notranslate"><span class="pre">determinantset</span></code> for filling up a
Fermi surface.  The shell number can be specified separately for both spin-up and spin-down.
This determines how many electrons to include of each time; only closed shells are currently
implemented.  The shells are filled according to the rules of a square box; if other lattice
vectors are used, the electrons might not fill up a complete shell.</p>
<p>This following example can also be used for Helium simulations by specifying the
proper pair interaction in the Hamiltonian section.</p>
<div class="literal-block-wrapper docutils container" id="listing-8">
<div class="code-block-caption"><span class="caption-number">Listing 8 </span><span class="caption-text">2D Fermi liquid example: particle specification</span><a class="headerlink" href="#listing-8" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">qmcsystem</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">simulationcell</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;global&quot;</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;rs&quot;</span> <span class="n">pol</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="n">condition</span><span class="o">=</span><span class="s2">&quot;74&quot;</span><span class="o">&gt;</span><span class="mf">6.5</span><span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;bconds&quot;</span><span class="o">&gt;</span><span class="n">p</span> <span class="n">p</span> <span class="n">p</span><span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;LR_dim_cutoff&quot;</span><span class="o">&gt;</span><span class="mi">15</span><span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">simulationcell</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">particleset</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;e&quot;</span> <span class="n">random</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">group</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;u&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;37&quot;</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;charge&quot;</span><span class="o">&gt;-</span><span class="mi">1</span><span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;mass&quot;</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">group</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">group</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;d&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;37&quot;</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;charge&quot;</span><span class="o">&gt;-</span><span class="mi">1</span><span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;mass&quot;</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">group</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">particleset</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">qmcsystem</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="listing-9">
<div class="code-block-caption"><span class="caption-number">Listing 9 </span><span class="caption-text">2D Fermi liquid example (Slater Jastrow wavefunction)</span><a class="headerlink" href="#listing-9" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">qmcsystem</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">wavefunction</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;psi0&quot;</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;e&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">determinantset</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;electron-gas&quot;</span> <span class="n">shell</span><span class="o">=</span><span class="s2">&quot;7&quot;</span> <span class="n">shell2</span><span class="o">=</span><span class="s2">&quot;7&quot;</span> <span class="n">randomize</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">determinantset</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">jastrow</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;J2&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Two-Body&quot;</span> <span class="n">function</span><span class="o">=</span><span class="s2">&quot;Bspline&quot;</span> <span class="nb">print</span><span class="o">=</span><span class="s2">&quot;no&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">correlation</span> <span class="n">speciesA</span><span class="o">=</span><span class="s2">&quot;u&quot;</span> <span class="n">speciesB</span><span class="o">=</span><span class="s2">&quot;u&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;8&quot;</span> <span class="n">cusp</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">coefficients</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;uu&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Array&quot;</span> <span class="n">optimize</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">correlation</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">correlation</span> <span class="n">speciesA</span><span class="o">=</span><span class="s2">&quot;u&quot;</span> <span class="n">speciesB</span><span class="o">=</span><span class="s2">&quot;d&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;8&quot;</span> <span class="n">cusp</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">coefficients</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;ud&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Array&quot;</span> <span class="n">optimize</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">correlation</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">jastrow</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="simulationcell.html" class="btn btn-neutral float-left" title="Specifying the system to be simulated" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, John Batson

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
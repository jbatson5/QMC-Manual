

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Trial wavefunction specificaion &mdash; QMC Manual 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Specifying the system to be simulated" href="simulationcell.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> QMC Manual
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="features.html">Features of QMCPACK</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Obtaining, installing, and validating QMCPACK</a></li>
<li class="toctree-l1"><a class="reference internal" href="running.html">Running QMCPACK</a></li>
<li class="toctree-l1"><a class="reference internal" href="units.html">Units used in QMCPACK</a></li>
<li class="toctree-l1"><a class="reference internal" href="input_overview.html">Input file overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulationcell.html">Specifying the system to be simulated</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Trial wavefunction specificaion</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#single-determinant-wavefunctons">Single determinant wavefunctons</a></li>
<li class="toctree-l2"><a class="reference internal" href="#single-particle-orbitals">Single-particle orbitals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#spline-basis-sets">Spline basis sets</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">QMC Manual</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Trial wavefunction specificaion</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/intro_wavefunction.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="trial-wavefunction-specificaion">
<span id="intro-wavefunction"></span><h1>Trial wavefunction specificaion<a class="headerlink" href="#trial-wavefunction-specificaion" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<span id="trial-intro"></span><h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This section describes the input blocks associated with the specification of the trial wavefunction in a QMCPACK calculation. These sections are contained within the <code class="docutils literal notranslate"><span class="pre">&lt;wavefunction&gt;</span></code> <span class="math notranslate nohighlight">\(...\)</span>  <code class="docutils literal notranslate"><span class="pre">&lt;/wavefunction&gt;</span></code> xml blocks. <strong>Users are expected to rely on converters to generate the input blocks described in this section.</strong> The converters and the workflows are designed such that input blocks require minimum modifications from users. Unless the workflow requires modification of wavefunction blocks (e.g., setting the cutoff in a multideterminant calculation), only expert users should directly alter them.</p>
<p>The trial wavefunction in QMCPACK has a general product form:</p>
<div class="math notranslate nohighlight" id="equation-eq1">
<span class="eqno">(1)<a class="headerlink" href="#equation-eq1" title="Permalink to this equation">¶</a></span>\[\Psi_T(\vec{r}) = \prod_k \Theta_k(\vec{r}) ,\]</div>
<p>where each <span class="math notranslate nohighlight">\(\Theta_k(\vec{r})\)</span> is a function of the electron coordinates
(and possibly ionic coordinates and variational parameters).
For problems involving electrons, the overall trial wavefunction
must be antisymmetric with respect to electron exchange,
so at least one of the functions in the product must be
antisymmetric. Notice that, although QMCPACK allows for the
construction of arbitrary trial wavefunctions based on the
functions implemented in the code
(e.g., slater determinants, jastrow functions),
the user must make sure that a correct wavefunction is
used for the problem at hand. From here on, we assume a
standard trial wavefunction for an electronic structure problem</p>
<div class="math notranslate nohighlight" id="equation-eq2">
<span class="eqno">(2)<a class="headerlink" href="#equation-eq2" title="Permalink to this equation">¶</a></span>\[Psi_T(\vec{r}) =  \textit{A}(\vec{r}) \prod_k \textit{J}_k(\vec{r}),\]</div>
<p>where <span class="math notranslate nohighlight">\(\textit{A}(\vec{r})\)</span>
is one of the antisymmetric functions: (1) slater determinant, (2) multislater determinant, or (3) pfaffian and <span class="math notranslate nohighlight">\(\textit{J}_k\)</span>
is any of the Jastrow functions (described in <span class="xref std std-ref">jastrow</span>).  The antisymmetric functions are built from a set of single particle orbitals <code class="docutils literal notranslate"><span class="pre">(sposet)</span></code>. QMCPACK implements four different types of <code class="docutils literal notranslate"><span class="pre">sposet</span></code>, described in the following section. Each <code class="docutils literal notranslate"><span class="pre">sposet</span></code> is designed for a different type of calculation, so their definition and generation varies accordingly.</p>
</div>
<div class="section" id="single-determinant-wavefunctons">
<span id="singledeterminant"></span><h2>Single determinant wavefunctons<a class="headerlink" href="#single-determinant-wavefunctons" title="Permalink to this headline">¶</a></h2>
<p>Placing a single determinant for each spin is the most used ansatz for the antisymmetric part of a trial wavefunction.
The input xml block for <code class="docutils literal notranslate"><span class="pre">slaterdeterminant</span></code> is given in <a class="reference internal" href="#listing-1"><span class="std std-ref">Listing 1</span></a>. A list of options is given in
<a class="reference internal" href="#table2"><span class="std std-numref">Table 2</span></a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">slaterdeterminant</span></code> element:</p>
<table class="docutils align-default" id="table2">
<colgroup>
<col style="width: 46%" />
<col style="width: 54%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Parent elements</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">determinantset</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Child elements</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">determinant</span></code></p></td>
</tr>
</tbody>
</table>
<p>Attribute:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 14%" />
<col style="width: 11%" />
<col style="width: 12%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Datatype</p></th>
<th class="head"><p>Values</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delay_rank</span></code></p></td>
<td><p>Integer</p></td>
<td><p>&gt;=0</p></td>
<td><p>1</p></td>
<td><p>Number of delayed updates.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">optimize</span></code></p></td>
<td><p>Text</p></td>
<td><p>yes/no</p></td>
<td><p>yes</p></td>
<td><p>Enable orbital optimization.</p></td>
</tr>
</tbody>
</table>
<p class="centered">
<strong>Table 2 Options for the <code class="docutils literal notranslate"><span class="pre">slaterdeterminant</span></code> xml-block.</strong></p><div class="literal-block-wrapper docutils container" id="listing-1">
<div class="code-block-caption"><span class="caption-number">Listing 1 </span><span class="caption-text">Slaterdeterminant set XML element.</span><a class="headerlink" href="#listing-1" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">slaterdeterminant</span> <span class="n">delay_rank</span><span class="o">=</span><span class="s2">&quot;32&quot;</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">determinant</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;updet&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;208&quot;</span><span class="o">&gt;</span>
     <span class="o">&lt;</span><span class="n">occupation</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span> <span class="n">spindataset</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="o">&gt;</span>
     <span class="o">&lt;/</span><span class="n">occupation</span><span class="o">&gt;</span>
   <span class="o">&lt;/</span><span class="n">determinant</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">determinant</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;downdet&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;208&quot;</span><span class="o">&gt;</span>
     <span class="o">&lt;</span><span class="n">occupation</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span> <span class="n">spindataset</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="o">&gt;</span>
     <span class="o">&lt;/</span><span class="n">occupation</span><span class="o">&gt;</span>
   <span class="o">&lt;/</span><span class="n">determinant</span><span class="o">&gt;</span>
 <span class="o">&lt;/</span><span class="n">slaterdeterminant</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<p>Additional information:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">delay_rank</span></code> This option enables delayed updates of the Slater matrix inverse when particle-by-particle move is used.
By default or if <code class="docutils literal notranslate"><span class="pre">delay_rank=0</span></code> given in the input file, QMCPACK sets 1 for Slater matrices with a leading dimension <span class="math notranslate nohighlight">\(&lt;192\)</span> and 32 otherwise.
<code class="docutils literal notranslate"><span class="pre">delay_rank=1</span></code> uses the Fahy’s variant <a class="bibtex reference internal" href="simulationcell.html#fahy1990" id="id1">[FWL90]</a> of the Sherman-Morrison rank-1 update, which is mostly using memory bandwidth-bound BLAS-2 calls.
With <code class="docutils literal notranslate"><span class="pre">delay_rank&gt;1</span></code>, the delayed update algorithm <a class="bibtex reference internal" href="simulationcell.html#luo2018delayedupdate" id="id2">[LK18]</a><a class="bibtex reference internal" href="simulationcell.html#mcdaniel2017" id="id3">[MDAzevedoL+17]</a> turns most of the computation to compute bound BLAS-3 calls.
Tuning this parameter is highly recommended to gain the best performance on medium-to-large problem sizes (<span class="math notranslate nohighlight">\(&gt;200\)</span> electrons).
We have seen up to an order of magnitude speedup on large problem sizes.
When studying the performance of QMCPACK, a scan of this parameter is required and we recommend starting from 32.
The best <code class="docutils literal notranslate"><span class="pre">delay_rank</span></code> giving the maximal speedup depends on the problem size.
Usually the larger <code class="docutils literal notranslate"><span class="pre">delay_rank</span></code> corresponds to a larger problem size.
On CPUs, <code class="docutils literal notranslate"><span class="pre">delay_rank</span></code> must be chosen as a multiple of SIMD vector length for good performance of BLAS libraries.
The best <code class="docutils literal notranslate"><span class="pre">delay_rank</span></code> depends on the processor microarchitecture.
GPU support is under development.</p></li>
</ul>
</div>
<div class="section" id="single-particle-orbitals">
<span id="singleparticle"></span><h2>Single-particle orbitals<a class="headerlink" href="#single-particle-orbitals" title="Permalink to this headline">¶</a></h2>
<div class="section" id="spline-basis-sets">
<span id="spo-spline"></span><h3>Spline basis sets<a class="headerlink" href="#spline-basis-sets" title="Permalink to this headline">¶</a></h3>
<p>In this section we describe the use of spline basis sets to expand the <code class="docutils literal notranslate"><span class="pre">sposet</span></code>.
Spline basis sets are designed to work seamlessly with plane wave DFT code (e.g.,Quantum ESPRESSO as a trial wavefunction generator).</p>
<p>In QMC algorithms, all the SPOs <span class="math notranslate nohighlight">\(\{\phi(\vec{r})\}\)</span> need to be updated
every time a single electron moves. Evaluating SPOs takes a very large portion of computation time.
In principle, PW basis set can be used to express SPOs directly in QMC, as in DFT.
But it introduces an unfavorable scaling because the basis set size increases linearly as the system size.
For this reason, it is efficient to use a localized basis with compact
support and a good transferability from the plane wave basis.</p>
<p>In particular, 3D tricubic B-splines provide a basis in which only
64 elements are nonzero at any given point in <a class="bibtex reference internal" href="simulationcell.html#blips4qmc" id="id4">[AlfeG04]</a>.
The 1D cubic B-spline is given by</p>
<div class="math notranslate nohighlight" id="equation-eq3">
<span class="eqno">(3)<a class="headerlink" href="#equation-eq3" title="Permalink to this equation">¶</a></span>\[f(x) = \sum_{i'=i-1}^{i+2} b^{i'\!,3}(x)\,\,  p_{i'},\]</div>
<p>where <span class="math notranslate nohighlight">\(b^{i}(x)\)</span> is the piecewise cubic polynomial basis functions
and <span class="math notranslate nohighlight">\(i = \text{floor}(\Delta^{-1} x)\)</span> is the index of the first
grid point <span class="math notranslate nohighlight">\(\le x\)</span>. Constructing a tensor product in each
Cartesian direction, we can represent a 3D orbital as</p>
<div class="math notranslate nohighlight" id="equation-eq4">
<span class="eqno">(4)<a class="headerlink" href="#equation-eq4" title="Permalink to this equation">¶</a></span>\[\phi_n(x,y,z) =
    \!\!\!\!\sum_{i'=i-1}^{i+2} \!\! b_x^{i'\!,3}(x)
    \!\!\!\!\sum_{j'=j-1}^{j+2} \!\! b_y^{j'\!,3}(y)
    \!\!\!\!\sum_{k'=k-1}^{k+2} \!\! b_z^{k'\!,3}(z) \,\, p_{i', j', k',n}.\]</div>
<p>This allows the rapid evaluation of each orbital in constant time.
Furthermore, this basis is systematically improvable with a single spacing
parameter so that accuracy is not compromised compared with the plane wave basis.</p>
<p>The use of 3D tricubic B-splines greatly improves computational efficiency.
The gain in computation time from a plane wave basis set to an equivalent B-spline basis set
becomes increasingly large as the system size grows.
On the downside, this computational efficiency comes at
the expense of increased memory use, which is easily overcome, however, by the large
aggregate memory available per node through OpenMP/MPI hybrid QMC.</p>
<p>The input xml block for the spline SPOs is given in <a class="reference internal" href="#listing-2"><span class="std std-ref">Listing 2</span></a>. A list of options is given in
<a class="reference internal" href="#table3"><span class="std std-numref">Table 3</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="listing-2">
<div class="code-block-caption"><span class="caption-number">Listing 2 </span><span class="caption-text">Determinant set XML element.</span><a class="headerlink" href="#listing-2" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">determinantset</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;bspline&quot;</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;i&quot;</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;pwscf.h5&quot;</span>
                <span class="n">tilematrix</span><span class="o">=</span><span class="s2">&quot;1 1 3 1 2 -1 -2 1 0&quot;</span> <span class="n">twistnum</span><span class="o">=</span><span class="s2">&quot;-1&quot;</span> <span class="n">gpu</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span> <span class="n">meshfactor</span><span class="o">=</span><span class="s2">&quot;0.8&quot;</span>
                <span class="n">twist</span><span class="o">=</span><span class="s2">&quot;0  0  0&quot;</span> <span class="n">precision</span><span class="o">=</span><span class="s2">&quot;double&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">slaterdeterminant</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">determinant</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;updet&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;208&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">occupation</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span> <span class="n">spindataset</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">occupation</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">determinant</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">determinant</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;downdet&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;208&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">occupation</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span> <span class="n">spindataset</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">occupation</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">determinant</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">slaterdeterminant</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">determinantset</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">determinantset</span></code> element:</p>
<table class="docutils align-default" id="table3">
<colgroup>
<col style="width: 43%" />
<col style="width: 58%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Parent elements</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wavefunction</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Child elements</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">slaterdeterminant</span></code></p></td>
</tr>
</tbody>
</table>
<p>attribute:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 10%" />
<col style="width: 22%" />
<col style="width: 8%" />
<col style="width: 36%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Datatype</p></th>
<th class="head"><p>Values</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">type</span></code></p></td>
<td><p>Text</p></td>
<td><p>Bspline</p></td>
<td></td>
<td><p>Type of <code class="docutils literal notranslate"><span class="pre">sposet</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">href</span></code></p></td>
<td><p>Text</p></td>
<td></td>
<td></td>
<td><p>Path to hdf5 file from pw2qmcpack.x.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">tilematrix</span></code></p></td>
<td><p>9 integers</p></td>
<td></td>
<td></td>
<td><p>Tiling matrix used to expand supercell.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">twistnum</span></code></p></td>
<td><p>Integer</p></td>
<td></td>
<td></td>
<td><p>Index of the super twist.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">twist</span></code></p></td>
<td><p>3 floats</p></td>
<td></td>
<td></td>
<td><p>Super twist.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">meshfactor</span></code></p></td>
<td><p>Float</p></td>
<td><p><span class="math notranslate nohighlight">\(\le 1.0\)</span></p></td>
<td></td>
<td><p>Grid spacing ratio.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">precision</span></code></p></td>
<td><p>Text</p></td>
<td><p>Single/double</p></td>
<td></td>
<td><p>Precision of spline coefficients</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">gpu</span></code></p></td>
<td><p>Text</p></td>
<td><p>Yes/no</p></td>
<td></td>
<td><p>GPU switch.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">gpusharing</span></code></p></td>
<td><p>Text</p></td>
<td><p>Yes/no</p></td>
<td><p>No</p></td>
<td><p>Share B-spline table across GPUs.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Spline_Size_Limit_MB</span></code></p></td>
<td><p>Integer</p></td>
<td></td>
<td></td>
<td><p>Limit B-spline table size on GPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">check_orb_norm</span></code></p></td>
<td><p>Text</p></td>
<td><p>Yes/no</p></td>
<td><p>Yes</p></td>
<td><p>Check norms of orbitals from h5 file.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">save_coefs</span></code></p></td>
<td><p>Text</p></td>
<td><p>Yes/no</p></td>
<td><p>No</p></td>
<td><p>Save the spline coefficients to h5 file.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">source</span></code></p></td>
<td><p>Text</p></td>
<td><p>Any</p></td>
<td><p>Ion0</p></td>
<td><p>Particle set with atomic positions.</p></td>
</tr>
</tbody>
</table>
<p class="centered">
<strong>Table 3 Options for the <code class="docutils literal notranslate"><span class="pre">determinantset</span></code> xml-block associated with B-spline single particle orbital sets.</strong></p><p>Additional information:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">precision</span></code>. Only effective on CPU versions without mixed
precision, “single” is always imposed with mixed precision. Using
single precision not only saves memory use but also speeds up the
B-spline evaluation. We recommend using single precision since we saw
little chance of really compromising the accuracy of calculation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">meshfactor</span></code>. The ratio of actual grid spacing of B-splines used in
QMC calculation with respect to the original one calculated from h5.
A smaller meshfactor saves memory use but reduces accuracy. The
effects are similar to reducing plane wave cutoff in DFT
calculations. Use with caution!</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">twistnum</span></code>. If positive, it is the index. We recommend not taking
this way since the indexing might show some uncertainty. If negative,
the super twist is referred by <code class="docutils literal notranslate"><span class="pre">twist</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">save_coefs</span></code>. If yes, dump the real-space B-spline coefficient
table into an h5 file on the disk. When the orbital transformation
from k space to B-spline requires more than the available amount of
scratch memory on the compute nodes, users can perform this step on
fat nodes and transfer back the h5 file for QMC calculations.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gpusharing</span></code>. If enabled, spline data is shared across multiple
GPUs on a given computational node. For example, on a
two-GPU-per-node system, each GPU would have half of the orbitals.
This enables larger overall spline tables than would normally fit in
the memory of individual GPUs to be used, potentially up to the total
GPU memory on a node. To obtain high performance, large electron
counts or a high-performing CPU-GPU interconnect is required. To use
this feature, the following needs to be done:</p>
<blockquote>
<div><ul class="simple">
<li><p>The CUDA Multi-Process Service (MPS) needs to be used (e.g., on</p></li>
</ul>
<p>Summit/SummitDev use “-alloc_flags gpumps” for bsub). If MPS is not
detected, sharing will be disabled.</p>
<ul class="simple">
<li><p>CUDA_VISIBLE_DEVICES needs to be properly set to control each rank’s</p></li>
</ul>
<p>visible CUDA devices (e.g., on OLCF Summit/SummitDev one needs to
create a resource set containing all GPUs with the respective number
of ranks with “jsrun –task-per-rs Ngpus -g Ngpus”).</p>
</div></blockquote>
</li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="simulationcell.html" class="btn btn-neutral float-left" title="Specifying the system to be simulated" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, John Batson

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
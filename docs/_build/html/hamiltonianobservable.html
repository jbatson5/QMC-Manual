

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Hamiltonian and Observables &mdash; QMCPACK Manual  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Quantum Monte Carlo Methods" href="methods.html" />
    <link rel="prev" title="Trial wavefunction specificaion" href="intro_wavefunction.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> QMCPACK Manual
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="features.html">Features of QMCPACK</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Obtaining, installing, and validating QMCPACK</a></li>
<li class="toctree-l1"><a class="reference internal" href="running.html">Running QMCPACK</a></li>
<li class="toctree-l1"><a class="reference internal" href="units.html">Units used in QMCPACK</a></li>
<li class="toctree-l1"><a class="reference internal" href="input_overview.html">Input file overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulationcell.html">Specifying the system to be simulated</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro_wavefunction.html">Trial wavefunction specificaion</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Hamiltonian and Observables</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-hamiltonian">The Hamiltonian</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pair-potentials">Pair potentials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#coulomb-potentials">Coulomb potentials</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pseudopotentials">Pseudopotentials</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mpc-interaction-correction">MPC Interaction/correction</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#general-estimators">General estimators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#chiesa-ceperley-martin-holzmann-kinetic-energy-correction">Chiesa-Ceperley-Martin-Holzmann kinetic energy correction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#density-estimator">Density estimator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spin-density-estimator">Spin density estimator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pair-correlation-function-g-r">Pair correlation function, <span class="math notranslate nohighlight">\(g(r)\)</span></a></li>
<li class="toctree-l3"><a class="reference internal" href="#static-structure-factor-s-k">Static structure factor, <span class="math notranslate nohighlight">\(S(k)\)</span></a></li>
<li class="toctree-l3"><a class="reference internal" href="#static-structure-factor-skall">Static structure factor, <code class="docutils literal notranslate"><span class="pre">SkAll</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#species-kinetic-energy">Species kinetic energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lattice-deviation-estimator">Lattice deviation estimator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#energy-density-estimator">Energy density estimator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#one-body-density-matrix">One body density matrix</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#forward-walking-estimators">Forward-Walking Estimators</a></li>
<li class="toctree-l2"><a class="reference internal" href="#force-estimators">“Force” estimators</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="methods.html">Quantum Monte Carlo Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="output_overview.html">Output Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="analyzing.html">Analyzing QMCPACK data</a></li>
<li class="toctree-l1"><a class="reference internal" href="LCAO.html">Periodic LCAO for Solids</a></li>
<li class="toctree-l1"><a class="reference internal" href="sCI.html">Selected Configuration Interaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="afqmc.html">Auxiliary-Field Quantum Monte Carlo</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab_qmc_statistics.html">Lab 1: MC Statistical Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab_qmc_basics.html">Lab 2: QMC Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab_advanced_molecules.html">Lab 3: Advanced molecular calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab_condensed_matter.html">Lab 4: Condensed Matter Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab_excited.html">Lab 5: Excited state calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="additional_tools.html">Additional Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="external_tools.html">External Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to the Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="unit_testing.html">Unit Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="design_features.html">QMCPACK Design and Feature Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="developing.html">Development Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendices.html">Appendices</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">QMCPACK Manual</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Hamiltonian and Observables</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/hamiltonianobservable.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="hamiltonian-and-observables">
<span id="hamiltobs"></span><h1>Hamiltonian and Observables<a class="headerlink" href="#hamiltonian-and-observables" title="Permalink to this headline">¶</a></h1>
<p>QMCPACK is capable of the simultaneous measurement of the Hamiltonian and many other quantum operators.  The Hamiltonian attains a special status among the available operators (also referred to as observables) because it ultimately generates all available information regarding the quantum system.  This is evident from an algorithmic standpoint as well since the Hamiltonian (embodied in the projector) generates the imaginary time dynamics of the walkers in DMC and reptation Monte Carlo (RMC).</p>
<p>This section covers how the Hamiltonian can be specified, component by component, by the user in the XML format native to qmcpack. It also covers the input structure of statistical estimators corresponding to quantum observables such as the density, static structure factor, and forces.</p>
<div class="section" id="the-hamiltonian">
<h2>The Hamiltonian<a class="headerlink" href="#the-hamiltonian" title="Permalink to this headline">¶</a></h2>
<p>The many-body Hamiltonian in Hartree units is given by</p>
<div class="math notranslate nohighlight" id="equation-eq28">
<span class="eqno">(28)<a class="headerlink" href="#equation-eq28" title="Permalink to this equation">¶</a></span>\[\hat{H} = -\sum_i\frac{1}{2m_i}\nabla_i^2 + \sum_iv^{ext}(r_i) + \sum_{i&lt;j}v^{qq}(r_i,r_j)   + \sum_{i\ell}v^{qc}(r_i,r_\ell)   + \sum_{\ell&lt;m}v^{cc}(r_\ell,r_m)\:.\]</div>
<p>Here, the sums indexed by <span class="math notranslate nohighlight">\(i/j\)</span> are over quantum particles, while
<span class="math notranslate nohighlight">\(\ell/m\)</span> are reserved for classical particles. Often the quantum
particles are electrons, and the classical particles are ions, though is
not limited in this way. The mass of each quantum particle is denoted
<span class="math notranslate nohighlight">\(m_i\)</span>, <span class="math notranslate nohighlight">\(v^{qq}/v^{qc}/v^{cc}\)</span> are pair potentials between
quantum-quantum/quantum-classical/classical-classical particles, and
<span class="math notranslate nohighlight">\(v^{ext}\)</span> denotes a purely external potential.</p>
<p>QMCPACK is designed modularly so that any potential can be supported with
minimal additions to the code base. Potentials currently supported
include Coulomb interactions in open and periodic boundary conditions,
the MPC potential, nonlocal pseudopotentials, helium pair potentials,
and various model potentials such as hard sphere, Gaussian, and modified
Poschl-Teller.</p>
<p>Reference information and examples for the <code class="docutils literal notranslate"><span class="pre">&lt;hamiltonian/&gt;</span></code> XML
element are provided subsequently. Detailed descriptions of the input
for individual potentials is given in the sections that follow.</p>
<p><code class="docutils literal notranslate"><span class="pre">hamiltonian</span></code> element:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 26%" />
<col style="width: 74%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>parent elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">simulation,</span> <span class="pre">qmcsystem</span></code></p></td>
</tr>
<tr class="row-even"><td><p>child elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pairpot</span> <span class="pre">extpot</span> <span class="pre">estimator</span> <span class="pre">constant</span></code> (deprecated)</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>attributes:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 12%" />
<col style="width: 19%" />
<col style="width: 11%" />
<col style="width: 37%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">name/id</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>text</p></td>
<td><p><em>anything</em></p></td>
<td><p>h0</p></td>
<td><p>Unique id for this Hamiltonian instance</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">type</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>text</p></td>
<td></td>
<td><p>generic</p></td>
<td><p><em>No current function</em></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">role</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>text</p></td>
<td><p>primary/extra</p></td>
<td><p>extra</p></td>
<td><p>Designate as Hamiltonian or not</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">source</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>text</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">particleset.name</span></code></p></td>
<td><p>i</p></td>
<td><p>Identify classical <code class="docutils literal notranslate"><span class="pre">particleset</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">target</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>text</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">particleset.name</span></code></p></td>
<td><p>e</p></td>
<td><p>Identify quantum <code class="docutils literal notranslate"><span class="pre">particleset</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">default</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>yes</p></td>
<td><p>Include kinetic energy term implicitly</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Additional information:</p>
<ul class="simple">
<li><p><strong>target:</strong> Must be set to the name of the quantum <code class="docutils literal notranslate"><span class="pre">particleset</span></code>.
The default value is typically sufficient. In normal usage, no other
attributes are provided.</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="listing-14">
<div class="code-block-caption"><span class="caption-number">Listing 14 </span><span class="caption-text">All electron Hamiltonian XML element.</span><a class="headerlink" href="#listing-14" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">hamiltonian</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;e&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">pairpot</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ElecElec&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;coulomb&quot;</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;e&quot;</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;e&quot;</span><span class="o">/&gt;</span>
  <span class="o">&lt;</span><span class="n">pairpot</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ElecIon&quot;</span>  <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;coulomb&quot;</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;i&quot;</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;e&quot;</span><span class="o">/&gt;</span>
  <span class="o">&lt;</span><span class="n">pairpot</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;IonIon&quot;</span>   <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;coulomb&quot;</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;i&quot;</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;i&quot;</span><span class="o">/&gt;</span>
<span class="o">&lt;/</span><span class="n">hamiltonian</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="listing-15">
<div class="code-block-caption"><span class="caption-number">Listing 15 </span><span class="caption-text">Pseudopotential Hamiltonian XML element.</span><a class="headerlink" href="#listing-15" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">hamiltonian</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;e&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">pairpot</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ElecElec&quot;</span>  <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;coulomb&quot;</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;e&quot;</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;e&quot;</span><span class="o">/&gt;</span>
  <span class="o">&lt;</span><span class="n">pairpot</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;PseudoPot&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;pseudo&quot;</span>  <span class="n">source</span><span class="o">=</span><span class="s2">&quot;i&quot;</span> <span class="n">wavefunction</span><span class="o">=</span><span class="s2">&quot;psi0&quot;</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;xml&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">pseudo</span> <span class="n">elementType</span><span class="o">=</span><span class="s2">&quot;Li&quot;</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;Li.xml&quot;</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="n">pseudo</span> <span class="n">elementType</span><span class="o">=</span><span class="s2">&quot;H&quot;</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;H.xml&quot;</span><span class="o">/&gt;</span>
  <span class="o">&lt;/</span><span class="n">pairpot</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">pairpot</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;IonIon&quot;</span>    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;coulomb&quot;</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;i&quot;</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;i&quot;</span><span class="o">/&gt;</span>
<span class="o">&lt;/</span><span class="n">hamiltonian</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="pair-potentials">
<h2>Pair potentials<a class="headerlink" href="#pair-potentials" title="Permalink to this headline">¶</a></h2>
<p>Many pair potentials are supported.  Though only the most commonly used pair potentials are covered in detail in this section, all currently available potentials are listed subsequently.  If a potential you desire is not listed, or is not present at all, feel free to contact the developers.</p>
<p><code class="docutils literal notranslate"><span class="pre">pairpot</span></code> factory element:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 47%" />
<col style="width: 53%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>parent elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian</span></code></p></td>
</tr>
<tr class="row-even"><td><p>child elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">type</span></code> attribute</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 12%" />
<col style="width: 64%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>type options</strong></p></td>
<td><p>coulomb</p></td>
<td><p>Coulomb/Ewald potential</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>pseudo</p></td>
<td><p>Semilocal pseudopotential</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>mpc</p></td>
<td><p>Model periodic Coulomb interaction/correction</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>cpp</p></td>
<td><p>Core polarization potential</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>skpot</p></td>
<td><p><em>Unknown</em></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>shared attributes:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 12%" />
<col style="width: 19%" />
<col style="width: 21%" />
<col style="width: 28%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">type</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><em>See above</em></p></td>
<td><p>0</p></td>
<td><p>Select pairpot type</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">name</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><em>Anything</em></p></td>
<td><p>any</p></td>
<td><p>Unique name for this pairpot</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">source</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">particleset.name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian.target</span></code></p></td>
<td><p>Identify interacting particles</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">target</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">particleset.name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian.target</span></code></p></td>
<td><p>Identify interacting particles</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">units</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>text</p></td>
<td></td>
<td><p>hartree</p></td>
<td><p><em>No current function</em></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Additional information:</p>
<ul class="simple">
<li><p><strong>type:</strong> Used to select the desired pair potential. Must be selected
from the list of type options.</p></li>
<li><p><strong>name:</strong> A unique name used to identify this pair potential. Block
averaged output data will appear under this name in <code class="docutils literal notranslate"><span class="pre">scalar.dat</span></code>
and/or <code class="docutils literal notranslate"><span class="pre">stat.h5</span></code> files.</p></li>
<li><p><strong>source/target:</strong> These specify the particles involved in a pair
interaction. If an interaction is between classical (e.g., ions) and
quantum (e.g., electrons), <code class="docutils literal notranslate"><span class="pre">source</span></code>/<code class="docutils literal notranslate"><span class="pre">target</span></code> should be the name
of the classical/quantum <code class="docutils literal notranslate"><span class="pre">particleset</span></code>.</p></li>
<li><p>Only <code class="docutils literal notranslate"><span class="pre">Coulomb,</span> <span class="pre">pseudo</span></code>, and <code class="docutils literal notranslate"><span class="pre">mpc</span></code> are described in detail in the
following subsections. The older or less-used types (<code class="docutils literal notranslate"><span class="pre">cpp,</span> <span class="pre">skpot</span></code>)
are not covered.</p></li>
<li><p>Available only if <code class="docutils literal notranslate"><span class="pre">QMC_CUDA</span></code> is not defined: <code class="docutils literal notranslate"><span class="pre">skpot</span></code>.</p></li>
<li><p>Available only if <code class="docutils literal notranslate"><span class="pre">OHMMS_DIM==3</span></code>: <code class="docutils literal notranslate"><span class="pre">mpc,</span> <span class="pre">vhxc,</span> <span class="pre">pseudo</span></code>.</p></li>
<li><p>Available only if <code class="docutils literal notranslate"><span class="pre">OHMMS_DIM==3</span></code> and <code class="docutils literal notranslate"><span class="pre">QMC_CUDA</span></code> is not defined:
<code class="docutils literal notranslate"><span class="pre">cpp</span></code>.</p></li>
</ul>
<div class="section" id="coulomb-potentials">
<h3>Coulomb potentials<a class="headerlink" href="#coulomb-potentials" title="Permalink to this headline">¶</a></h3>
<p>The bare Coulomb potential is used in open boundary conditions:</p>
<div class="math notranslate nohighlight" id="equation-eq29">
<span class="eqno">(29)<a class="headerlink" href="#equation-eq29" title="Permalink to this equation">¶</a></span>\[V_c^{open} = \sum_{i&lt;j}\frac{q_iq_j}{\left|{r_i-r_j}\right|}\:.\]</div>
<p>When periodic boundary conditions are selected, Ewald summation is used automatically:</p>
<div class="math notranslate nohighlight" id="equation-eq30">
<span class="eqno">(30)<a class="headerlink" href="#equation-eq30" title="Permalink to this equation">¶</a></span>\[V_c^{pbc} = \sum_{i&lt;j}\frac{q_iq_j}{\left|{r_i-r_j}\right|} + \frac{1}{2}\sum_{L\ne0}\sum_{i,j}\frac{q_iq_j}{\left|{r_i-r_j+L}\right|}\:.\]</div>
<p>The sum indexed by <span class="math notranslate nohighlight">\(L\)</span> is over all nonzero simulation cell lattice vectors.  In practice, the Ewald sum is broken into short- and long-range parts in a manner optimized for efficiency (see <a class="bibtex reference internal" href="design_features.html#natoli1995" id="id1">[NC95]</a>) for details.</p>
<p>For information on how to set the boundary conditions, consult <a class="reference internal" href="simulationcell.html#simulationcell"><span class="std std-ref">Specifying the system to be simulated</span></a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">pairpot</span> <span class="pre">type=coulomb</span></code> element:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 51%" />
<col style="width: 49%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>parent elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian</span></code></p></td>
</tr>
<tr class="row-even"><td><p>child elements:</p></td>
<td><p><em>None</em></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>attributes:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 12%" />
<col style="width: 19%" />
<col style="width: 20%" />
<col style="width: 28%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">type</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><strong>coulomb</strong></p></td>
<td></td>
<td><p>Must be coulomb</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">name/id</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><em>anything</em></p></td>
<td><p>ElecElec</p></td>
<td><p>Unique name for interaction</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">source</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">particleset.name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian.target</span></code></p></td>
<td><p>Identify interacting particles</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">target</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">particleset.name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian.target</span></code></p></td>
<td><p>Identify interacting particles</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pbc</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>yes</p></td>
<td><p>Use Ewald summation</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">physical</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>yes</p></td>
<td><p>Hamiltonian(yes)/Observable(no)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">forces</span></code></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>no</p></td>
<td><p><em>Deprecated</em></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Additional information:</p>
<ul class="simple">
<li><p><strong>type/source/target:</strong> See description for the previous generic
<code class="docutils literal notranslate"><span class="pre">pairpot</span></code> factory element.</p></li>
<li><p><strong>name:</strong> Traditional user-specified names for electron-electron,
electron-ion, and ion-ion terms are <code class="docutils literal notranslate"><span class="pre">ElecElec</span></code>, <code class="docutils literal notranslate"><span class="pre">ElecIon</span></code>, and
<code class="docutils literal notranslate"><span class="pre">IonIon</span></code>, respectively. Although any choice can be used, the data
analysis tools expect to find columns in <code class="docutils literal notranslate"><span class="pre">*.scalar.dat</span></code> with these
names.</p></li>
<li><p><strong>pbc</strong>: Ewald summation will not be performed if
<code class="docutils literal notranslate"><span class="pre">simulationcell.bconds==</span> <span class="pre">n</span> <span class="pre">n</span> <span class="pre">n</span></code>, regardless of the value of
<code class="docutils literal notranslate"><span class="pre">pbc</span></code>. Similarly, the <code class="docutils literal notranslate"><span class="pre">pbc</span></code> attribute can only be used to turn
off Ewald summation if <code class="docutils literal notranslate"><span class="pre">simulationcell.bconds!=</span> <span class="pre">n</span> <span class="pre">n</span> <span class="pre">n</span></code>. The default
value is recommended.</p></li>
<li><p><strong>physical</strong>: If <code class="docutils literal notranslate"><span class="pre">physical==yes</span></code>, this pair potential is included
in the Hamiltonian and will factor into the <code class="docutils literal notranslate"><span class="pre">LocalEnergy</span></code> reported
by QMCPACK and also in the DMC branching weight. If <code class="docutils literal notranslate"><span class="pre">physical==no</span></code>,
then the pair potential is treated as a passive observable but not as
part of the Hamiltonian itself. As such it does not contribute to the
outputted <code class="docutils literal notranslate"><span class="pre">LocalEnergy</span></code>. Regardless of the value of <code class="docutils literal notranslate"><span class="pre">physical</span></code>
output data will appear in <code class="docutils literal notranslate"><span class="pre">scalar.dat</span></code> in a column headed by
<code class="docutils literal notranslate"><span class="pre">name</span></code>.</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="listing-16">
<div class="code-block-caption"><span class="caption-number">Listing 16 </span><span class="caption-text">QMCPXML element for Coulomb interaction between electrons.</span><a class="headerlink" href="#listing-16" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">pairpot</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ElecElec&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;coulomb&quot;</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;e&quot;</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;e&quot;</span><span class="o">/&gt;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="listing-17">
<div class="code-block-caption"><span class="caption-number">Listing 17 </span><span class="caption-text">QMCPXML element for Coulomb interaction between electrons and ions (all-electron only).</span><a class="headerlink" href="#listing-17" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">pairpot</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ElecIon&quot;</span>  <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;coulomb&quot;</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;i&quot;</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;e&quot;</span><span class="o">/&gt;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="listing-18">
<div class="code-block-caption"><span class="caption-number">Listing 18 </span><span class="caption-text">QMCPXML element for Coulomb interaction between ions.</span><a class="headerlink" href="#listing-18" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">pairpot</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;IonIon&quot;</span>   <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;coulomb&quot;</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;i&quot;</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;i&quot;</span><span class="o">/&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="pseudopotentials">
<span id="nlpp"></span><h3>Pseudopotentials<a class="headerlink" href="#pseudopotentials" title="Permalink to this headline">¶</a></h3>
<p>QMCPACK supports pseudopotentials in semilocal form, which is local in the
radial coordinate and nonlocal in angular coordinates. When all angular
momentum channels above a certain threshold (<span class="math notranslate nohighlight">\(\ell_{max}\)</span>) are
well approximated by the same potential
(<span class="math notranslate nohighlight">\(V_{\bar{\ell}}\equiv V_{loc}\)</span>), the pseudopotential separates
into a fully local channel and an angularly nonlocal component:</p>
<div class="math notranslate nohighlight" id="equation-eq31">
<span class="eqno">(31)<a class="headerlink" href="#equation-eq31" title="Permalink to this equation">¶</a></span>\[V^{PP} = \sum_{ij}\Big(V_{\bar{\ell}}(\left|{r_i-\tilde{r}_j}\right|) + \sum_{\ell\ne\bar{\ell}}^{\ell_{max}}\sum_{m=-\ell}^\ell |{Y_{\ell m}}\rangle{\big[V_\ell(\left|{r_i-\tilde{r}_j}\right|) - V_{\bar{\ell}}(\left|{r_i-\tilde{r}_j}\right|) \big]}\langle{Y_{\ell m}}| \Big)\:.\]</div>
<p>Here the electron/ion index is <span class="math notranslate nohighlight">\(i/j\)</span>, and only one type of ion is
shown for simplicity.</p>
<p>Evaluation of the localized pseudopotential energy
<span class="math notranslate nohighlight">\(\Psi_T^{-1}V^{PP}\Psi_T\)</span> requires additional angular integrals.
These integrals are evaluated on a randomly shifted angular grid. The
size of this grid is determined by <span class="math notranslate nohighlight">\(\ell_{max}\)</span>. See
<a class="bibtex reference internal" href="#mitas1991" id="id2">[MSC91]</a> for further detail.</p>
<p>uses the FSAtom pseudopotential file format associated with the “Free
Software Project for Atomic-scale Simulations” initiated in 2002. See
<a class="reference external" href="http://www.tddft.org/fsatom/manifest.php">http://www.tddft.org/fsatom/manifest.php</a> for more information. The
FSAtom format uses XML for structured data. Files in this format do not
use a specific identifying file extension; instead they are simply
suffixed with “<code class="docutils literal notranslate"><span class="pre">.xml</span></code>.” The tabular data format of CASINO is also
supported.</p>
<p><code class="docutils literal notranslate"><span class="pre">pairpot</span> <span class="pre">type=pseudo</span></code> element:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 51%" />
<col style="width: 49%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>parent elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian</span></code></p></td>
</tr>
<tr class="row-even"><td><p>child elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pseudo</span></code></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>attributes:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 10%" />
<col style="width: 17%" />
<col style="width: 18%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">type</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><strong>pseudo</strong></p></td>
<td></td>
<td><p>Must be pseudo</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">name/id</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><em>anything</em></p></td>
<td><p>PseudoPot</p></td>
<td><p><em>No current function</em></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">source</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">particleset.name</span></code></p></td>
<td><p>i</p></td>
<td><p>Ion <code class="docutils literal notranslate"><span class="pre">particleset</span></code> name</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">target</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">particleset.name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian.target</span></code></p></td>
<td><p>Electron <code class="docutils literal notranslate"><span class="pre">particleset</span></code> name</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pbc</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>yes*</p></td>
<td><p>Use Ewald summation</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">forces</span></code></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>no</p></td>
<td><p><em>Deprecated</em></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">wavefunction</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wavefunction.name</span></code></p></td>
<td><p>invalid</p></td>
<td><p>Identify wavefunction</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">format</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p>xml/table</p></td>
<td><p>table</p></td>
<td><p>Select file format</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>text</p></td>
<td><p>batched/default</p></td>
<td><p>default</p></td>
<td><p>Choose NLPP algorithm</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DLA</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>text</p></td>
<td><p>yes/no</p></td>
<td><p>no</p></td>
<td><p>Use determinant localization approximation</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Additional information:</p>
<ul class="simple">
<li><p><strong>type/source/target</strong> See description for the generic <code class="docutils literal notranslate"><span class="pre">pairpot</span></code>
factory element.</p></li>
<li><p><strong>name:</strong> Ignored. Instead, default names will be present in
<code class="docutils literal notranslate"><span class="pre">*scalar.dat</span></code> output files when pseudopotentials are used. The
field <code class="docutils literal notranslate"><span class="pre">LocalECP</span></code> refers to the local part of the pseudopotential.
If nonlocal channels are present, a <code class="docutils literal notranslate"><span class="pre">NonLocalECP</span></code> field will be
added that contains the nonlocal energy summed over all angular
momentum channels.</p></li>
<li><p><strong>pbc:</strong> Ewald summation will not be performed if
<code class="docutils literal notranslate"><span class="pre">simulationcell.bconds==</span> <span class="pre">n</span> <span class="pre">n</span> <span class="pre">n</span></code>, regardless of the value of
<code class="docutils literal notranslate"><span class="pre">pbc</span></code>. Similarly, the <code class="docutils literal notranslate"><span class="pre">pbc</span></code> attribute can only be used to turn
off Ewald summation if <code class="docutils literal notranslate"><span class="pre">simulationcell.bconds!=</span> <span class="pre">n</span> <span class="pre">n</span> <span class="pre">n</span></code>.</p></li>
<li><p><strong>format:</strong> If <code class="docutils literal notranslate"><span class="pre">format</span></code>==table, QMCPACK looks for <code class="docutils literal notranslate"><span class="pre">*.psf</span></code> files
containing pseudopotential data in a tabular format. The files must
be named after the ionic species provided in <code class="docutils literal notranslate"><span class="pre">particleset</span></code> (e.g.,
<code class="docutils literal notranslate"><span class="pre">Li.psf</span></code> and <code class="docutils literal notranslate"><span class="pre">H.psf</span></code>). If <code class="docutils literal notranslate"><span class="pre">format</span></code>==xml, additional
<code class="docutils literal notranslate"><span class="pre">pseudo</span></code> child XML elements must be provided (see the following).
These elements specify individual file names and formats (both the
FSAtom XML and CASINO tabular data formats are supported).</p></li>
<li><p><strong>algorithm</strong> The default algorithm evaluates the ratios of
wavefunction components together for each quadrature point and then
one point after another. The batched algorithm evaluates the ratios
of quadrature points together for each wavefunction component and
then one component after another. Internally, it uses
<code class="docutils literal notranslate"><span class="pre">VirtualParticleSet</span></code> for quadrature points. Hybrid orbital
representation has an extra optimization enabled when using the
batched algorithm.</p></li>
<li><p><strong>DLA</strong> Determinant localization approximation
(DLA) <a class="bibtex reference internal" href="#zen2019dla" id="id3">[ZBMAlfe19]</a> uses only the fermionic part of
the wavefunction when calculating NLPP.</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="listing-19">
<div class="code-block-caption"><span class="caption-number">Listing 19 </span><span class="caption-text">QMCPXML element for pseudopotential electron-ion interaction (psf files).</span><a class="headerlink" href="#listing-19" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">&lt;</span><span class="n">pairpot</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;PseudoPot&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;pseudo&quot;</span>  <span class="n">source</span><span class="o">=</span><span class="s2">&quot;i&quot;</span> <span class="n">wavefunction</span><span class="o">=</span><span class="s2">&quot;psi0&quot;</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;psf&quot;</span><span class="o">/&gt;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="listing-20">
<div class="code-block-caption"><span class="caption-number">Listing 20 </span><span class="caption-text">QMCPXML element for pseudopotential electron-ion interaction (xml files).</span><a class="headerlink" href="#listing-20" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">&lt;</span><span class="n">pairpot</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;PseudoPot&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;pseudo&quot;</span>  <span class="n">source</span><span class="o">=</span><span class="s2">&quot;i&quot;</span> <span class="n">wavefunction</span><span class="o">=</span><span class="s2">&quot;psi0&quot;</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;xml&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">pseudo</span> <span class="n">elementType</span><span class="o">=</span><span class="s2">&quot;Li&quot;</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;Li.xml&quot;</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="n">pseudo</span> <span class="n">elementType</span><span class="o">=</span><span class="s2">&quot;H&quot;</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;H.xml&quot;</span><span class="o">/&gt;</span>
  <span class="o">&lt;/</span><span class="n">pairpot</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<p>Details of <code class="docutils literal notranslate"><span class="pre">&lt;pseudo/&gt;</span></code> input elements are shown in the following. It
is possible to include (or construct) a full pseudopotential directly in
the input file without providing an external file via <code class="docutils literal notranslate"><span class="pre">href</span></code>. The full
XML format for pseudopotentials is not yet covered.</p>
<p><code class="docutils literal notranslate"><span class="pre">pseudo</span></code> element:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 38%" />
<col style="width: 62%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>parent elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pairpot</span> <span class="pre">type=pseudo</span></code></p></td>
</tr>
<tr class="row-even"><td><p>child elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">header</span> <span class="pre">local</span> <span class="pre">grid</span></code></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>attributes:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 13%" />
<col style="width: 16%" />
<col style="width: 12%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">elementType/symbol</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">groupe.name</span></code></p></td>
<td><p>none</p></td>
<td><p>Identify ionic species</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">href</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><em>filepath</em></p></td>
<td><p>none</p></td>
<td><p>Pseudopotential file path</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">format</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p>xml/casino</p></td>
<td><p>xml</p></td>
<td><p>Specify file format</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cutoff</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>real</p></td>
<td></td>
<td></td>
<td><p>Nonlocal cutoff radius</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">lmax</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>integer</p></td>
<td></td>
<td></td>
<td><p>Largest angular momentum</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">nrule</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>integer</p></td>
<td></td>
<td></td>
<td><p>Integration grid order</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="literal-block-wrapper docutils container" id="listing-21">
<div class="code-block-caption"><span class="caption-number">Listing 21 </span><span class="caption-text">QMCPXML element for pseudopotential of single ionic species.</span><a class="headerlink" href="#listing-21" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">&lt;</span><span class="n">pseudo</span> <span class="n">elementType</span><span class="o">=</span><span class="s2">&quot;Li&quot;</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;Li.xml&quot;</span><span class="o">/&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="mpc-interaction-correction">
<h3>MPC Interaction/correction<a class="headerlink" href="#mpc-interaction-correction" title="Permalink to this headline">¶</a></h3>
<p>The MPC interaction is an alternative to direct Ewald summation. The MPC
corrects the exchange correlation hole to more closely match its
thermodynamic limit. Because of this, the MPC exhibits smaller
finite-size errors than the bare Ewald interaction, though a few
alternative and competitive finite-size correction schemes now exist.
The MPC is itself often used just as a finite-size correction in
post-processing (set <code class="docutils literal notranslate"><span class="pre">physical=false</span></code> in the input).</p>
<p><code class="docutils literal notranslate"><span class="pre">pairpot</span> <span class="pre">type=mpc</span></code> element:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 51%" />
<col style="width: 49%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>parent elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian</span></code></p></td>
</tr>
<tr class="row-even"><td><p>child elements:</p></td>
<td><p><em>None</em></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>attributes:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 12%" />
<col style="width: 19%" />
<col style="width: 20%" />
<col style="width: 28%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">type</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><strong>mpc</strong></p></td>
<td></td>
<td><p>Must be MPC</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">name/id</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><em>anything</em></p></td>
<td><p>MPC</p></td>
<td><p>Unique name for interaction</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">source</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">particleset.name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian.target</span></code></p></td>
<td><p>Identify interacting particles</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">target</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">particleset.name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian.target</span></code></p></td>
<td><p>Identify interacting particles</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">physical</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>no</p></td>
<td><p>Hamiltonian(yes)/observable(no)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cutoff</span></code></p></td>
<td><p>real</p></td>
<td><p><span class="math notranslate nohighlight">\(&gt;0\)</span></p></td>
<td><p>30.0</p></td>
<td><p>Kinetic energy cutoff</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Remarks:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">physical</span></code>: Typically set to <code class="docutils literal notranslate"><span class="pre">no</span></code>, meaning the standard Ewald
interaction will be used during sampling and MPC will be measured as
an observable for finite-size post-correction. If <code class="docutils literal notranslate"><span class="pre">physical</span></code> is
<code class="docutils literal notranslate"><span class="pre">yes</span></code>, the MPC interaction will be used during sampling. In this
case an electron-electron Coulomb <code class="docutils literal notranslate"><span class="pre">pairpot</span></code> element should not be
supplied.</p></li>
<li><p><strong>Developer note:</strong> Currently the <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute for the MPC
interaction is ignored. The name is always reset to <code class="docutils literal notranslate"><span class="pre">MPC</span></code>.</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="listing-22">
<div class="code-block-caption"><span class="caption-number">Listing 22 </span><span class="caption-text">MPC for finite-size postcorrection.</span><a class="headerlink" href="#listing-22" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">&lt;</span><span class="n">pairpot</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;MPC&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;MPC&quot;</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;e&quot;</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;e&quot;</span> <span class="n">ecut</span><span class="o">=</span><span class="s2">&quot;60.0&quot;</span> <span class="n">physical</span><span class="o">=</span><span class="s2">&quot;no&quot;</span><span class="o">/&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="general-estimators">
<h2>General estimators<a class="headerlink" href="#general-estimators" title="Permalink to this headline">¶</a></h2>
<p>A broad range of estimators for physical observables are available in QMCPACK.
The following sections contain input details for the total number
density (<code class="docutils literal notranslate"><span class="pre">density</span></code>), number density resolved by particle spin
(<code class="docutils literal notranslate"><span class="pre">spindensity</span></code>), spherically averaged pair correlation function
(<code class="docutils literal notranslate"><span class="pre">gofr</span></code>), static structure factor (<code class="docutils literal notranslate"><span class="pre">sk</span></code>), static structure factor
(<code class="docutils literal notranslate"><span class="pre">skall</span></code>), energy density (<code class="docutils literal notranslate"><span class="pre">energydensity</span></code>), one body reduced
density matrix (<code class="docutils literal notranslate"><span class="pre">dm1b</span></code>), <span class="math notranslate nohighlight">\(S(k)\)</span> based kinetic energy correction
(<code class="docutils literal notranslate"><span class="pre">chiesa</span></code>), forward walking (<code class="docutils literal notranslate"><span class="pre">ForwardWalking</span></code>), and force
(<code class="docutils literal notranslate"><span class="pre">Force</span></code>) estimators. Other estimators are not yet covered.</p>
<p>When an <code class="docutils literal notranslate"><span class="pre">&lt;estimator/&gt;</span></code> element appears in <code class="docutils literal notranslate"><span class="pre">&lt;hamiltonian/&gt;</span></code>, it is
evaluated for all applicable chained QMC runs (e.g.,
VMC<span class="math notranslate nohighlight">\(\rightarrow\)</span>DMC<span class="math notranslate nohighlight">\(\rightarrow\)</span>DMC). Estimators are
generally not accumulated during wavefunction optimization sections. If
an <code class="docutils literal notranslate"><span class="pre">&lt;estimator/&gt;</span></code> element is instead provided in a particular
<code class="docutils literal notranslate"><span class="pre">&lt;qmc/&gt;</span></code> element, that estimator is only evaluated for that specific
section (e.g., during VMC only).</p>
<p><code class="docutils literal notranslate"><span class="pre">estimator</span></code> factory element:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 45%" />
<col style="width: 55%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>parent elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian,</span> <span class="pre">qmc</span></code></p></td>
</tr>
<tr class="row-even"><td><p>type selector:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">type</span></code> attribute</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 19%" />
<col style="width: 62%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>type options</strong></p></td>
<td><p>density</p></td>
<td><p>Density on a grid</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>spindensity</p></td>
<td><p>Spin density on a grid</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>gofr</p></td>
<td><p>Pair correlation function (quantum species)</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>sk</p></td>
<td><p>Static structure factor</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>SkAll</p></td>
<td><p>Static structure factor needed for finite size correction</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>structurefactor</p></td>
<td><p>Species resolved structure factor</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>species kinetic</p></td>
<td><p>Species resolved kinetic energy</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>latticedeviation</p></td>
<td><p>Spatial deviation between two particlesets</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>momentum</p></td>
<td><p>Momentum distribution</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>energydensity</p></td>
<td><p>Energy density on uniform or Voronoi grid</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>dm1b</p></td>
<td><p>One body density matrix in arbitrary basis</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>chiesa</p></td>
<td><p>Chiesa-Ceperley-Martin-Holzmann kinetic energy correction</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Force</p></td>
<td><p>Family of “force” estimators (see <a class="reference internal" href="#force-est"><span class="std std-ref">“Force” estimators</span></a>)</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>ForwardWalking</p></td>
<td><p>Forward walking values for existing estimators</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>orbitalimages</p></td>
<td><p>Create image files for orbitals, then exit</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>flux</p></td>
<td><p>Checks sampling of kinetic energy</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>localmoment</p></td>
<td><p>Atomic spin polarization within cutoff radius</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Pressure</p></td>
<td><p><em>No current function</em></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>shared attributes:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 15%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">type</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><em>See above</em></p></td>
<td><p>0</p></td>
<td><p>Select estimator type</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">name</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><em>anything</em></p></td>
<td><p>any</p></td>
<td><p>Unique name for this estimator</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="section" id="chiesa-ceperley-martin-holzmann-kinetic-energy-correction">
<h3>Chiesa-Ceperley-Martin-Holzmann kinetic energy correction<a class="headerlink" href="#chiesa-ceperley-martin-holzmann-kinetic-energy-correction" title="Permalink to this headline">¶</a></h3>
<p>This estimator calculates a finite-size correction to the kinetic energy following the formalism laid out in <a class="bibtex reference internal" href="#chiesa2006" id="id4">[CCMH06]</a>.  The total energy can be corrected for finite-size effects by using this estimator in conjunction with the MPC correction.</p>
<p><code class="docutils literal notranslate"><span class="pre">estimator</span> <span class="pre">type=chiesa</span></code> element:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 45%" />
<col style="width: 55%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>parent elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian,</span> <span class="pre">qmc</span></code></p></td>
</tr>
<tr class="row-even"><td><p>child elements:</p></td>
<td><p><em>None</em></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>attributes:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 14%" />
<col style="width: 24%" />
<col style="width: 13%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">type</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><strong>chiesa</strong></p></td>
<td></td>
<td><p>Must be chiesa</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">name</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>text</p></td>
<td><p><em>anything</em></p></td>
<td><p>KEcorr</p></td>
<td><p>Always reset to KEcorr</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">source</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>text</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">particleset.name</span></code></p></td>
<td><p>e</p></td>
<td><p>Identify quantum particles</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">psi</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>text</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">wavefunction.name</span></code></p></td>
<td><p>psi0</p></td>
<td><p>Identify wavefunction</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="literal-block-wrapper docutils container" id="listing-23">
<div class="code-block-caption"><span class="caption-number">Listing 23 </span><span class="caption-text">“Chiesa” kinetic energy finite-size postcorrection.</span><a class="headerlink" href="#listing-23" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="o">&lt;</span><span class="n">estimator</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;KEcorr&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;chiesa&quot;</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;e&quot;</span> <span class="n">psi</span><span class="o">=</span><span class="s2">&quot;psi0&quot;</span><span class="o">/&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="density-estimator">
<h3>Density estimator<a class="headerlink" href="#density-estimator" title="Permalink to this headline">¶</a></h3>
<p>The particle number density operator is given by</p>
<div class="math notranslate nohighlight" id="equation-eq32">
<span class="eqno">(32)<a class="headerlink" href="#equation-eq32" title="Permalink to this equation">¶</a></span>\[\hat{n}_r = \sum_i\delta(r-r_i)\:.\]</div>
<p>The <code class="docutils literal notranslate"><span class="pre">density</span></code> estimator accumulates the number density on a uniform
histogram grid over the simulation cell. The value obtained for a grid
cell <span class="math notranslate nohighlight">\(c\)</span> with volume <span class="math notranslate nohighlight">\(\Omega_c\)</span> is then the average number
of particles in that cell:</p>
<div class="math notranslate nohighlight" id="equation-eq33">
<span class="eqno">(33)<a class="headerlink" href="#equation-eq33" title="Permalink to this equation">¶</a></span>\[n_c = \int dR \left|{\Psi}\right|^2 \int_{\Omega_c}dr \sum_i\delta(r-r_i)\:.\]</div>
<p><code class="docutils literal notranslate"><span class="pre">estimator</span> <span class="pre">type=density</span></code> element:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 45%" />
<col style="width: 55%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>parent elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian,</span> <span class="pre">qmc</span></code></p></td>
</tr>
<tr class="row-even"><td><p>child elements:</p></td>
<td><p><em>None</em></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>attributes:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 9%" />
<col style="width: 26%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">type</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><strong>density</strong></p></td>
<td></td>
<td><p>Must be density</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">name</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><em>anything</em></p></td>
<td><p>any</p></td>
<td><p>Unique name for estimator</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">delta</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>real array(3)</p></td>
<td><p><span class="math notranslate nohighlight">\(0\le v_i \le 1\)</span></p></td>
<td><p>0.1 0.1 0.1</p></td>
<td><p>Grid cell spacing, unit coords</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">x_min</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>real</p></td>
<td><p><span class="math notranslate nohighlight">\(&gt;0\)</span></p></td>
<td><p>0</p></td>
<td><p>Grid starting point in x (Bohr)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">x_max</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>real</p></td>
<td><p><span class="math notranslate nohighlight">\(&gt;0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(|\)</span> <code class="docutils literal notranslate"><span class="pre">lattice[0]</span></code> <span class="math notranslate nohighlight">\(|\)</span></p></td>
<td><p>Grid ending point in x (Bohr)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">y_min</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>real</p></td>
<td><p><span class="math notranslate nohighlight">\(&gt;0\)</span></p></td>
<td><p>0</p></td>
<td><p>Grid starting point in y (Bohr)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">y_max</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>real</p></td>
<td><p><span class="math notranslate nohighlight">\(&gt;0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(|\)</span> <code class="docutils literal notranslate"><span class="pre">lattice[1]</span></code> <span class="math notranslate nohighlight">\(|\)</span></p></td>
<td><p>Grid ending point in y (Bohr)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">z_min</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>real</p></td>
<td><p><span class="math notranslate nohighlight">\(&gt;0\)</span></p></td>
<td><p>0</p></td>
<td><p>Grid starting point in z (Bohr)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">z_max</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>real</p></td>
<td><p><span class="math notranslate nohighlight">\(&gt;0\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(|\)</span> <code class="docutils literal notranslate"><span class="pre">lattice[2]</span></code> <span class="math notranslate nohighlight">\(|\)</span></p></td>
<td><p>Grid ending point in z (Bohr)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">potential</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>no</p></td>
<td><p>Accumulate local potential, <em>deprecated</em></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">debug</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>no</p></td>
<td><p><em>No current function</em></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Additional information:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: The name provided will be used as a label in the
<code class="docutils literal notranslate"><span class="pre">stat.h5</span></code> file for the blocked output data. Postprocessing tools
expect <code class="docutils literal notranslate"><span class="pre">name=&quot;Density.&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delta</span></code>: This sets the histogram grid size used to accumulate the
density:
<code class="docutils literal notranslate"><span class="pre">delta=&quot;0.1</span> <span class="pre">0.1</span> <span class="pre">0.05&quot;</span></code><span class="math notranslate nohighlight">\(\rightarrow 10\times 10\times 20\)</span>
grid,
<code class="docutils literal notranslate"><span class="pre">delta=&quot;0.01</span> <span class="pre">0.01</span> <span class="pre">0.01&quot;</span></code><span class="math notranslate nohighlight">\(\rightarrow 100\times 100\times 100\)</span>
grid. The density grid is written to a <code class="docutils literal notranslate"><span class="pre">stat.h5</span></code> file at the end of
each MC block. If you request many <span class="math notranslate nohighlight">\(blocks\)</span> in a <code class="docutils literal notranslate"><span class="pre">&lt;qmc/&gt;</span></code>
element, or select a large grid, the resulting <code class="docutils literal notranslate"><span class="pre">stat.h5</span></code> file could
be many gigabytes in size.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">*_min/*_max</span></code>: Can be used to select a subset of the simulation
cell for the density histogram grid. For example if a (cubic)
simulation cell is 20 Bohr on a side, setting <code class="docutils literal notranslate"><span class="pre">*_min=5.0</span></code> and
<code class="docutils literal notranslate"><span class="pre">*_max=15.0</span></code> will result in a density histogram grid spanning a
<span class="math notranslate nohighlight">\(10\times 10\times 10\)</span> Bohr cube about the center of the box.
Use of <code class="docutils literal notranslate"><span class="pre">x_min,</span> <span class="pre">x_max,</span> <span class="pre">y_min,</span> <span class="pre">y_max,</span> <span class="pre">z_min,</span> <span class="pre">z_max</span></code> is only
appropriate for orthorhombic simulation cells with open boundary
conditions.</p></li>
<li><p>When open boundary conditions are used, a <code class="docutils literal notranslate"><span class="pre">&lt;simulationcell/&gt;</span></code>
element must be explicitly provided as the first subelement of
<code class="docutils literal notranslate"><span class="pre">&lt;qmcsystem/&gt;</span></code> for the density estimator to work. In this case the
molecule should be centered around the middle of the simulation cell
(<span class="math notranslate nohighlight">\(L/2\)</span>) and not the origin (<span class="math notranslate nohighlight">\(0\)</span> since the space within
the cell, and hence the density grid, is defined from <span class="math notranslate nohighlight">\(0\)</span> to
<span class="math notranslate nohighlight">\(L\)</span>).</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="listing-24">
<div class="code-block-caption"><span class="caption-number">Listing 24 </span><span class="caption-text">QMCPXML,caption=Density estimator (uniform grid).</span><a class="headerlink" href="#listing-24" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="o">&lt;</span><span class="n">estimator</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Density&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;density&quot;</span> <span class="n">delta</span><span class="o">=</span><span class="s2">&quot;0.05 0.05 0.05&quot;</span><span class="o">/&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="spin-density-estimator">
<h3>Spin density estimator<a class="headerlink" href="#spin-density-estimator" title="Permalink to this headline">¶</a></h3>
<p>The spin density is similar to the total density described previously.  In this case, the sum over particles is performed independently for each spin component.</p>
<p><code class="docutils literal notranslate"><span class="pre">estimator</span> <span class="pre">type=spindensity</span></code> element:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 45%" />
<col style="width: 55%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>parent elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian,</span> <span class="pre">qmc</span></code></p></td>
</tr>
<tr class="row-even"><td><p>child elements:</p></td>
<td><p><em>None</em></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>attributes:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 14%" />
<col style="width: 17%" />
<col style="width: 13%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">type</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><strong>spindensity</strong></p></td>
<td></td>
<td><p>Must be spindensity</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">name</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><em>anything</em></p></td>
<td><p>any</p></td>
<td><p>Unique name for estimator</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">report</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>no</p></td>
<td><p>Write setup details to stdout</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>parameters:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 16%" />
<col style="width: 19%" />
<col style="width: 11%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">grid</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>integer array(3)</p></td>
<td><p><span class="math notranslate nohighlight">\(v_i&gt;\)</span></p></td>
<td></td>
<td><p>Grid cell count</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dr</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>real array(3)</p></td>
<td><p><span class="math notranslate nohighlight">\(v_i&gt;\)</span></p></td>
<td></td>
<td><p>Grid cell spacing (Bohr)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cell</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>real array(3,3)</p></td>
<td><p><em>anything</em></p></td>
<td></td>
<td><p>Volume grid exists in</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">corner</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>real array(3)</p></td>
<td><p><em>anything</em></p></td>
<td></td>
<td><p>Volume corner location</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">center</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>real array (3)</p></td>
<td><p><em>anything</em></p></td>
<td></td>
<td><p>Volume center/origin location</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">voronoi</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>text</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">particleset.name</span></code></p></td>
<td></td>
<td><p><em>Under development</em></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">test_moves</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>integer</p></td>
<td><p><span class="math notranslate nohighlight">\(&gt;=0\)</span></p></td>
<td><p>0</p></td>
<td><p>Test estimator with random moves</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Additional information:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: The name provided will be used as a label in the
<code class="docutils literal notranslate"><span class="pre">stat.h5</span></code> file for the blocked output data. Postprocessing tools
expect <code class="docutils literal notranslate"><span class="pre">name=&quot;SpinDensity.&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grid</span></code>: The grid sets the dimension of the histogram grid. Input
like <code class="docutils literal notranslate"><span class="pre">&lt;parameter</span> <span class="pre">name=&quot;grid&quot;&gt;</span> <span class="pre">40</span> <span class="pre">40</span> <span class="pre">40</span> <span class="pre">&lt;/parameter&gt;</span></code> requests a
<span class="math notranslate nohighlight">\(40 \times 40\times 40\)</span> grid. The shape of individual grid
cells is commensurate with the supercell shape.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dr</span></code>: The <code class="docutils literal notranslate"><span class="pre">dr</span></code> sets the real-space dimensions of grid cell edges
(Bohr units). Input like
<code class="docutils literal notranslate"><span class="pre">&lt;parameter</span> <span class="pre">name=&quot;dr&quot;&gt;</span> <span class="pre">0.5</span> <span class="pre">0.5</span> <span class="pre">0.5</span> <span class="pre">&lt;/parameter&gt;</span></code> in a supercell
with axes of length 10 Bohr each (but of arbitrary shape) will
produce a <span class="math notranslate nohighlight">\(20\times 20\times 20\)</span> grid. The inputted <code class="docutils literal notranslate"><span class="pre">dr</span></code>
values are rounded to produce an integer number of grid cells along
each supercell axis. Either <code class="docutils literal notranslate"><span class="pre">grid</span></code> or <code class="docutils literal notranslate"><span class="pre">dr</span></code> must be provided, but
not both.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cell</span></code>: When <code class="docutils literal notranslate"><span class="pre">cell</span></code> is provided, a user-defined grid volume is
used instead of the global supercell. This must be provided if open
boundary conditions are used. Additionally, if <code class="docutils literal notranslate"><span class="pre">cell</span></code> is provided,
the user must specify where the volume is located in space in
addition to its size/shape (<code class="docutils literal notranslate"><span class="pre">cell</span></code>) using either the <code class="docutils literal notranslate"><span class="pre">corner</span></code> or
<code class="docutils literal notranslate"><span class="pre">center</span></code> parameters.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">corner</span></code>: The grid volume is defined as
<span class="math notranslate nohighlight">\(corner+\sum_{d=1}^3u_dcell_d\)</span> with <span class="math notranslate nohighlight">\(0&lt;u_d&lt;1\)</span> (“cell”
refers to either the supercell or user-provided cell).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">center</span></code>: The grid volume is defined as
<span class="math notranslate nohighlight">\(center+\sum_{d=1}^3u_dcell_d\)</span> with <span class="math notranslate nohighlight">\(-1/2&lt;u_d&lt;1/2\)</span>
(“cell” refers to either the supercell or user-provided cell).
<code class="docutils literal notranslate"><span class="pre">corner/center</span></code> can be used to shift the grid even if <code class="docutils literal notranslate"><span class="pre">cell</span></code> is
not specified. Simultaneous use of <code class="docutils literal notranslate"><span class="pre">corner</span></code> and <code class="docutils literal notranslate"><span class="pre">center</span></code> will
cause QMCPACK to abort.</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="listing-25">
<div class="code-block-caption"><span class="caption-number">Listing 25 </span><span class="caption-text">Spin density estimator (uniform grid).</span><a class="headerlink" href="#listing-25" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">estimator</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;spindensity&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;SpinDensity&quot;</span> <span class="n">report</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;grid&quot;</span><span class="o">&gt;</span> <span class="mi">40</span> <span class="mi">40</span> <span class="mi">40</span> <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">estimator</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="listing-26">
<div class="code-block-caption"><span class="caption-number">Listing 26 </span><span class="caption-text">Spin density estimator (uniform grid centered about origin).</span><a class="headerlink" href="#listing-26" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">estimator</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;spindensity&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;SpinDensity&quot;</span> <span class="n">report</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;grid&quot;</span><span class="o">&gt;</span>
    <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span>
  <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="o">&gt;</span>
    <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span>
  <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;cell&quot;</span><span class="o">&gt;</span>
    <span class="mf">10.0</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>
     <span class="mf">0.0</span> <span class="mf">10.0</span>  <span class="mf">0.0</span>
     <span class="mf">0.0</span>  <span class="mf">0.0</span> <span class="mf">10.0</span>
  <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">estimator</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="pair-correlation-function-g-r">
<h3>Pair correlation function, <span class="math notranslate nohighlight">\(g(r)\)</span><a class="headerlink" href="#pair-correlation-function-g-r" title="Permalink to this headline">¶</a></h3>
<p>The functional form of the species-resolved radial pair correlation function operator is</p>
<div class="math notranslate nohighlight" id="equation-eq34">
<span class="eqno">(34)<a class="headerlink" href="#equation-eq34" title="Permalink to this equation">¶</a></span>\[g_{ss'}(r) = \frac{V}{4\pi r^2N_sN_{s'}}\sum_{i_s=1}^{N_s}\sum_{j_{s'}=1}^{N_{s'}}\delta(r-|r_{i_s}-r_{j_{s'}}|)\:,\]</div>
<p>where <span class="math notranslate nohighlight">\(N_s\)</span> is the number of particles of species <span class="math notranslate nohighlight">\(s\)</span> and
<span class="math notranslate nohighlight">\(V\)</span> is the supercell volume. If <span class="math notranslate nohighlight">\(s=s'\)</span>, then the sum is
restricted so that <span class="math notranslate nohighlight">\(i_s\ne j_s\)</span>.</p>
<p>In QMCPACK, an estimate of <span class="math notranslate nohighlight">\(g_{ss'}(r)\)</span> is obtained as a radial
histogram with a set of <span class="math notranslate nohighlight">\(N_b\)</span> uniform bins of width
<span class="math notranslate nohighlight">\(\delta r\)</span>. This can be expressed analytically as</p>
<div class="math notranslate nohighlight" id="equation-eq35">
<span class="eqno">(35)<a class="headerlink" href="#equation-eq35" title="Permalink to this equation">¶</a></span>\[\tilde{g}_{ss'}(r) = \frac{V}{4\pi r^2N_sN_{s'}}\sum_{i=1}^{N_s}\sum_{j=1}^{N_{s'}}\frac{1}{\delta r}\int_{r-\delta r/2}^{r+\delta r/2}dr'\delta(r'-|r_{si}-r_{s'j}|)\:,\]</div>
<p>where the radial coordinate <span class="math notranslate nohighlight">\(r\)</span> is restricted to reside at the bin
centers, <span class="math notranslate nohighlight">\(\delta r/2, 3 \delta r/2, 5 \delta r/2, \ldots\)</span>.</p>
<p><code class="docutils literal notranslate"><span class="pre">estimator</span> <span class="pre">type=gofr</span></code> element:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 45%" />
<col style="width: 55%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>parent elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian,</span> <span class="pre">qmc</span></code></p></td>
</tr>
<tr class="row-even"><td><p>child elements:</p></td>
<td><p><em>None</em></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>attributes:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 12%" />
<col style="width: 19%" />
<col style="width: 21%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">type</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><strong>gofr</strong></p></td>
<td></td>
<td><p>Must be gofr</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">name</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>text</p></td>
<td><p><em>anything</em></p></td>
<td><p>any</p></td>
<td><p><em>No current function</em></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">num_bin</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>integer</p></td>
<td><p><span class="math notranslate nohighlight">\(&gt;1\)</span></p></td>
<td><p>20</p></td>
<td><p># of histogram bins</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">rmax</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>real</p></td>
<td><p><span class="math notranslate nohighlight">\(&gt;0\)</span></p></td>
<td><p>10</p></td>
<td><p>Histogram extent (Bohr)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dr</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>real</p></td>
<td><p><span class="math notranslate nohighlight">\(0\)</span></p></td>
<td><p>0.5</p></td>
<td><p><em>No current function</em></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">debug</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>no</p></td>
<td><p><em>No current function</em></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">target</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>text</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">particleset.name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian.target</span></code></p></td>
<td><p>Quantum particles</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">source/sources</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>text array</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">particleset.name</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian.target</span></code></p></td>
<td><p>Classical particles</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Additional information:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">num_bin:</span></code> This is the number of bins in each species pair radial
histogram.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rmax:</span></code> This is the maximum pair distance included in the
histogram. The uniform bin width is
<span class="math notranslate nohighlight">\(\delta r=\texttt{rmax/num\_bin}\)</span>. If periodic boundary
conditions are used for any dimension of the simulation cell, then
the default value of <code class="docutils literal notranslate"><span class="pre">rmax</span></code> is the simulation cell radius instead
of 10 Bohr. For open boundary conditions, the volume (<span class="math notranslate nohighlight">\(V\)</span>) used
is 1.0 Bohr<span class="math notranslate nohighlight">\(^3\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">source/sources:</span></code> If unspecified, only pair correlations between
each species of quantum particle will be measured. For each classical
particleset specified by <code class="docutils literal notranslate"><span class="pre">source/sources</span></code>, additional pair
correlations between each quantum and classical species will be
measured. Typically there is only one classical particleset (e.g.,
<code class="docutils literal notranslate"><span class="pre">source=&quot;ion0&quot;</span></code>), but there can be several in principle (e.g.,
<code class="docutils literal notranslate"><span class="pre">sources=&quot;ion0</span> <span class="pre">ion1</span> <span class="pre">ion2&quot;</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target:</span></code> The default value is the preferred usage (i.e.,
<code class="docutils literal notranslate"><span class="pre">target</span></code> does not need to be provided).</p></li>
<li><p>Data is output to the <code class="docutils literal notranslate"><span class="pre">stat.h5</span></code> for each QMC subrun. Individual
histograms are named according to the quantum particleset and index
of the pair. For example, if the quantum particleset is named “e” and
there are two species (up and down electrons, say), then there will
be three sets of histogram data in each <code class="docutils literal notranslate"><span class="pre">stat.h5</span></code> file named
<code class="docutils literal notranslate"><span class="pre">gofr_e_0_0</span></code>, <code class="docutils literal notranslate"><span class="pre">gofr_e_0_1</span></code>, and <code class="docutils literal notranslate"><span class="pre">gofr_e_1_1</span></code> for up-up,
up-down, and down-down correlations, respectively.</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="listing-27">
<div class="code-block-caption"><span class="caption-number">Listing 27 </span><span class="caption-text">Pair correlation function estimator element.</span><a class="headerlink" href="#listing-27" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">estimator</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;gofr&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;gofr&quot;</span> <span class="n">num_bin</span><span class="o">=</span><span class="s2">&quot;200&quot;</span> <span class="n">rmax</span><span class="o">=</span><span class="s2">&quot;3.0&quot;</span> <span class="o">/&gt;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="listing-28">
<div class="code-block-caption"><span class="caption-number">Listing 28 </span><span class="caption-text">Pair correlation function estimator element with additional electron-ion correlations.</span><a class="headerlink" href="#listing-28" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">estimator</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;gofr&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;gofr&quot;</span> <span class="n">num_bin</span><span class="o">=</span><span class="s2">&quot;200&quot;</span> <span class="n">rmax</span><span class="o">=</span><span class="s2">&quot;3.0&quot;</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;ion0&quot;</span> <span class="o">/&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="static-structure-factor-s-k">
<h3>Static structure factor, <span class="math notranslate nohighlight">\(S(k)\)</span><a class="headerlink" href="#static-structure-factor-s-k" title="Permalink to this headline">¶</a></h3>
<p>Let
<span class="math notranslate nohighlight">\(\rho^e_{\mathbf{k}}=\sum_j e^{i \mathbf{k}\cdot\mathbf{r}_j^e}\)</span>
be the Fourier space electron density, with <span class="math notranslate nohighlight">\(\mathbf{r}^e_j\)</span> being
the coordinate of the j-th electron. <span class="math notranslate nohighlight">\(\mathbf{k}\)</span> is a wavevector
commensurate with the simulation cell. QMCPACK allows the user to
accumulate the static electron structure factor <span class="math notranslate nohighlight">\(S(\mathbf{k})\)</span> at
all commensurate <span class="math notranslate nohighlight">\(\mathbf{k}\)</span> such that
<span class="math notranslate nohighlight">\(|\mathbf{k}| \leq (LR\_DIM\_CUTOFF) r_c\)</span>. <span class="math notranslate nohighlight">\(N^e\)</span> is the
number of electrons, <code class="docutils literal notranslate"><span class="pre">LR_DIM_CUTOFF</span></code> is the optimized breakup
parameter, and <span class="math notranslate nohighlight">\(r_c\)</span> is the Wigner-Seitz radius. It is defined as
follows:</p>
<div class="math notranslate nohighlight" id="equation-eq36">
<span class="eqno">(36)<a class="headerlink" href="#equation-eq36" title="Permalink to this equation">¶</a></span>\[S(\mathbf{k}) = \frac{1}{N^e}\langle \rho^e_{-\mathbf{k}} \rho^e_{\mathbf{k}} \rangle\:.\]</div>
<p><code class="docutils literal notranslate"><span class="pre">estimator</span> <span class="pre">type=sk</span></code> element:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 45%" />
<col style="width: 55%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>parent elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian,</span> <span class="pre">qmc</span></code></p></td>
</tr>
<tr class="row-even"><td><p>child elements:</p></td>
<td><p><em>None</em></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>attributes:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 12%" />
<col style="width: 11%" />
<col style="width: 12%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">type</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p>sk</p></td>
<td></td>
<td><p>Must sk</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">name</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><em>anything</em></p></td>
<td><p>any</p></td>
<td><p>Unique name for estimator</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hdf5</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>no</p></td>
<td><p>Output to <code class="docutils literal notranslate"><span class="pre">stat.h5</span></code> (yes) or <code class="docutils literal notranslate"><span class="pre">scalar.dat</span></code> (no)</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Additional information:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name:</span></code> This is the unique name for estimator instance. A data
structure of the same name will appear in <code class="docutils literal notranslate"><span class="pre">stat.h5</span></code> output files.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hdf5:</span></code> If <code class="docutils literal notranslate"><span class="pre">hdf5==yes</span></code>, output data for <span class="math notranslate nohighlight">\(S(k)\)</span> is directed
to the <code class="docutils literal notranslate"><span class="pre">stat.h5</span></code> file (recommended usage). If <code class="docutils literal notranslate"><span class="pre">hdf5==no</span></code>, the
data is instead routed to the <code class="docutils literal notranslate"><span class="pre">scalar.dat</span></code> file, resulting in many
columns of data with headings prefixed by <code class="docutils literal notranslate"><span class="pre">name</span></code> and postfixed by
the k-point index (e.g., <code class="docutils literal notranslate"><span class="pre">sk_0</span> <span class="pre">sk_1</span> <span class="pre">…sk_1037</span> <span class="pre">…</span></code>).</p></li>
<li><p>This estimator only works in periodic boundary conditions. Its
presence in the input file is ignored otherwise.</p></li>
<li><p>This is not a species-resolved structure factor. Additionally, for
<span class="math notranslate nohighlight">\(\mathbf{k}\)</span> vectors commensurate with the unit cell,
<span class="math notranslate nohighlight">\(S(\mathbf{k})\)</span> will include contributions from the static
electronic density, thus meaning it will not accurately measure the
electron-electron density response.</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="listing-29">
<div class="code-block-caption"><span class="caption-number">Listing 29 </span><span class="caption-text">Static structure factor estimator element.</span><a class="headerlink" href="#listing-29" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">&lt;</span><span class="n">estimator</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;sk&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sk&quot;</span> <span class="n">hdf5</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="o">/&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="static-structure-factor-skall">
<h3>Static structure factor, <code class="docutils literal notranslate"><span class="pre">SkAll</span></code><a class="headerlink" href="#static-structure-factor-skall" title="Permalink to this headline">¶</a></h3>
<p>In order to compute the finite size correction to the potential energy,
records of <span class="math notranslate nohighlight">\(\rho(\mathbf{k})\)</span> is required. What sets <code class="docutils literal notranslate"><span class="pre">SkAll</span></code>
apart from <code class="docutils literal notranslate"><span class="pre">sk</span></code> is that <code class="docutils literal notranslate"><span class="pre">SkAll</span></code> records <span class="math notranslate nohighlight">\(\rho(\mathbf{k})\)</span> in
addition to <span class="math notranslate nohighlight">\(s(\mathbf{k})\)</span>.</p>
<p><code class="docutils literal notranslate"><span class="pre">estimator</span> <span class="pre">type=SkAll</span></code> element:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 45%" />
<col style="width: 55%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>parent elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian,</span> <span class="pre">qmc</span></code></p></td>
</tr>
<tr class="row-even"><td><p>child elements:</p></td>
<td><p><em>None</em></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>attributes:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 8%" />
<col style="width: 15%" />
<col style="width: 7%" />
<col style="width: 54%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">type</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p>sk</p></td>
<td></td>
<td><p>Must be sk</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">name</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><em>anything</em></p></td>
<td><p>any</p></td>
<td><p>Unique name for estimator</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">source</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p>Ion ParticleSet name</p></td>
<td><p>None</p></td>
<td><p><cite>-</cite></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">target</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p>Electron ParticleSet name</p></td>
<td><p>None</p></td>
<td><p><cite>-</cite></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hdf5</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>no</p></td>
<td><p>Output to <code class="docutils literal notranslate"><span class="pre">stat.h5</span></code> (yes) or <code class="docutils literal notranslate"><span class="pre">scalar.dat</span></code> (no)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">writeionion</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>no</p></td>
<td><p>Writes file rhok_IonIon.dat containing <span class="math notranslate nohighlight">\(s(\mathbf{k})\)</span> for the ions</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Additional information:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name:</span></code> This is the unique name for estimator instance. A data
structure of the same name will appear in <code class="docutils literal notranslate"><span class="pre">stat.h5</span></code> output files.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hdf5:</span></code> If <code class="docutils literal notranslate"><span class="pre">hdf5==yes</span></code>, output data is directed to the
<code class="docutils literal notranslate"><span class="pre">stat.h5</span></code> file (recommended usage). If <code class="docutils literal notranslate"><span class="pre">hdf5==no</span></code>, the data is
instead routed to the <code class="docutils literal notranslate"><span class="pre">scalar.dat</span></code> file, resulting in many columns
of data with headings prefixed by <code class="docutils literal notranslate"><span class="pre">rhok</span></code> and postfixed by the
k-point index.</p></li>
<li><p>This estimator only works in periodic boundary conditions. Its
presence in the input file is ignored otherwise.</p></li>
<li><p>This is not a species-resolved structure factor. Additionally, for
<span class="math notranslate nohighlight">\(\mathbf{k}\)</span> vectors commensurate with the unit cell,
<span class="math notranslate nohighlight">\(S(\mathbf{k})\)</span> will include contributions from the static
electronic density, thus meaning it wil not accurately measure the
electron-electron density response.</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="listing-30">
<div class="code-block-caption"><span class="caption-number">Listing 30 </span><span class="caption-text">SkAll estimator element.</span><a class="headerlink" href="#listing-30" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">&lt;</span><span class="n">estimator</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;skall&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;SkAll&quot;</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;ion0&quot;</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;e&quot;</span> <span class="n">hdf5</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="o">/&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="species-kinetic-energy">
<h3>Species kinetic energy<a class="headerlink" href="#species-kinetic-energy" title="Permalink to this headline">¶</a></h3>
<p>Record species-resolved kinetic energy instead of the total kinetic
energy in the <code class="docutils literal notranslate"><span class="pre">Kinetic</span></code> column of scalar.dat. <code class="docutils literal notranslate"><span class="pre">SpeciesKineticEnergy</span></code>
is arguably the simplest estimator in QMCPACK. The implementation of
this estimator is detailed in
<code class="docutils literal notranslate"><span class="pre">manual/estimator/estimator_implementation.pdf</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">estimator</span> <span class="pre">type=specieskinetic</span></code> element:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 45%" />
<col style="width: 55%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>parent elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian,</span> <span class="pre">qmc</span></code></p></td>
</tr>
<tr class="row-even"><td><p>child elements:</p></td>
<td><p><em>None</em></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>attributes:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 15%" />
<col style="width: 17%" />
<col style="width: 14%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">type</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p>specieskinetic</p></td>
<td></td>
<td><p>Must be specieskinetic</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">name</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><em>anything</em></p></td>
<td><p>any</p></td>
<td><p>Unique name for estimator</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hdf5</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>no</p></td>
<td><p>Output to <code class="docutils literal notranslate"><span class="pre">stat.h5</span></code> (yes)</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="literal-block-wrapper docutils container" id="listing-31">
<div class="code-block-caption"><span class="caption-number">Listing 31 </span><span class="caption-text">Species kinetic energy estimator element.</span><a class="headerlink" href="#listing-31" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">&lt;</span><span class="n">estimator</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;specieskinetic&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;skinetic&quot;</span> <span class="n">hdf5</span><span class="o">=</span><span class="s2">&quot;no&quot;</span><span class="o">/&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="lattice-deviation-estimator">
<h3>Lattice deviation estimator<a class="headerlink" href="#lattice-deviation-estimator" title="Permalink to this headline">¶</a></h3>
<p>Record deviation of a group of particles in one particle set (target) from a group of particles in another particle set (source).</p>
<p><code class="docutils literal notranslate"><span class="pre">estimator</span> <span class="pre">type=latticedeviation</span></code> element:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 45%" />
<col style="width: 55%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>parent elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian,</span> <span class="pre">qmc</span></code></p></td>
</tr>
<tr class="row-even"><td><p>child elements:</p></td>
<td><p><em>None</em></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>attributes:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 14%" />
<col style="width: 18%" />
<col style="width: 13%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">type</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p>latticedeviation</p></td>
<td></td>
<td><p>Must be latticedeviation</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">name</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><em>anything</em></p></td>
<td><p>any</p></td>
<td><p>Unique name for estimator</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hdf5</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>no</p></td>
<td><p>Output to <code class="docutils literal notranslate"><span class="pre">stat.h5</span></code> (yes)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">per_xyz</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>no</p></td>
<td><p>Directionally resolved (yes)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">source</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p>e/ion0/…</p></td>
<td><p>no</p></td>
<td><p>source particleset</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sgroup</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p>u/d/…</p></td>
<td><p>no</p></td>
<td><p>source particle group</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">target</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p>e/ion0/…</p></td>
<td><p>no</p></td>
<td><p>target particleset</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">tgroup</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p>u/d/…</p></td>
<td><p>no</p></td>
<td><p>target particle group</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Additional information:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">source</span></code>: The “reference” particleset to measure distances from;
actual reference points are determined together with <code class="docutils literal notranslate"><span class="pre">sgroup</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sgroup</span></code>: The “reference” particle group to measure distances from.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">source</span></code>: The “target” particleset to measure distances to.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sgroup</span></code>: The “target” particle group to measure distances to. For
example, in <a class="reference internal" href="#listing-32"><span class="std std-ref">Listing 32</span></a> the distance from the up
electron (“u”) to the origin of the coordinate system is recorded.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">per_xyz</span></code>: Used to record direction-resolved distance. In
<a class="reference internal" href="#listing-32"><span class="std std-ref">Listing 32</span></a>, the x,y,z coordinates of the up electron
will be recorded separately if <code class="docutils literal notranslate"><span class="pre">per_xyz=yes</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hdf5</span></code>: Used to record particle-resolved distances in the h5 file
if <code class="docutils literal notranslate"><span class="pre">gdf5=yes</span></code>.</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="listing-32">
<div class="code-block-caption"><span class="caption-number">Listing 32 </span><span class="caption-text">Lattice deviation estimator element.</span><a class="headerlink" href="#listing-32" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">particleset</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;e&quot;</span> <span class="n">random</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">group</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;u&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="n">mass</span><span class="o">=</span><span class="s2">&quot;1.0&quot;</span><span class="o">&gt;</span>
     <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;charge&quot;</span>              <span class="o">&gt;</span>    <span class="o">-</span><span class="mi">1</span>                    <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
     <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;mass&quot;</span>                <span class="o">&gt;</span>    <span class="mf">1.0</span>                   <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">group</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">group</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;d&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="n">mass</span><span class="o">=</span><span class="s2">&quot;1.0&quot;</span><span class="o">&gt;</span>
     <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;charge&quot;</span>              <span class="o">&gt;</span>    <span class="o">-</span><span class="mi">1</span>                    <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
     <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;mass&quot;</span>                <span class="o">&gt;</span>    <span class="mf">1.0</span>                   <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">group</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">particleset</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">particleset</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;wf_center&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">group</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;origin&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">attrib</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;position&quot;</span> <span class="n">datatype</span><span class="o">=</span><span class="s2">&quot;posArray&quot;</span> <span class="n">condition</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="o">&gt;</span>
             <span class="mf">0.00000000</span>        <span class="mf">0.00000000</span>        <span class="mf">0.00000000</span>
    <span class="o">&lt;/</span><span class="n">attrib</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">group</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">particleset</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">estimator</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;latticedeviation&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;latdev&quot;</span> <span class="n">hdf5</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span> <span class="n">per_xyz</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span>
  <span class="n">source</span><span class="o">=</span><span class="s2">&quot;wf_center&quot;</span> <span class="n">sgroup</span><span class="o">=</span><span class="s2">&quot;origin&quot;</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;e&quot;</span> <span class="n">tgroup</span><span class="o">=</span><span class="s2">&quot;u&quot;</span><span class="o">/&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="energy-density-estimator">
<h3>Energy density estimator<a class="headerlink" href="#energy-density-estimator" title="Permalink to this headline">¶</a></h3>
<p>An energy density operator, <span class="math notranslate nohighlight">\(\hat{\mathcal{E}}_r\)</span>, satisfies</p>
<div class="math notranslate nohighlight" id="equation-eq37">
<span class="eqno">(37)<a class="headerlink" href="#equation-eq37" title="Permalink to this equation">¶</a></span>\[\int dr \hat{\mathcal{E}}_r = \hat{H},\]</div>
<p>where the integral is over all space and <span class="math notranslate nohighlight">\(\hat{H}\)</span> is the
Hamiltonian. In QMCPACK, the energy density is split into kinetic and potential
components</p>
<div class="math notranslate nohighlight" id="equation-eq38">
<span class="eqno">(38)<a class="headerlink" href="#equation-eq38" title="Permalink to this equation">¶</a></span>\[\hat{\mathcal{E}}_r = \hat{\mathcal{T}}_r + \hat{\mathcal{V}}_r\:,\]</div>
<p>with each component given by</p>
<div class="math notranslate nohighlight" id="equation-eq39">
<span class="eqno">(39)<a class="headerlink" href="#equation-eq39" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
    \hat{\mathcal{T}}_r &amp;=  \frac{1}{2}\sum_i\delta(r-r_i)\hat{p}_i^2 \\
    \hat{\mathcal{V}}_r &amp;=  \sum_{i&lt;j}\frac{\delta(r-r_i)+\delta(r-r_j)}{2}\hat{v}^{ee}(r_i,r_j)
               + \sum_{i\ell}\frac{\delta(r-r_i)+\delta(r-\tilde{r}_\ell)}{2}\hat{v}^{eI}(r_i,\tilde{r}_\ell) \nonumber\\
     &amp;\qquad   + \sum_{\ell&lt; m}\frac{\delta(r-\tilde{r}_\ell)+\delta(r-\tilde{r}_m)}{2}\hat{v}^{II}(\tilde{r}_\ell,\tilde{r}_m)\:.\nonumber\end{aligned}\end{split}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(r_i\)</span> and <span class="math notranslate nohighlight">\(\tilde{r}_\ell\)</span> represent electron and ion
positions, respectively; <span class="math notranslate nohighlight">\(\hat{p}_i\)</span> is a single electron momentum
operator; and <span class="math notranslate nohighlight">\(\hat{v}^{ee}(r_i,r_j)\)</span>,
<span class="math notranslate nohighlight">\(\hat{v}^{eI}(r_i,\tilde{r}_\ell)\)</span>, and
<span class="math notranslate nohighlight">\(\hat{v}^{II}(\tilde{r}_\ell,\tilde{r}_m)\)</span> are the
electron-electron, electron-ion, and ion-ion pair potential operators
(including nonlocal pseudopotentials, if present). This form of the
energy density is size consistent; that is, the partially integrated
energy density operators of well-separated atoms gives the isolated
Hamiltonians of the respective atoms. For periodic systems with
twist-averaged boundary conditions, the energy density is formally
correct only for either a set of supercell k-points that correspond to
real-valued wavefunctions or a k-point set that has inversion symmetry
around a k-point having a real-valued wavefunction. For more information
about the energy density, see <a class="bibtex reference internal" href="#krogel2013" id="id5">[KYKC13]</a>.</p>
<p>In QMCPACK, the energy density can be accumulated on piecewise uniform 3D grids in generalized Cartesian, cylindrical, or spherical coordinates.  The energy density integrated within Voronoi volumes centered on ion positions is also available.  The total particle number density is also accumulated on the same grids by the energy density estimator for convenience so that related quantities, such as the regional energy per particle, can be computed easily.</p>
<p><code class="docutils literal notranslate"><span class="pre">estimator</span> <span class="pre">type=EnergyDensity</span></code> element:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 65%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>parent elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian,</span> <span class="pre">qmc</span></code></p></td>
</tr>
<tr class="row-even"><td><p>child elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">reference_points,</span> <span class="pre">spacegrid</span></code></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>attributes:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 14%" />
<col style="width: 22%" />
<col style="width: 13%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">type</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><strong>EnergyDensity</strong></p></td>
<td></td>
<td><p>Must be EnergyDensity</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">name</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><em>anything</em></p></td>
<td></td>
<td><p>Unique name for estimator</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dynamic</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">particleset.name</span></code></p></td>
<td></td>
<td><p>Identify electrons</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">static</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>text</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">particleset.name</span></code></p></td>
<td></td>
<td><p>Identify ions</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Additional information:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name:</span></code> Must be unique. A dataset with blocked statistical data for
the energy density will appear in the <code class="docutils literal notranslate"><span class="pre">stat.h5</span></code> files labeled as
<code class="docutils literal notranslate"><span class="pre">name</span></code>.</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="listing-33">
<div class="code-block-caption"><span class="caption-number">Listing 33 </span><span class="caption-text">Energy density estimator accumulated on a <span class="math notranslate nohighlight">\(20 \times  10 \times 10\)</span> grid over the simulation cell.</span><a class="headerlink" href="#listing-33" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">estimator</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;EnergyDensity&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;EDcell&quot;</span> <span class="n">dynamic</span><span class="o">=</span><span class="s2">&quot;e&quot;</span> <span class="n">static</span><span class="o">=</span><span class="s2">&quot;ion0&quot;</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">spacegrid</span> <span class="n">coord</span><span class="o">=</span><span class="s2">&quot;cartesian&quot;</span><span class="o">&gt;</span>
     <span class="o">&lt;</span><span class="n">origin</span> <span class="n">p1</span><span class="o">=</span><span class="s2">&quot;zero&quot;</span><span class="o">/&gt;</span>
     <span class="o">&lt;</span><span class="n">axis</span> <span class="n">p1</span><span class="o">=</span><span class="s2">&quot;a1&quot;</span> <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;.5&quot;</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;x&quot;</span> <span class="n">grid</span><span class="o">=</span><span class="s2">&quot;-1 (.05) 1&quot;</span><span class="o">/&gt;</span>
     <span class="o">&lt;</span><span class="n">axis</span> <span class="n">p1</span><span class="o">=</span><span class="s2">&quot;a2&quot;</span> <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;.5&quot;</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;y&quot;</span> <span class="n">grid</span><span class="o">=</span><span class="s2">&quot;-1 (.1) 1&quot;</span><span class="o">/&gt;</span>
     <span class="o">&lt;</span><span class="n">axis</span> <span class="n">p1</span><span class="o">=</span><span class="s2">&quot;a3&quot;</span> <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;.5&quot;</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;z&quot;</span> <span class="n">grid</span><span class="o">=</span><span class="s2">&quot;-1 (.1) 1&quot;</span><span class="o">/&gt;</span>
   <span class="o">&lt;/</span><span class="n">spacegrid</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">estimator</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="listing-34">
<div class="code-block-caption"><span class="caption-number">Listing 34 </span><span class="caption-text">Energy density estimator accumulated within spheres of radius 6.9 Bohr centered on the first and second atoms in the ion0 particleset.</span><a class="headerlink" href="#listing-34" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">estimator</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;EnergyDensity&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;EDatom&quot;</span> <span class="n">dynamic</span><span class="o">=</span><span class="s2">&quot;e&quot;</span> <span class="n">static</span><span class="o">=</span><span class="s2">&quot;ion0&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">reference_points</span> <span class="n">coord</span><span class="o">=</span><span class="s2">&quot;cartesian&quot;</span><span class="o">&gt;</span>
    <span class="n">r1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span>
    <span class="n">r2</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span>
    <span class="n">r3</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span>
  <span class="o">&lt;/</span><span class="n">reference_points</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">spacegrid</span> <span class="n">coord</span><span class="o">=</span><span class="s2">&quot;spherical&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">origin</span> <span class="n">p1</span><span class="o">=</span><span class="s2">&quot;ion01&quot;</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="n">axis</span> <span class="n">p1</span><span class="o">=</span><span class="s2">&quot;r1&quot;</span> <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;6.9&quot;</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;r&quot;</span>     <span class="n">grid</span><span class="o">=</span><span class="s2">&quot;0 1&quot;</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="n">axis</span> <span class="n">p1</span><span class="o">=</span><span class="s2">&quot;r2&quot;</span> <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;6.9&quot;</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;phi&quot;</span>   <span class="n">grid</span><span class="o">=</span><span class="s2">&quot;0 1&quot;</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="n">axis</span> <span class="n">p1</span><span class="o">=</span><span class="s2">&quot;r3&quot;</span> <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;6.9&quot;</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;theta&quot;</span> <span class="n">grid</span><span class="o">=</span><span class="s2">&quot;0 1&quot;</span><span class="o">/&gt;</span>
  <span class="o">&lt;/</span><span class="n">spacegrid</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">spacegrid</span> <span class="n">coord</span><span class="o">=</span><span class="s2">&quot;spherical&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">origin</span> <span class="n">p1</span><span class="o">=</span><span class="s2">&quot;ion02&quot;</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="n">axis</span> <span class="n">p1</span><span class="o">=</span><span class="s2">&quot;r1&quot;</span> <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;6.9&quot;</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;r&quot;</span>     <span class="n">grid</span><span class="o">=</span><span class="s2">&quot;0 1&quot;</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="n">axis</span> <span class="n">p1</span><span class="o">=</span><span class="s2">&quot;r2&quot;</span> <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;6.9&quot;</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;phi&quot;</span>   <span class="n">grid</span><span class="o">=</span><span class="s2">&quot;0 1&quot;</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="n">axis</span> <span class="n">p1</span><span class="o">=</span><span class="s2">&quot;r3&quot;</span> <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;6.9&quot;</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;theta&quot;</span> <span class="n">grid</span><span class="o">=</span><span class="s2">&quot;0 1&quot;</span><span class="o">/&gt;</span>
  <span class="o">&lt;/</span><span class="n">spacegrid</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">estimator</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="listing-35">
<div class="code-block-caption"><span class="caption-number">Listing 35 </span><span class="caption-text">Energy density estimator accumulated within Voronoi polyhedra centered on the ions.</span><a class="headerlink" href="#listing-35" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">estimator</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;EnergyDensity&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;EDvoronoi&quot;</span> <span class="n">dynamic</span><span class="o">=</span><span class="s2">&quot;e&quot;</span> <span class="n">static</span><span class="o">=</span><span class="s2">&quot;ion0&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">spacegrid</span> <span class="n">coord</span><span class="o">=</span><span class="s2">&quot;voronoi&quot;</span><span class="o">/&gt;</span>
<span class="o">&lt;/</span><span class="n">estimator</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">&lt;reference_points/&gt;</span></code> element provides a set of points for later
use in specifying the origin and coordinate axes needed to construct a
spatial histogramming grid. Several reference points on the surface of
the simulation cell (see <a class="reference internal" href="#table8"><span class="std std-numref">Table 8</span></a>), as well as the
positions of the ions (see the <code class="docutils literal notranslate"><span class="pre">energydensity.static</span></code> attribute), are
made available by default. The reference points can be used, for
example, to construct a cylindrical grid along a bond with the origin on
the bond center.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">reference_points</span></code> element:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 65%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>parent elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">estimator</span> <span class="pre">type=EnergyDensity</span></code></p></td>
</tr>
<tr class="row-even"><td><p>child elements:</p></td>
<td><p><em>None</em></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>attributes:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 15%" />
<col style="width: 17%" />
<col style="width: 14%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">coord</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p>Cartesian/cell</p></td>
<td></td>
<td><p>Specify coordinate system</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>body text: The body text is a line formatted list of points with labels</p>
</div></blockquote>
<p>Additional information:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">coord:</span></code> If <code class="docutils literal notranslate"><span class="pre">coord=cartesian</span></code>, labeled points are in Cartesian
(x,y,z) format in units of Bohr. If <code class="docutils literal notranslate"><span class="pre">coord=cell</span></code>, then labeled
points are in units of the simulation cell axes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">body</span> <span class="pre">text:</span></code> The list of points provided in the body text are line
formatted, with four entries per line (<em>label</em> <em>coor1</em> <em>coor2</em>
<em>coor3</em>). A set of points referenced to the simulation cell is
available by default (see <a class="reference internal" href="#table8"><span class="std std-numref">Table 8</span></a>). If
<code class="docutils literal notranslate"><span class="pre">energydensity.static</span></code> is provided, the location of each individual
ion is also available (e.g., if <code class="docutils literal notranslate"><span class="pre">energydensity.static=ion0</span></code>, then
the location of the first atom is available with label ion01, the
second with ion02, etc.). All points can be used by label when
constructing spatial histogramming grids (see the following
<code class="docutils literal notranslate"><span class="pre">spacegrid</span></code> element) used to collect energy densities.</p></li>
</ul>
<table class="docutils align-default" id="table8">
<colgroup>
<col style="width: 18%" />
<col style="width: 48%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><code class="docutils literal notranslate"><span class="pre">label</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">point</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">description</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">zero</span></code></p></td>
<td><p>0 0 0</p></td>
<td><p>Cell center</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">a1</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(a_1\)</span></p></td>
<td><p>Cell axis 1</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">a2</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(a_2\)</span></p></td>
<td><p>Cell axis 2</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">a3</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(a_3\)</span></p></td>
<td><p>Cell axis 3</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">f1p</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(a_1\)</span>/2</p></td>
<td><p>Cell face 1+</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">f1m</span></code></p></td>
<td><p>-<span class="math notranslate nohighlight">\(a_1\)</span>/2</p></td>
<td><p>Cell face 1-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">f2p</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(a_2\)</span>/2</p></td>
<td><p>Cell face 2+</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">f2m</span></code></p></td>
<td><p>-<span class="math notranslate nohighlight">\(a_2\)</span>/2</p></td>
<td><p>Cell face 2-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">f3p</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(a_3\)</span>/2</p></td>
<td><p>Cell face 3+</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">f3m</span></code></p></td>
<td><p>-<span class="math notranslate nohighlight">\(a_3\)</span>/2</p></td>
<td><p>Cell face 3-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cppp</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\((a_1+a_2+a_3)/2\)</span></p></td>
<td><p>Cell corner +,+,+</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cppm</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\((a_1+a_2-a_3)/2\)</span></p></td>
<td><p>Cell corner +,+,-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cpmp</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\((a_1-a_2+a_3)/2\)</span></p></td>
<td><p>Cell corner +,-,+</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cmpp</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\((-a_1+a_2+a_3)/2\)</span></p></td>
<td><p>Cell corner -,+,+</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cpmm</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\((a_1-a_2-a_3)/2\)</span></p></td>
<td><p>Cell corner +,-,-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cmpm</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\((-a_1+a_2-a_3)/2\)</span></p></td>
<td><p>Cell corner -,+,-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cmmp</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\((-a_1-a_2+a_3)/2\)</span></p></td>
<td><p>Cell corner -,-,+</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cmmm</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\((-a_1-a_2-a_3)/2\)</span></p></td>
<td><p>Cell corner -,-,-</p></td>
</tr>
</tbody>
</table>
<p class="centered">
<strong>Table 8 Reference points available by default. Vectors <span class="math notranslate nohighlight">\(a_1\)</span>, <span class="math notranslate nohighlight">\(a_2\)</span>, and <span class="math notranslate nohighlight">\(a_3\)</span> refer to the simulation cell axes. The representation of the cell is centered around <code class="docutils literal notranslate"><span class="pre">zero</span></code>.</strong></p><p>The <code class="docutils literal notranslate"><span class="pre">&lt;spacegrid/&gt;</span></code> element is used to specify a spatial histogramming
grid for the energy density. Grids are constructed based on a set of,
potentially nonorthogonal, user-provided coordinate axes. The axes are
based on information available from <code class="docutils literal notranslate"><span class="pre">reference_points</span></code>. Voronoi grids
are based only on nearest neighbor distances between electrons and ions.
Any number of space grids can be provided to a single energy density
estimator.</p>
<p><code class="docutils literal notranslate"><span class="pre">spacegrid</span></code> element:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 65%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>parent elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">estimator</span> <span class="pre">type=EnergyDensity</span></code></p></td>
</tr>
<tr class="row-even"><td><p>child elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">origin,</span> <span class="pre">axis</span></code></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>attributes:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 14%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">coord</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p>Cartesian</p></td>
<td></td>
<td><p>Specify coordinate system</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>cylindrical</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td><p>spherical</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td><p>Voronoi</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The <code class="docutils literal notranslate"><span class="pre">&lt;origin/&gt;</span></code> element gives the location of the origin for a
non-Voronoi grid.</p>
<p>Additional information:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p1/p2/fraction:</span></code> The location of the origin is set to
<code class="docutils literal notranslate"><span class="pre">p1+fraction*(p2-p1)</span></code>. If only <code class="docutils literal notranslate"><span class="pre">p1</span></code> is provided, the origin is at
<code class="docutils literal notranslate"><span class="pre">p1</span></code>.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">origin</span></code> element:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 65%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>parent elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">spacegrid</span></code></p></td>
</tr>
<tr class="row-even"><td><p>child elements:</p></td>
<td><p><em>None</em></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>attributes:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 13%" />
<col style="width: 27%" />
<col style="width: 13%" />
<col style="width: 23%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">p1</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">reference_point.label</span></code></p></td>
<td></td>
<td><p>Select end point</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">p2</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>text</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">reference_point.label</span></code></p></td>
<td></td>
<td><p>Select end point</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">fraction</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>real</p></td>
<td></td>
<td><p>0</p></td>
<td><p>Interpolation fraction</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The <code class="docutils literal notranslate"><span class="pre">&lt;axis/&gt;</span></code> element represents a coordinate axis used to construct the, possibly curved, coordinate system for the histogramming grid.  Three <code class="docutils literal notranslate"><span class="pre">&lt;axis/&gt;</span></code> elements must be provided to a non-Voronoi <code class="docutils literal notranslate"><span class="pre">&lt;spacegrid/&gt;</span></code> element.</p>
<p><code class="docutils literal notranslate"><span class="pre">axis</span></code> element:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 65%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>parent elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">spacegrid</span></code></p></td>
</tr>
<tr class="row-even"><td><p>child elements:</p></td>
<td><p><em>None</em></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>attributes:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 14%" />
<col style="width: 28%" />
<col style="width: 13%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">label</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><em>See below</em></p></td>
<td></td>
<td><p>Axis/dimension label</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">grid</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td></td>
<td><p>“0 1”</p></td>
<td><p>Grid ranges/intervals</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">p1</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">reference_point.label</span></code></p></td>
<td></td>
<td><p>Select end point</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">p2</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>text</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">reference_point.label</span></code></p></td>
<td></td>
<td><p>Select end point</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">scale</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>real</p></td>
<td></td>
<td></td>
<td><p>Interpolation fraction</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Additional information:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">label:</span></code> The allowed set of axis labels depends on the coordinate
system (i.e., <code class="docutils literal notranslate"><span class="pre">spacegrid.coord</span></code>). Labels are <code class="docutils literal notranslate"><span class="pre">x/y/z</span></code> for
<code class="docutils literal notranslate"><span class="pre">coord=cartesian</span></code>, <code class="docutils literal notranslate"><span class="pre">r/phi/z</span></code> for <code class="docutils literal notranslate"><span class="pre">coord=cylindrical</span></code>,
<code class="docutils literal notranslate"><span class="pre">r/phi/theta</span></code> for <code class="docutils literal notranslate"><span class="pre">coord=spherical</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p1/p2/scale:</span></code> The axis vector is set to <code class="docutils literal notranslate"><span class="pre">p1+scale*(p2-p1)</span></code>. If
only <code class="docutils literal notranslate"><span class="pre">p1</span></code> is provided, the axis vector is <code class="docutils literal notranslate"><span class="pre">p1</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">grid:</span></code> The grid specifies the histogram grid along the direction
specified by <code class="docutils literal notranslate"><span class="pre">label</span></code>. The allowed grid points fall in the range
[-1,1] for <code class="docutils literal notranslate"><span class="pre">label=x/y/z</span></code> or [0,1] for <code class="docutils literal notranslate"><span class="pre">r/phi/theta</span></code>. A grid of 10
evenly spaced points between 0 and 1 can be requested equivalently by
<code class="docutils literal notranslate"><span class="pre">grid=&quot;0</span> <span class="pre">(0.1)</span> <span class="pre">1&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">grid=&quot;0</span> <span class="pre">(10)</span> <span class="pre">1.&quot;</span></code> Piecewise uniform grids
covering portions of the range are supported, e.g.,
<code class="docutils literal notranslate"><span class="pre">grid=&quot;-0.7</span> <span class="pre">(10)</span> <span class="pre">0.0</span> <span class="pre">(20)</span> <span class="pre">0.5.&quot;</span></code></p></li>
<li><p>Note that <code class="docutils literal notranslate"><span class="pre">grid</span></code> specifies the histogram grid along the (curved)
coordinate given by <code class="docutils literal notranslate"><span class="pre">label</span></code>. The axis specified by <code class="docutils literal notranslate"><span class="pre">p1/p2/scale</span></code>
does not correspond one-to-one with <code class="docutils literal notranslate"><span class="pre">label</span></code> unless <code class="docutils literal notranslate"><span class="pre">label=x/y/z</span></code>,
but the full set of axes provided defines the (sheared) space on top
of which the curved (e.g., spherical) coordinate system is built.</p></li>
</ul>
</div>
<div class="section" id="one-body-density-matrix">
<h3>One body density matrix<a class="headerlink" href="#one-body-density-matrix" title="Permalink to this headline">¶</a></h3>
<p>The N-body density matrix in DMC is
<span class="math notranslate nohighlight">\(\hat{\rho}_N=\left|{\Psi_{T}}\rangle{}\langle{\Psi_{FN}}\right|\)</span> (for VMC,
substitute <span class="math notranslate nohighlight">\(\Psi_T\)</span> for <span class="math notranslate nohighlight">\(\Psi_{FN}\)</span>). The one body reduced
density matrix (1RDM) is obtained by tracing out all particle
coordinates but one:</p>
<div class="math notranslate nohighlight" id="equation-eq40">
<span class="eqno">(40)<a class="headerlink" href="#equation-eq40" title="Permalink to this equation">¶</a></span>\[\hat{n}_1 = \sum_nTr_{R_n}\left|{\Psi_{T}}\rangle{}\langle{\Psi_{FN}}\right|\]</div>
<p>In this formula, the sum is over all electron indices and
<span class="math notranslate nohighlight">\(Tr_{R_n}(*)\equiv\int dR_n\langle{R_n}\left|{*}\right|{R_n}\rangle\)</span> with
<span class="math notranslate nohighlight">\(R_n=[r_1,...,r_{n-1},r_{n+1},...,r_N]\)</span>. When the sum is
restricted over spin-up or spin-down electrons, one obtains a density
matrix for each spin species. The 1RDM computed by is partitioned in
this way.</p>
<p>In real space, the matrix elements of the 1RDM are</p>
<div class="math notranslate nohighlight" id="equation-eq41">
<span class="eqno">(41)<a class="headerlink" href="#equation-eq41" title="Permalink to this equation">¶</a></span>\[\begin{aligned}
   n_1(r,r') &amp;= \langle{r}\left|{\hat{n}_1}\right|{r'}\rangle = \sum_n\int dR_n \Psi_T(r,R_n)\Psi_{FN}^*(r',R_n)\:. \end{aligned}\]</div>
<p>A more efficient and compact representation of the 1RDM is obtained by
expanding in the SPOs obtained from a Hartree-Fock or DFT calculation,
<span class="math notranslate nohighlight">\(\{\phi_i\}\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq42">
<span class="eqno">(42)<a class="headerlink" href="#equation-eq42" title="Permalink to this equation">¶</a></span>\[\begin{split}n_1(i,j) &amp;= \langle{\phi_i}\left|{\hat{n}_1}\right|{\phi_j}\rangle \nonumber \\
         &amp;= \int dR \Psi_{FN}^*(R)\Psi_{T}(R) \sum_n\int dr'_n \frac{\Psi_T(r_n',R_n)}{\Psi_T(r_n,R_n)}\phi_i(r_n')^* \phi_j(r_n)\:.\end{split}\]</div>
<p>The integration over <span class="math notranslate nohighlight">\(r'\)</span> in <a class="reference internal" href="#equation-eq42">(42)</a> is inefficient when one is also interested in obtaining matrices involving energetic quantities, such as the energy density matrix of <a class="bibtex reference internal" href="#krogel2014" id="id6">[KKR14]</a> or the related (and more well known) generalized Fock matrix.  For this reason, an approximation is introduced as follows:</p>
<div class="math notranslate nohighlight" id="equation-eq43">
<span class="eqno">(43)<a class="headerlink" href="#equation-eq43" title="Permalink to this equation">¶</a></span>\[\begin{aligned}
    n_1(i,j) \approx \int dR \Psi_{FN}(R)^*\Psi_T(R)  \sum_n \int dr_n' \frac{\Psi_T(r_n',R_n)^*}{\Psi_T(r_n,R_n)^*}\phi_i(r_n)^* \phi_j(r_n')\:. \end{aligned}\]</div>
<p>For VMC, FN-DMC, FP-DMC, and RN-DMC this formula represents an exact
sampling of the 1RDM corresponding to <span class="math notranslate nohighlight">\(\hat{\rho}_N^\dagger\)</span> (see
appendix A of <a class="bibtex reference internal" href="#krogel2014" id="id7">[KKR14]</a> for more detail).</p>
<p><code class="docutils literal notranslate"><span class="pre">estimtor</span> <span class="pre">type=dm1b</span></code> element:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 45%" />
<col style="width: 55%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>parent elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian,</span> <span class="pre">qmc</span></code></p></td>
</tr>
<tr class="row-even"><td><p>child elements:</p></td>
<td><p><em>None</em></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>attributes:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 16%" />
<col style="width: 14%" />
<col style="width: 15%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">type</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><strong>dm1b</strong></p></td>
<td></td>
<td><p>Must be dm1b</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">name</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><em>anything</em></p></td>
<td></td>
<td><p>Unique name for estimator</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>parameters:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 28%" />
<col style="width: 12%" />
<col style="width: 25%" />
<col style="width: 12%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">basis</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text array</p></td>
<td><p>sposet.name(s)</p></td>
<td></td>
<td><p>Orbital basis</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">integrator</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>text</p></td>
<td><p>uniform_grid uniform density</p></td>
<td><p>uniform_grid</p></td>
<td><p>Integration method</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">evaluator</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>text</p></td>
<td><p>loop/matrix</p></td>
<td><p>loop</p></td>
<td><p>Evaluation method</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">scale</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>real</p></td>
<td><p><span class="math notranslate nohighlight">\(0&lt;scale&lt;1\)</span></p></td>
<td><p>1.0</p></td>
<td><p>Scale integration cell</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">center</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>real array(3)</p></td>
<td><p><em>any point</em></p></td>
<td></td>
<td><p>Center of cell</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">points</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>integer</p></td>
<td><p><span class="math notranslate nohighlight">\(&gt;0\)</span></p></td>
<td><p>10</p></td>
<td><p>Grid points in each dim</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">samples</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>integer</p></td>
<td><p><span class="math notranslate nohighlight">\(&gt;0\)</span></p></td>
<td><p>10</p></td>
<td><p>MC samples</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">warmup</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>integer</p></td>
<td><p><span class="math notranslate nohighlight">\(&gt;0\)</span></p></td>
<td><p>30</p></td>
<td><p>MC warmup</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">timestep</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>real</p></td>
<td><p><span class="math notranslate nohighlight">\(&gt;0\)</span></p></td>
<td><p>0.5</p></td>
<td><p>MC time step</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">use_drift</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>no</p></td>
<td><p>Use drift in VMC</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">check_overlap</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>no</p></td>
<td><p>Print overlap matrix</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">check_derivatives</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>no</p></td>
<td><p>Check density derivatives</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">acceptance_ratio</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>no</p></td>
<td><p>Print accept ratio</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">rstats</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>no</p></td>
<td><p>Print spatial stats</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">normalized</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">basis</span></code> comes norm’ed</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">volume_normed</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">basis</span></code> norm is volume</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">energy_matrix</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>no</p></td>
<td><p>Energy density matrix</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Additional information:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name:</span></code> Density matrix results appear in <code class="docutils literal notranslate"><span class="pre">stat.h5</span></code> files labeled
according to <code class="docutils literal notranslate"><span class="pre">name</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">basis:</span></code> List <code class="docutils literal notranslate"><span class="pre">sposet.name</span></code>’s. The total set of orbitals
contained in all <code class="docutils literal notranslate"><span class="pre">sposet</span></code>’s comprises the basis (subspace) onto
which the one body density matrix is projected. This set of orbitals
generally includes many virtual orbitals that are not occupied in a
single reference Slater determinant.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">integrator:</span></code> Select the method used to perform the additional
single particle integration. Options are <code class="docutils literal notranslate"><span class="pre">uniform_grid</span></code> (uniform
grid of points over the cell), <code class="docutils literal notranslate"><span class="pre">uniform</span></code> (uniform random sampling
over the cell), and <code class="docutils literal notranslate"><span class="pre">density</span></code> (Metropolis sampling of approximate
density, <span class="math notranslate nohighlight">\(\sum_{b\in \texttt{basis}}\left|{\phi_b}\right|^2\)</span>, is not
well tested, please check results carefully!). Depending on the
integrator selected, different subsets of the other input parameters
are active.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">evaluator:</span></code> Select for-loop or matrix multiply implementations.
Matrix is preferred for speed. Both implementations should give the
same results, but please check as this has not been exhaustively
tested.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scale:</span></code> Resize the simulation cell by scale for use as an
integration volume (active for <code class="docutils literal notranslate"><span class="pre">integrator=uniform/uniform_grid</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">center:</span></code> Translate the integration volume to center at this point
(active for <code class="docutils literal notranslate"><span class="pre">integrator=uniform/</span> <span class="pre">uniform_grid</span></code>). If <code class="docutils literal notranslate"><span class="pre">center</span></code> is
not provided, the scaled simulation cell is used as is.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">points:</span></code> Number of grid points in each dimension for
<code class="docutils literal notranslate"><span class="pre">integrator=uniform_grid</span></code>. For example, <code class="docutils literal notranslate"><span class="pre">points=10</span></code> results in a
uniform <span class="math notranslate nohighlight">\(10 \times 10 \times 10\)</span> grid over the cell.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">samples:</span></code> Sets the number of MC samples collected for each step
(active for <code class="docutils literal notranslate"><span class="pre">integrator=uniform/</span> <span class="pre">density</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">warmup:</span></code> Number of warmup Metropolis steps at the start of the run
before data collection (active for <code class="docutils literal notranslate"><span class="pre">integrator=density</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">timestep:</span></code> Drift-diffusion time step used in Metropolis sampling
(active for <code class="docutils literal notranslate"><span class="pre">integrator=density</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_drift:</span></code> Enable drift in Metropolis sampling (active for
<code class="docutils literal notranslate"><span class="pre">integrator=density</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check_overlap:</span></code> Print the overlap matrix (computed via simple
Riemann sums) to the log, then abort. Note that subsequent analysis
based on the 1RDM is simplest if the input orbitals are orthogonal.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check_derivatives:</span></code> Print analytic and numerical derivatives of
the approximate (sampled) density for several sample points, then
abort.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">acceptance_ratio:</span></code> Print the acceptance ratio of the density
sampling to the log for each step.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rstats:</span></code> Print statistical information about the spatial motion of
the sampled points to the log for each step.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">normalized:</span></code> Declare whether the inputted orbitals are normalized
or not. If <code class="docutils literal notranslate"><span class="pre">normalized=no</span></code>, direct Riemann integration over a
<span class="math notranslate nohighlight">\(200 \times 200 \times 200\)</span> grid will be used to compute the
normalizations before use.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">volume_normed:</span></code> Declare whether the inputted orbitals are
normalized to the cell volume (default) or not (a norm of 1.0 is
assumed in this case). Currently, B-spline orbitals coming from QE
and HEG planewave orbitals native to QMCPACK are known to be volume
normalized.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">energy_matrix:</span></code> Accumulate the one body reduced energy density
matrix, and write it to <code class="docutils literal notranslate"><span class="pre">stat.h5</span></code>. This matrix is not covered in
any detail here; the interested reader is referred to
<a class="bibtex reference internal" href="#krogel2014" id="id8">[KKR14]</a>.</p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="listing-36">
<div class="code-block-caption"><span class="caption-number">Listing 36 </span><span class="caption-text">One body density matrix with uniform grid integration.</span><a class="headerlink" href="#listing-36" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">estimator</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;dm1b&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;DensityMatrices&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;basis&quot;</span>        <span class="o">&gt;</span>  <span class="n">spo_u</span> <span class="n">spo_uv</span>  <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;evaluator&quot;</span>    <span class="o">&gt;</span>  <span class="n">matrix</span>        <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;integrator&quot;</span>   <span class="o">&gt;</span>  <span class="n">uniform_grid</span>  <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;points&quot;</span>       <span class="o">&gt;</span>  <span class="mi">4</span>             <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;scale&quot;</span>        <span class="o">&gt;</span>  <span class="mf">1.0</span>           <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;center&quot;</span>       <span class="o">&gt;</span>  <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>         <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">estimator</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="listing-37">
<div class="code-block-caption"><span class="caption-number">Listing 37 </span><span class="caption-text">One body density matrix with uniform sampling.</span><a class="headerlink" href="#listing-37" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">estimator</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;dm1b&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;DensityMatrices&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;basis&quot;</span>        <span class="o">&gt;</span>  <span class="n">spo_u</span> <span class="n">spo_uv</span>  <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;evaluator&quot;</span>    <span class="o">&gt;</span>  <span class="n">matrix</span>        <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;integrator&quot;</span>   <span class="o">&gt;</span>  <span class="n">uniform</span>       <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;samples&quot;</span>      <span class="o">&gt;</span>  <span class="mi">64</span>            <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;scale&quot;</span>        <span class="o">&gt;</span>  <span class="mf">1.0</span>           <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;center&quot;</span>       <span class="o">&gt;</span>  <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>         <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">estimator</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="listing-38">
<div class="code-block-caption"><span class="caption-number">Listing 38 </span><span class="caption-text">One body density matrix with density sampling.</span><a class="headerlink" href="#listing-38" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">estimator</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;dm1b&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;DensityMatrices&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;basis&quot;</span>        <span class="o">&gt;</span>  <span class="n">spo_u</span> <span class="n">spo_uv</span>  <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;evaluator&quot;</span>    <span class="o">&gt;</span>  <span class="n">matrix</span>        <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;integrator&quot;</span>   <span class="o">&gt;</span>  <span class="n">density</span>       <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;samples&quot;</span>      <span class="o">&gt;</span>  <span class="mi">64</span>            <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;timestep&quot;</span>     <span class="o">&gt;</span>  <span class="mf">0.5</span>           <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;use_drift&quot;</span>    <span class="o">&gt;</span>  <span class="n">no</span>            <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">estimator</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="listing-39">
<div class="code-block-caption"><span class="caption-number">Listing 39 </span><span class="caption-text">Example <code class="docutils literal notranslate"><span class="pre">sposet</span></code> initialization for density matrix use.  Occupied and virtual orbital sets are created separately, then joined (<code class="docutils literal notranslate"><span class="pre">basis=&quot;spo_u</span> <span class="pre">spo_uv&quot;</span></code>).</span><a class="headerlink" href="#listing-39" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">sposet_builder</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;bspline&quot;</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;../dft/pwscf_output/pwscf.pwscf.h5&quot;</span> <span class="n">tilematrix</span><span class="o">=</span><span class="s2">&quot;1 0 0 0 1 0 0 0 1&quot;</span> <span class="n">twistnum</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="n">meshfactor</span><span class="o">=</span><span class="s2">&quot;1.0&quot;</span> <span class="n">gpu</span><span class="o">=</span><span class="s2">&quot;no&quot;</span> <span class="n">precision</span><span class="o">=</span><span class="s2">&quot;single&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">sposet</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;bspline&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;spo_u&quot;</span>  <span class="n">group</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;4&quot;</span><span class="o">/&gt;</span>
  <span class="o">&lt;</span><span class="n">sposet</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;bspline&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;spo_d&quot;</span>  <span class="n">group</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;2&quot;</span><span class="o">/&gt;</span>
  <span class="o">&lt;</span><span class="n">sposet</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;bspline&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;spo_uv&quot;</span> <span class="n">group</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="n">index_min</span><span class="o">=</span><span class="s2">&quot;4&quot;</span> <span class="n">index_max</span><span class="o">=</span><span class="s2">&quot;10&quot;</span><span class="o">/&gt;</span>
<span class="o">&lt;/</span><span class="n">sposet_builder</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="listing-40">
<div class="code-block-caption"><span class="caption-number">Listing 40 </span><span class="caption-text">Example <code class="docutils literal notranslate"><span class="pre">sposet</span></code> initialization for density matrix use. Density matrix orbital basis created separately (<code class="docutils literal notranslate"><span class="pre">basis=&quot;dm_basis&quot;</span></code>).</span><a class="headerlink" href="#listing-40" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">sposet_builder</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;bspline&quot;</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;../dft/pwscf_output/pwscf.pwscf.h5&quot;</span> <span class="n">tilematrix</span><span class="o">=</span><span class="s2">&quot;1 0 0 0 1 0 0 0 1&quot;</span> <span class="n">twistnum</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="n">meshfactor</span><span class="o">=</span><span class="s2">&quot;1.0&quot;</span> <span class="n">gpu</span><span class="o">=</span><span class="s2">&quot;no&quot;</span> <span class="n">precision</span><span class="o">=</span><span class="s2">&quot;single&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">sposet</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;bspline&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;spo_u&quot;</span>  <span class="n">group</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;4&quot;</span><span class="o">/&gt;</span>
  <span class="o">&lt;</span><span class="n">sposet</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;bspline&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;spo_d&quot;</span>  <span class="n">group</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;2&quot;</span><span class="o">/&gt;</span>
  <span class="o">&lt;</span><span class="n">sposet</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;bspline&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;dm_basis&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;50&quot;</span> <span class="n">spindataset</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="o">/&gt;</span>
<span class="o">&lt;/</span><span class="n">sposet_builder</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="forward-walking-estimators">
<span id="forward-walking"></span><h2>Forward-Walking Estimators<a class="headerlink" href="#forward-walking-estimators" title="Permalink to this headline">¶</a></h2>
<p>Forward walking is a method for sampling the pure fixed-node
distribution <span class="math notranslate nohighlight">\(\langle \Phi_0 | \Phi_0\rangle\)</span>. Specifically, one
multiplies each walker’s DMC mixed estimate for the observable
<span class="math notranslate nohighlight">\(\mathcal{O}\)</span>,
<span class="math notranslate nohighlight">\(\frac{\mathcal{O}(\mathbf{R})\Psi_T(\mathbf{R})}{\Psi_T(\mathbf{R})}\)</span>,
by the weighting factor
<span class="math notranslate nohighlight">\(\frac{\Phi_0(\mathbf{R})}{\Psi_T(\mathbf{R})}\)</span>. As it turns out,
this weighting factor for any walker <span class="math notranslate nohighlight">\(\mathbf{R}\)</span> is proportional
to the total number of descendants the walker will have after a
sufficiently long projection time <span class="math notranslate nohighlight">\(\beta\)</span>.</p>
<p>To forward walk on an observable, declare a generic forward-walking
estimator within a <code class="docutils literal notranslate"><span class="pre">&lt;hamiltonian&gt;</span></code> block, and then specify the
observables to forward walk on and the forward-walking parameters. Here
is a summary.</p>
<p><code class="docutils literal notranslate"><span class="pre">estimator</span> <span class="pre">type=ForwardWalking</span></code> element:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 45%" />
<col style="width: 55%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>parent elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian,</span> <span class="pre">qmc</span></code></p></td>
</tr>
<tr class="row-even"><td><p>child elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Observable</span></code></p></td>
</tr>
</tbody>
</table>
<p>attributes:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 15%" />
<col style="width: 21%" />
<col style="width: 14%" />
<col style="width: 28%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">type</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><strong>ForwardWalking</strong></p></td>
<td></td>
<td><p>Must be “ForwardWalking”</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">name</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><em>anything</em></p></td>
<td><p>any</p></td>
<td><p>Unique name for estimator</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">Observable</span></code> element:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 65%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>parent elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">estimator,</span> <span class="pre">hamiltonian,</span> <span class="pre">qmc</span></code></p></td>
</tr>
<tr class="row-even"><td><p>child elements:</p></td>
<td><p><em>None</em></p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 9%" />
<col style="width: 10%" />
<col style="width: 9%" />
<col style="width: 54%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">name</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><em>anything</em></p></td>
<td><p>any</p></td>
<td><p>Registered name of existing estimator on which to forward walk</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">max</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>integer</p></td>
<td><p><span class="math notranslate nohighlight">\(&gt;0\)</span></p></td>
<td></td>
<td><p>Maximum projection time in steps (<code class="docutils literal notranslate"><span class="pre">max</span></code><span class="math notranslate nohighlight">\(=\beta/\tau\)</span>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">frequency</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p><span class="math notranslate nohighlight">\(\geq 1\)</span></p></td>
<td></td>
<td><p>Dump data only for every <code class="docutils literal notranslate"><span class="pre">frequency</span></code>-th to <code class="docutils literal notranslate"><span class="pre">scalar.dat</span></code> file</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div></blockquote>
<p>Additional information:</p>
<ul class="simple">
<li><p><strong>Cost</strong>: Because histories of observables up to <code class="docutils literal notranslate"><span class="pre">max</span></code> time steps
have to be stored, the memory cost of storing the nonforward-walked
observables variables should be multiplied by <span class="math notranslate nohighlight">\(\texttt{max}\)</span>.
Although this is not an issue for items such as potential energy, it
could be prohibitive for observables such as density, forces, etc.</p></li>
<li><p><strong>Naming Convention</strong>: Forward-walked observables are automatically
named <code class="docutils literal notranslate"><span class="pre">FWE_name_i</span></code>, where <code class="docutils literal notranslate"><span class="pre">i</span></code> is the forward-walked expectation
value at time step <code class="docutils literal notranslate"><span class="pre">i</span></code>, and <code class="docutils literal notranslate"><span class="pre">name</span></code> is whatever name appears in
the <code class="docutils literal notranslate"><span class="pre">&lt;Observable&gt;</span></code> block. This is also how it will appear in the
<code class="docutils literal notranslate"><span class="pre">scalar.dat</span></code> file.</p></li>
</ul>
<p>In the following example case, QMCPACK forward walks on the potential
energy for 300 time steps and dumps the forward-walked value at every
time step.</p>
<div class="literal-block-wrapper docutils container" id="listing-41">
<div class="code-block-caption"><span class="caption-number">Listing 41 </span><span class="caption-text">Forward-walking estimator element.</span><a class="headerlink" href="#listing-41" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;estimator name=&quot;fw&quot; type=&quot;ForwardWalking&quot;&gt;
    &lt;Observable name=&quot;LocalPotential&quot; max=&quot;300&quot; frequency=&quot;1&quot;/&gt;
     &lt;!--- Additional Observable blocks go here --&gt;
 &lt;/estimator&gt;
</pre></div>
</div>
</div>
</div>
<div class="section" id="force-estimators">
<span id="force-est"></span><h2>“Force” estimators<a class="headerlink" href="#force-estimators" title="Permalink to this headline">¶</a></h2>
<p>QMCPACK supports force estimation by use of the Chiesa-Ceperly-Zhang
(CCZ) estimator. Currently, open and periodic boundary conditions are
supported but for all-electron calculations only.</p>
<p>Without loss of generality, the CCZ estimator for the z-component of the
force on an ion centered at the origin is given by the following
expression:</p>
<div class="math notranslate nohighlight" id="equation-eq44">
<span class="eqno">(44)<a class="headerlink" href="#equation-eq44" title="Permalink to this equation">¶</a></span>\[F_z = -Z \sum_{i=1}^{N_e}\frac{z_i}{r_i^3}[\theta(r_i-\mathcal{R}) + \theta(\mathcal{R}-r_i)\sum_{\ell=1}^{M}c_\ell r_i^\ell]\:.\]</div>
<p>Z is the ionic charge, <span class="math notranslate nohighlight">\(M\)</span> is the degree of the smoothing
polynomial, <span class="math notranslate nohighlight">\(\mathcal{R}\)</span> is a real-space cutoff of the sphere
within which the bare-force estimator is smoothed, and <span class="math notranslate nohighlight">\(c_\ell\)</span>
are predetermined coefficients. These coefficients are chosen to
minimize the weighted mean square error between the bare force estimate
and the s-wave filtered estimator. Specifically,</p>
<div class="math notranslate nohighlight" id="equation-eq45">
<span class="eqno">(45)<a class="headerlink" href="#equation-eq45" title="Permalink to this equation">¶</a></span>\[\chi^2 = \int_0^\mathcal{R}dr\,r^m\,[f_z(r) - \tilde{f}_z(r)]^2\:.\]</div>
<p>Here, <span class="math notranslate nohighlight">\(m\)</span> is the weighting exponent, <span class="math notranslate nohighlight">\(f_z(r)\)</span> is the
unfiltered radial force density for the z force component, and
<span class="math notranslate nohighlight">\(\tilde{f}_z(r)\)</span> is the smoothed polynomial function for the same
force density. The reader is invited to refer to the original paper for
a more thorough explanation of the methodology, but with the notation in
hand, QMCPACK takes the following parameters.</p>
<p><code class="docutils literal notranslate"><span class="pre">estimator</span> <span class="pre">type=Force</span></code> element:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 45%" />
<col style="width: 55%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>parent elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hamiltonian,</span> <span class="pre">qmc</span></code></p></td>
</tr>
<tr class="row-even"><td><p>child elements:</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">parameter</span></code></p></td>
</tr>
</tbody>
</table>
<p>attributes:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 11%" />
<col style="width: 13%" />
<col style="width: 10%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">mode</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>text</p></td>
<td><p><em>See above</em></p></td>
<td><p>bare</p></td>
<td><p>Select estimator type</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">lrmethod</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>text</p></td>
<td><p>ewald or srcoul</p></td>
<td><p>ewald</p></td>
<td><p>Select long-range potential breakup method</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">type</span></code><span class="math notranslate nohighlight">\(^r\)</span></p></td>
<td><p>text</p></td>
<td><p>Force</p></td>
<td></td>
<td><p>Must be “Force”</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">name</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>text</p></td>
<td><p><em>Anything</em></p></td>
<td><p>ForceBase</p></td>
<td><p>Unique name for this estimator</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pbc</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>yes</p></td>
<td><p>Using periodic BCs or not</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">addionion</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>boolean</p></td>
<td><p>yes/no</p></td>
<td><p>no</p></td>
<td><p>Add the ion-ion force contribution to output force estimate</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>parameters:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 11%" />
<col style="width: 10%" />
<col style="width: 11%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Datatype</strong></p></th>
<th class="head"><p><strong>Values</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rcut</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>real</p></td>
<td><p><span class="math notranslate nohighlight">\(&gt;0\)</span></p></td>
<td><p>1.0</p></td>
<td><p>Real-space cutoff <span class="math notranslate nohighlight">\(\mathcal{R}\)</span> in bohr</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">nbasis</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>integer</p></td>
<td><p><span class="math notranslate nohighlight">\(&gt;0\)</span></p></td>
<td><p>2</p></td>
<td><p>Degree of smoothing polynomial <span class="math notranslate nohighlight">\(M\)</span></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">weightexp</span></code><span class="math notranslate nohighlight">\(^o\)</span></p></td>
<td><p>integer</p></td>
<td><p><span class="math notranslate nohighlight">\(&gt;0\)</span></p></td>
<td><p>2</p></td>
<td><p><span class="math notranslate nohighlight">\(\chi^2\)</span> weighting exponent :math`m`</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div></blockquote>
<p>Additional information:</p>
<ul class="simple">
<li><p><strong>Naming Convention</strong>: The unique identifier <code class="docutils literal notranslate"><span class="pre">name</span></code> is appended
with <code class="docutils literal notranslate"><span class="pre">name_X_Y</span></code> in the <code class="docutils literal notranslate"><span class="pre">scalar.dat</span></code> file, where <code class="docutils literal notranslate"><span class="pre">X</span></code> is the ion
ID number and <code class="docutils literal notranslate"><span class="pre">Y</span></code> is the component ID (an integer with x=0, y=1,
z=2). All force components for all ions are computed and dumped to
the <code class="docutils literal notranslate"><span class="pre">scalar.dat</span></code> file.</p></li>
<li><p><strong>Long-range breakup</strong>: With periodic boundary conditions, it is
important to converge the lattice sum when calculating Coulomb
contribution to the forces. As a quick test, increase the
<code class="docutils literal notranslate"><span class="pre">LR_dim_cutoff</span></code> parameter until ion-ion forces are converged. The
Ewald method (<code class="docutils literal notranslate"><span class="pre">lrmethod</span></code>=”ewald”) converges more slowly than
optimized method (<code class="docutils literal notranslate"><span class="pre">lrmethod</span></code>=”srcoul”).</p></li>
<li><p><strong>Miscellaneous</strong>: Usually, the default choice of <code class="docutils literal notranslate"><span class="pre">weightexp</span></code> is
sufficient. Different combinations of <code class="docutils literal notranslate"><span class="pre">rcut</span></code> and <code class="docutils literal notranslate"><span class="pre">nbasis</span></code> should
be tested though to minimize variance and bias. There is, of course,
a tradeoff, with larger <code class="docutils literal notranslate"><span class="pre">nbasis</span></code> and smaller <code class="docutils literal notranslate"><span class="pre">rcut</span></code> leading to
smaller biases and larger variances.</p></li>
</ul>
<p>The following is an example use case.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">simulationcell</span><span class="o">&gt;</span>
  <span class="o">...</span>
  <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;LR\_dim\_cutoff&quot;</span><span class="o">&gt;</span>  <span class="mi">20</span>  <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">simulationcell</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">estimator</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;myforce&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Force&quot;</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;cep&quot;</span> <span class="n">addionion</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span> <span class="n">lrmethod</span><span class="o">=</span><span class="s2">&quot;srcoul&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;rcut&quot;</span><span class="o">&gt;</span><span class="mf">0.1</span><span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;nbasis&quot;</span><span class="o">&gt;</span><span class="mi">4</span><span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;weightexp&quot;</span><span class="o">&gt;</span><span class="mi">2</span><span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">estimator</span><span class="o">&gt;</span>
</pre></div>
</div>
<p id="bibtex-bibliography-hamiltonianobservable-0"><dl class="citation">
<dt class="bibtex label" id="chiesa2006"><span class="brackets"><a class="fn-backref" href="#id4">CCMH06</a></span></dt>
<dd><p>Simone Chiesa, David M. Ceperley, Richard M. Martin, and Markus Holzmann. Finite-size error in many-body simulations with long-range interactions. <em>Phys. Rev. Lett.</em>, 97:076404, August 2006. <a class="reference external" href="https://doi.org/10.1103/PhysRevLett.97.076404">doi:10.1103/PhysRevLett.97.076404</a>.</p>
</dd>
<dt class="bibtex label" id="krogel2014"><span class="brackets">KKR14</span><span class="fn-backref">(<a href="#id6">1</a>,<a href="#id7">2</a>,<a href="#id8">3</a>)</span></dt>
<dd><p>Jaron T. Krogel, Jeongnim Kim, and Fernando A. Reboredo. Energy density matrix formalism for interacting quantum systems: quantum monte carlo study. <em>Phys. Rev. B</em>, 90:035125, July 2014. <a class="reference external" href="https://doi.org/10.1103/PhysRevB.90.035125">doi:10.1103/PhysRevB.90.035125</a>.</p>
</dd>
<dt class="bibtex label" id="krogel2013"><span class="brackets"><a class="fn-backref" href="#id5">KYKC13</a></span></dt>
<dd><p>Jaron T. Krogel, Min Yu, Jeongnim Kim, and David M. Ceperley. Quantum energy density: improved efficiency for quantum monte carlo calculations. <em>Phys. Rev. B</em>, 88:035137, July 2013. <a class="reference external" href="https://doi.org/10.1103/PhysRevB.88.035137">doi:10.1103/PhysRevB.88.035137</a>.</p>
</dd>
<dt class="bibtex label" id="mitas1991"><span class="brackets"><a class="fn-backref" href="#id2">MSC91</a></span></dt>
<dd><p>Lubos Mitas, Eric L. Shirley, and David M. Ceperley. Nonlocal pseudopotentials and diffusion monte carlo. <em>The Journal of Chemical Physics</em>, 95(5):3467–3475, 1991. <a class="reference external" href="https://doi.org/10.1063/1.460849">doi:10.1063/1.460849</a>.</p>
</dd>
<dt class="bibtex label" id="natoli1995"><span class="brackets"><a class="fn-backref" href="#id1">NC95</a></span></dt>
<dd><p>Vincent Natoli and David M. Ceperley. An optimized method for treating long-range potentials. <em>Journal of Computational Physics</em>, 117(1):171–178, 1995. URL: <a class="reference external" href="http://www.sciencedirect.com/science/article/pii/S0021999185710546">http://www.sciencedirect.com/science/article/pii/S0021999185710546</a>, <a class="reference external" href="https://doi.org/10.1006/jcph.1995.1054">doi:10.1006/jcph.1995.1054</a>.</p>
</dd>
<dt class="bibtex label" id="zen2019dla"><span class="brackets"><a class="fn-backref" href="#id3">ZBMAlfe19</a></span></dt>
<dd><p>Andrea Zen, Jan Gerit Brandenburg, Angelos Michaelides, and Dario Alfè. A new scheme for fixed node diffusion quantum monte carlo with pseudopotentials: improving reproducibility and reducing the trial-wave-function bias. <em>The Journal of Chemical Physics</em>, 151(13):134105, October 2019. <a class="reference external" href="https://doi.org/10.1063/1.5119729">doi:10.1063/1.5119729</a>.</p>
</dd>
</dl>
</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="methods.html" class="btn btn-neutral float-right" title="Quantum Monte Carlo Methods" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="intro_wavefunction.html" class="btn btn-neutral float-left" title="Trial wavefunction specificaion" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, QMCPACK Developers

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
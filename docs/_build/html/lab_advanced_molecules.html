

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Lab 3: Advanced molecular calculations &mdash; QMCPACK Manual 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Lab 4: Condensed Matter Calculations" href="lab_condensed_matter.html" />
    <link rel="prev" title="Lab 2: QMC Basics" href="lab_qmc_basics.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> QMCPACK Manual
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="features.html">Features of QMCPACK</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Obtaining, installing, and validating QMCPACK</a></li>
<li class="toctree-l1"><a class="reference internal" href="running.html">Running QMCPACK</a></li>
<li class="toctree-l1"><a class="reference internal" href="units.html">Units used in QMCPACK</a></li>
<li class="toctree-l1"><a class="reference internal" href="input_overview.html">Input file overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulationcell.html">Specifying the system to be simulated</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro_wavefunction.html">Trial wavefunction specificaion</a></li>
<li class="toctree-l1"><a class="reference internal" href="hamiltonianobservable.html">Hamiltonian and Observables</a></li>
<li class="toctree-l1"><a class="reference internal" href="methods.html">Quantum Monte Carlo Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="output_overview.html">Output Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="analyzing.html">Analyzing QMCPACK data</a></li>
<li class="toctree-l1"><a class="reference internal" href="LCAO.html">Periodic LCAO for Solids</a></li>
<li class="toctree-l1"><a class="reference internal" href="sCI.html">Selected Configuration Interaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="afqmc.html">Auxiliary-Field Quantum Monte Carlo</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab_qmc_statistics.html">Lab 1: MC Statistical Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab_qmc_basics.html">Lab 2: QMC Basics</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Lab 3: Advanced molecular calculations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#topics-covered-in-this-lab">Topics covered in this lab</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lab-directories-and-files">Lab directories and files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#exercise-1-basics">Exercise #1: Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#generation-of-a-hartree-fock-wavefunction-with-gamess">Generation of a Hartree-Fock wavefunction with GAMESS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#optimize-the-wavefunction">Optimize the wavefunction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#time-step-study">Time-step study</a></li>
<li class="toctree-l3"><a class="reference internal" href="#walker-population-study">Walker population study</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#exercise-2-slater-jastrow-wavefunction-options">Exercise #2: Slater-Jastrow wavefunction options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#influence-of-jastrow-on-vmc-energy-with-hf-wavefunction">Influence of Jastrow on VMC energy with HF wavefunction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#generation-of-wavefunctions-from-dft-using-gamess">Generation of wavefunctions from DFT using GAMESS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optimization-and-dmc-calculations-with-dft-wavefunctions">Optimization and DMC calculations with DFT wavefunctions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#exercise-3-multideterminant-wavefunctions">Exercise #3: Multideterminant wavefunctions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#generation-of-a-cisd-wavefunctions-using-gamess">Generation of a CISD wavefunctions using GAMESS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optimization-of-a-multideterminant-wavefunction">Optimization of a multideterminant wavefunction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cisd-casci-and-soci">CISD, CASCI, and SOCI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#appendix-a-gamess-input">Appendix A: GAMESS input</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hf-input">HF input</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dft-calculations">DFT calculations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mcscf">MCSCF</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ci">CI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#guga-unitary-group-ci-package">GUGA: Unitary group CI package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#guga-mcscf">GUGA-MCSCF</a></li>
<li class="toctree-l4"><a class="reference internal" href="#guga-casci">GUGA-CASCI</a></li>
<li class="toctree-l4"><a class="reference internal" href="#guga-truncated-ci">GUGA-truncated CI</a></li>
<li class="toctree-l4"><a class="reference internal" href="#guga-soci">GUGA-SOCI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ecp">ECP</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#appendix-b-convert4qmc">Appendix B: convert4qmc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#useful-notes">Useful notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#appendix-c-wavefunction-optimization-xml-block">Appendix C: Wavefunction optimization XML block</a></li>
<li class="toctree-l2"><a class="reference internal" href="#appendix-d-vmc-and-dmc-xml-block">Appendix D: VMC and DMC XML block</a></li>
<li class="toctree-l2"><a class="reference internal" href="#appendix-e-wavefunction-xml-block">Appendix E: Wavefunction XML block</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="lab_condensed_matter.html">Lab 4: Condensed Matter Calculations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">QMCPACK Manual</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Lab 3: Advanced molecular calculations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/lab_advanced_molecules.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="lab-3-advanced-molecular-calculations">
<span id="lab-advanced-molecules"></span><h1>Lab 3: Advanced molecular calculations<a class="headerlink" href="#lab-3-advanced-molecular-calculations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="topics-covered-in-this-lab">
<h2>Topics covered in this lab<a class="headerlink" href="#topics-covered-in-this-lab" title="Permalink to this headline">¶</a></h2>
<p>This lab covers molecular QMC calculations with wavefunctions of increasing sophistication.  All of the trial wavefunctions are initially generated with the GAMESS code.  Topics covered include:</p>
<ul class="simple">
<li><p>Generating single-determinant trial wavefunctions with GAMESS (HF and
DFT)</p></li>
<li><p>Generating multideterminant trial wavefunctions with GAMESS (CISD,
CASCI, and SOCI)</p></li>
<li><p>Optimizing wavefunctions (Jastrow factors and CSF coefficients) with
QMC</p></li>
<li><p>DMC time step and walker population convergence studies</p></li>
<li><p>Systematic progressions of Jastrow factors in VMC</p></li>
<li><p>Systematic convergence of DMC energies with multideterminant
wavefunctions</p></li>
<li><p>Influence of orbitals basis choice on DMC energy</p></li>
</ul>
</div>
<div class="section" id="lab-directories-and-files">
<h2>Lab directories and files<a class="headerlink" href="#lab-directories-and-files" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>abs/lab3_advanced_molecules/exercises
│
├── ex1_first-run-hartree-fock    - basic work flow from Hatree-Fock to DMC
│   ├── gms                        - Hatree-Fock calculation using GAMESS
│   │   ├── h2o.hf.inp               - GAMESS input
│   │   ├── h2o.hf.dat               - GAMESS punch file containing orbitals
│   │   └── h2o.hf.out               - GAMESS output with orbitals and other info
│   ├── convert                    - Convert GAMESS wavefunction to QMCPACK format
│   │   ├── h2o.hf.out               - GAMESS output
│   │   ├── h2o.ptcl.xml             - converted particle positions
│   │   └── h2o.wfs.xml              - converted wave function
│   ├── opt                        - VMC optimization
│   │   └── optm.xml                 - QMCPACK VMC optimization input
│   ├── dmc_timestep               - Check DMC timestep bias
│   │   └── dmc_ts.xml               - QMCPACK DMC input
│   └── dmc_walkers                - Check DMC population control bias
│       └── dmc_wk.xml               - QMCPACK DMC input template
│
├── ex2_slater-jastrow-wf-options - explore jastrow and orbital options
│   ├── jastrow                    - Jastrow options
│   │   ├── 12j                      - no 3-body Jastrow
│   │   ├── 1j                       - only 1-body Jastrow
│   │   └── 2j                       - only 2-body Jastrow
│   └── orbitals                   - Orbital options
│       ├── pbe                      - PBE orbitals
│       │   └── gms                    - DFT calculation using GAMESS
│       │      └── h2o.pbe.inp          - GAMESS DFT input
│       ├── pbe0                     - PBE0  orbitals
│       ├── blyp                     - BLYP  orbitals
│       └── b3lyp                    - B3LYP orbitals
│
├── ex3_multi-slater-jastrow
│   ├── cisd                      - CISD wave function
│   │   ├── gms                     - CISD calculation using GAMESS
│   │   │   ├── h2o.cisd.inp           - GAMESS input
│   │   │   ├── h2o.cisd.dat           - GAMESS punch file containing orbitals
│   │   │   └── h2o.cisd.out           - GAMESS output with orbitals and other info
│   │   └── convert                 - Convert GAMESS wavefunction to QMCPACK format
│   │      └── h2o.hf.out             - GAMESS output
│   ├── casci                     - CASCI wave function
│   │   └── gms                     - CASCI calculation using GAMESS
│   └── soci                      - SOCI wave function
│       ├── gms                     - SOCI calculation using GAMESS
│       ├── thres0.01               - VMC optimization with few determinants
│       └── thres0.0075             - VMC optimization with more determinants
│
└── pseudo
    ├── H.BFD.gamess             - BFD pseudopotential for H in GAMESS format
    ├── O.BFD.CCT.gamess         - BFD pseudopotential for O in GAMESS format
    ├── H.xml                    - BFD pseudopotential for H in QMCPACK format
    └── O.xml                    - BFD pseudopotential for H in QMCPACK format
</pre></div>
</div>
</div>
<div class="section" id="exercise-1-basics">
<h2>Exercise #1: Basics<a class="headerlink" href="#exercise-1-basics" title="Permalink to this headline">¶</a></h2>
<p>The purpose of this exercise is to show how to generate wavefunctions for QMCPACK
using GAMESS and to optimize the resulting wavefunctions using VMC. This will be
followed by a study of the time step and walker population dependence of DMC energies.
The exercise will be performed on a water molecule at the equilibrium geometry.</p>
</div>
<div class="section" id="generation-of-a-hartree-fock-wavefunction-with-gamess">
<h2>Generation of a Hartree-Fock wavefunction with GAMESS<a class="headerlink" href="#generation-of-a-hartree-fock-wavefunction-with-gamess" title="Permalink to this headline">¶</a></h2>
<p>From the top directory, go to “<code class="docutils literal notranslate"><span class="pre">ex1_first-run-hartree-fock/gms</span></code>.” This
directory contains an input file for a HF calculation of a water
molecule using BFD ECPs and the corresponding cc-pVTZ basis set. The
input file should be named: “h2o.hf.inp.” Study the input file. See
Section <a class="reference internal" href="#lab-adv-mol-gamess"><span class="std std-ref">Appendix A: GAMESS input</span></a>, “Appendix A: GAMESS input” for a
more detailed description of the GAMESS input syntax. However, there
will be a better time to do this soon, so we recommend continuing with
the exercise at this point. After you are done, execute GAMESS with this
input and store the standard output in a file named “h2o.hf.output.”
Finally, in the “convert” folder, use <code class="docutils literal notranslate"><span class="pre">convert4qmc</span></code> to generate the
QMCPACK <code class="docutils literal notranslate"><span class="pre">particleset</span></code> and <code class="docutils literal notranslate"><span class="pre">wavefunction</span></code> files. It is always useful
to rename the files generated by <code class="docutils literal notranslate"><span class="pre">convert4qmc</span></code> to something meaningful
since by default they are called <code class="docutils literal notranslate"><span class="pre">sample.Gaussian-G2.xml</span></code> and
<code class="docutils literal notranslate"><span class="pre">sample.Gaussian-G2.ptcl.xml</span></code>. In a standard computer (without
cross-compilation), these tasks can be accomplished by the following
commands.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd ${TRAINING TOP}/ex1_first-run-hartree-fock/gms
jobrun_vesta rungms h2o.hf
cd ../convert
cp ../gms/h2o.hf.output
jobrun_vesta convert4qmc -gamessAscii h2o.hf.output -add3BodyJ
mv sample.Gaussian-G2.xml h2o.wfs.xml
mv sample.Gaussian-G2.ptcl.xml h2o.ptcl.xml
</pre></div>
</div>
<p>The HF energy of the
system is -16.9600590022 Ha. To search for the energy in the output file quickly, you can
use</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grep</span> <span class="s2">&quot;TOTAL ENERGY =&quot;</span> <span class="n">h2o</span><span class="o">.</span><span class="n">hf</span><span class="o">.</span><span class="n">output</span>
</pre></div>
</div>
<p>As the job runs on VESTA, it is a good time to review
Section :ref`lab-adv-mol-convert4qmc`, “Appendix B: convert4qmc,”
which contains a description on the use of the converter.</p>
<div class="section" id="optimize-the-wavefunction">
<h3>Optimize the wavefunction<a class="headerlink" href="#optimize-the-wavefunction" title="Permalink to this headline">¶</a></h3>
<p>When execution of the previous steps is completed, there should be two
new files called <code class="docutils literal notranslate"><span class="pre">h2o.wfs.xml</span></code> and <code class="docutils literal notranslate"><span class="pre">h2o.ptcl.xml</span></code>. Now we will use
VMC to optimize the Jastrow parameters in the wavefunction. From the top
directory, go to “<code class="docutils literal notranslate"><span class="pre">ex1_first-run-hartree-fock/opt</span></code>.” Copy the xml
files generated in the previous step to the current directory. This
directory should already contain a basic QMCPACK input file for an
optimization calculation (<code class="docutils literal notranslate"><span class="pre">optm.xml</span></code>) Open <code class="docutils literal notranslate"><span class="pre">optm.xml</span></code> with your
favorite text editor and modify the name of the files that contain the
<code class="docutils literal notranslate"><span class="pre">wavefunction</span></code> and <code class="docutils literal notranslate"><span class="pre">particleset</span></code> XML blocks. These files are
included with the commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">include</span> <span class="n">href</span><span class="o">=</span><span class="n">ptcl</span><span class="o">.</span><span class="n">xml</span><span class="o">/&gt;</span>
<span class="o">&lt;</span><span class="n">include</span> <span class="n">href</span><span class="o">=</span><span class="n">wfs</span><span class="o">.</span><span class="n">xml</span><span class="o">/&gt;</span>
</pre></div>
</div>
<p>(the particle set must be defined before the wavefunction). The name of
the particle set and wavefunction files should now be <code class="docutils literal notranslate"><span class="pre">h2o.ptcl.xml</span></code>
and <code class="docutils literal notranslate"><span class="pre">h2o.wfs.xml</span></code>, respectively. Study both files and submit when you
are ready. Notice that the location of the ECPs has been set for you; in
your own calculations you have to make sure you obtain the ECPs from the
appropriate libraries and convert them to QMCPACK format using
ppconvert. While these calculations finish is a good time to study
<a class="reference internal" href="#lab-adv-mol-opt-appendix"><span class="std std-ref">Appendix C: Wavefunction optimization XML block</span></a>, “Appendix C: Wavefunction
optimization XML block,” which contains a review of the main parameters
in the optimization XML block. The previous steps can be accomplished by
the following commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd ${TRAINING TOP}/ex1_first-run-hartree-fock/opt
cp ../convert/h2o.wfs.xml ./
cp ../convert/h2o.ptcl.xml ./
# edit optm.xml to include the correct ptcl.xml and wfs.xml
jobrun_vesta qmcpack optm.xml
</pre></div>
</div>
<p>Use the analysis tool <code class="docutils literal notranslate"><span class="pre">qmca</span></code> to analyze the results of the
calculation. Obtain the VMC energy and variance for each step in the
optimization and plot it using your favorite program. Remember that
<code class="docutils literal notranslate"><span class="pre">qmca</span></code> has built-in functions to plot the analyzed data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">qmca</span> <span class="o">-</span><span class="n">q</span> <span class="n">e</span> <span class="o">*</span><span class="n">scalar</span><span class="o">.</span><span class="n">dat</span> <span class="o">-</span><span class="n">p</span>
</pre></div>
</div>
<p>The resulting energy as a function of the optimization step should look
qualitatively similar to <a class="reference internal" href="#fig17"><span class="std std-numref">Fig. 17</span></a>. The energy should
decrease quickly as a function of the number of optimization steps.
After 6–8 steps, the energy should be converged to <span class="math notranslate nohighlight">\(\sim\)</span>2–3
mHa. To improve convergence, we would need to increase the number of
samples used during optimization (You can check this for yourself
later.). With optimized wavefunctions, we are in a position to perform
VMC and DMC calculations. The modified wavefunction files after each
step are written in a file named <code class="docutils literal notranslate"><span class="pre">ID.sNNN.opt.xml</span></code>, where ID is the
identifier of the calculation defined in the input file (this is defined
in the project XML block with parameter “id”) and NNN is a series number
that increases with every executable xml block in the input file.</p>
<div class="figure align-center" id="id1">
<span id="fig17"></span><a class="reference internal image-reference" href="_images/lab_advanced_molecules_opt_conv.png"><img alt="_images/lab_advanced_molecules_opt_conv.png" src="_images/lab_advanced_molecules_opt_conv.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 17 </span><span class="caption-text">VMC energy as a function of optimization step.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="time-step-study">
<h3>Time-step study<a class="headerlink" href="#time-step-study" title="Permalink to this headline">¶</a></h3>
<p>Now we will study the dependence of the DMC energy with time step. From
the top directory, go to “<code class="docutils literal notranslate"><span class="pre">ex1_first-run-hartree-fock/dmc_timestep</span></code>.”
This folder contains a basic XML input file (<code class="docutils literal notranslate"><span class="pre">dmc_ts.xml</span></code>) that
performs a short VMC calculation and three DMC calculations with varying
time steps (0.1, 0.05, 0.01). Link the <code class="docutils literal notranslate"><span class="pre">particleset</span></code> and the last
<code class="docutils literal notranslate"><span class="pre">optimization</span></code> file from the previous folder (the file called
<code class="docutils literal notranslate"><span class="pre">jopt-h2o.sNNN.opt.xml</span></code> with the largest value of NNN). Rename the
optimized <code class="docutils literal notranslate"><span class="pre">wavefunction</span></code> file to any suitable name if you wish (for
example, <code class="docutils literal notranslate"><span class="pre">h2o.opt.xml</span></code>) and change the name of the <code class="docutils literal notranslate"><span class="pre">particleset</span></code> and
<code class="docutils literal notranslate"><span class="pre">wavefunction</span></code> files in the input file. An optimized wavefunction can
be found in the reference files (same location) in case it is needed.</p>
<p>The main steps needed to perform this exercise are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd \$\{TRAINING TOP\}/ex1_first-run-hartree-fock/dmc_timestep
cp ../opt/h2o.ptcl.xml ./
cp ../opt/jopt-h2o.s007.opt.xml h2o.opt.wfs.xml
# edit dmc_ts.xml to include the correct ptcl.xml and wfs.xml
jobrun_vesta qmcpack dmc_ts.xml
</pre></div>
</div>
<p>While these runs complete, go to
<a class="reference internal" href="#lab-adv-mol-vmcdmc-appendix"><span class="std std-ref">Appendix D: VMC and DMC XML block</span></a>, “Appendix D: VMC and DMC
XML block,” and review the basic VMC and DMC input blocks. Notice that
in the current DMC blocks the time step is decreased as the number of
blocks is increased. Why is this?</p>
<p>When the simulations are finished, use <code class="docutils literal notranslate"><span class="pre">qmca</span></code> to analyze the output
files and plot the DMC energy as a function of time step. Results should
be qualitatively similar to those presented in
<a class="reference internal" href="#fig18"><span class="std std-numref">Fig. 18</span></a>; in this case we present more time
steps with well converged results to better illustrate the time step
dependence. In realistic calculations, the time step must be chosen
small enough so that the resulting error is below the desired accuracy.
Alternatively, various calculations can be performed and the results
extrapolated to the zero time-step limit.</p>
<div class="figure align-center" id="id2">
<span id="fig18"></span><a class="reference internal image-reference" href="_images/lab_advanced_molecules_dmc_timestep.png"><img alt="_images/lab_advanced_molecules_dmc_timestep.png" src="_images/lab_advanced_molecules_dmc_timestep.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 18 </span><span class="caption-text">DMC energy as a function of time step.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="walker-population-study">
<h3>Walker population study<a class="headerlink" href="#walker-population-study" title="Permalink to this headline">¶</a></h3>
<p>Now we will study the dependence of the DMC energy with the number of
walkers in the simulation. Remember that, in principle, the DMC
distribution is reached in the limit of an infinite number of walkers.
In practice, the energy and most properties converge to high accuracy
with <span class="math notranslate nohighlight">\(\sim\)</span>100–1,000 walkers. The actual number of walkers
needed in a calculation will depend on the accuracy of the VMC
wavefunction and on the complexity and size of the system. Also notice
that using too many walkers is not a problem; at worse it will be
inefficient since it will cost more computer time than necessary. In
fact, this is the strategy used when running QMC calculations on large
parallel computers since we can reduce the statistical error bars
efficiently by running with large walker populations distributed across
all processors.</p>
<p>From the top directory, go to
“<code class="docutils literal notranslate"><span class="pre">ex1_first-run-hartree-fock/dmc_walkers</span></code>.” Copy the optimized
<code class="docutils literal notranslate"><span class="pre">wavefunction</span></code> and <code class="docutils literal notranslate"><span class="pre">particleset</span></code> files used in the previous
calculations to the current folder; these are the files generated during
step 2 of this exercise. An optimized <code class="docutils literal notranslate"><span class="pre">wavefunction</span></code> file can be found
in the reference files (same location) in case it is needed. The
directory contains a sample DMC input file and submission script. Create
three directories named NWx, with x values of 120,240,480, and copy the
input file to each one. Go to “NW120,” and, in the input file, change
the name of the <code class="docutils literal notranslate"><span class="pre">wavefunction</span></code> and <code class="docutils literal notranslate"><span class="pre">particleset</span></code> files (in this case
they will be located one directory above, so use
“<code class="docutils literal notranslate"><span class="pre">../dmc_timestep/h2.opt.xml</span></code>,” for example); change the PP directory
so that it points to one directory above; change “targetWalkers” to 120;
and change the number of steps to 100, the time step to 0.01, and the
number of blocks to 400. Notice that “targetWalkers” is one way to set
the desired (average) number of walkers in a DMC calculation. One can
alternatively set “samples” in the <code class="docutils literal notranslate"><span class="pre">&lt;qmc</span> <span class="pre">method=&quot;vmc&quot;</span></code> block to carry over de-correlated VMC
configurations as DMC walkers. For your own simulations, we generally
recommend setting <span class="math notranslate nohighlight">\(\sim\)</span>2*(#threads) walkers per node (slightly
smaller than this value).</p>
<p>The main steps needed to perform this exercise are</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd ${TRAINING TOP}/ex1_first-run-hartree-fock/dmc_walkers
cp ../opt/h2o.ptcl.xml ./
cp ../opt/jopt-h2o.s007.opt.xml h2o.opt.wfs.xml
# edit dmc_wk.xml to include the correct ptcl.xml and wfs.xml and
#  use the correct pseudopotential directory
mkdir NW120
cp dmc_wk.xml NW120
# edit dmc_wk.xml to use the desired number of walkers,
#  and collect the desired amount of statistics
jobrun_vesta qmcpack dmc_wk.xml
# repeat for NW240, NW480
</pre></div>
</div>
<p>Repeat the same procedure in the other folders by setting
(targetWalkers=240, steps=100, timestep=0.01, blocks=200) in NW240 and
(targetWalkers=480, steps=100, timestep=0.01, blocks=100) in NW480. When
the simulations complete, use <code class="docutils literal notranslate"><span class="pre">qmca</span></code> to analyze and plot the energy as
a function of the number of walkers in the calculation. As always,
<a class="reference internal" href="#fig19"><span class="std std-numref">Fig. 19</span></a> shows representative results of the
energy dependence on the number of walkers for a single water molecule.
As shown, less than 240 walkers are needed to obtain an accuracy of 0.1
mHa.</p>
<div class="figure align-center" id="id3">
<span id="fig19"></span><a class="reference internal image-reference" href="_images/lab_advanced_molecules_dmc_popcont.png"><img alt="_images/lab_advanced_molecules_dmc_popcont.png" src="_images/lab_advanced_molecules_dmc_popcont.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 19 </span><span class="caption-text">DMC energy as a function of the average number of walkers.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
<div class="section" id="exercise-2-slater-jastrow-wavefunction-options">
<h2>Exercise #2: Slater-Jastrow wavefunction options<a class="headerlink" href="#exercise-2-slater-jastrow-wavefunction-options" title="Permalink to this headline">¶</a></h2>
<p>From this point on in the tutorial we assume familiarity with the basic
parameters in the optimization, VMC, and DMC XML input blocks of
QMCPACK. In addition, we assume familiarity with the submission system.
As a result, the folder structure will not contain any prepared input or
submission files, so you will need to generate them using input files
from exercise 1. In the case of QMCPACK sample files, you will find
<code class="docutils literal notranslate"><span class="pre">optm.xml</span></code>, <code class="docutils literal notranslate"><span class="pre">vmc</span> <span class="pre">dmc.xml</span></code>, and <code class="docutils literal notranslate"><span class="pre">submit.csh</span> <span class="pre">files</span></code>. Some of the
options in these files can be left unaltered, but many of them will need
to be tailored to the particular calculation.</p>
<p>In this exercise we will study the dependence of the DMC energy on the
choices made in the wavefunction ansatz. In particular, we will study
the influence/dependence of the VMC energy with the various terms in the
Jastrow. We will also study the influence of the VMC and DMC energies on
the SPOs used to form the Slater determinant in single-determinant
wavefunctions. For this we will use wavefunctions generated with various
exchange-correlation functionals in DFT. Finally, we will optimize a
simple multideterminant wavefunction and study the dependence of the
energy on the number of configurations used in the expansion. All of
these exercises will be performed on the water molecule at equilibrium.</p>
<div class="section" id="influence-of-jastrow-on-vmc-energy-with-hf-wavefunction">
<h3>Influence of Jastrow on VMC energy with HF wavefunction<a class="headerlink" href="#influence-of-jastrow-on-vmc-energy-with-hf-wavefunction" title="Permalink to this headline">¶</a></h3>
<p>In this section we will study the dependence of the VMC energy on the
various Jastrow terms (e.g., 1-body, 2-body and 3-body. From the top
directory, go to “<code class="docutils literal notranslate"><span class="pre">ex2_slater-jastrow-wf-options/jastrow.”</span></code> We will
compare the single-determinant VMC energy using a 2-body Jastrow term,
both 1- and 2-body terms, and finally 1-, 2- and 3-body terms. Since we
are interested in the influence of the Jastrow, we will use the HF
orbitals calculated in exercise #1. Make three folders named 2j, 12j,
and 123j. For both 2j and 12j, copy the input file <code class="docutils literal notranslate"><span class="pre">optm.xml</span></code> from
“<code class="docutils literal notranslate"><span class="pre">ex1_first-run-hartree-fock/opt.</span></code>” This input file performs both
wavefunction optimization and a VMC calculation. Remember to correct
relative paths to the PP directory. Copy the un-optimized HF
<code class="docutils literal notranslate"><span class="pre">wavefunction</span></code> and <code class="docutils literal notranslate"><span class="pre">particleset</span></code> files from
“<code class="docutils literal notranslate"><span class="pre">ex1_first-run-hartree-fock/convert</span></code>”; if you followed the
instructions in exercise #1 these should be named <code class="docutils literal notranslate"><span class="pre">h2o.wfs.xml</span></code> and
<code class="docutils literal notranslate"><span class="pre">h2o.ptcl.xml</span></code>. Otherwise, you can obtained them from the REFERENCE
files. Modify the <code class="docutils literal notranslate"><span class="pre">h2o.wfs.xml</span></code> file to remove the appropriate Jastrow
blocks. For example, for a 2-body Jastrow (only), you need to eliminate
the Jastrow blocks named <code class="docutils literal notranslate"><span class="pre">&lt;jastrow</span> <span class="pre">name=&quot;J1&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;jastrow</span> <span class="pre">name=&quot;J3.&quot;</span></code> In
the case of 12j, remove only <code class="docutils literal notranslate"><span class="pre">&lt;jastrow</span> <span class="pre">name=&quot;J3.&quot;</span></code> Recommended settings
for the optimization run are nodes=32, threads=16, blocks=250,
samples=128000, time-step=0.5, 8 optimization loops. Recommended
settings in the VMC section are walkers=16, blocks=1000, steps=1,
substeps=100. Notice that samples should always be set to blocks*threads
per node*nodes = 32*16*250=128000. Repeat the process in both 2j and 12j
cases. For the 123j case, the wavefunction has already been optimized in
the previous exercise. Copy the optimized HF wavefunction and the
particleset from “<code class="docutils literal notranslate"><span class="pre">ex1_first-run-hartree-fock/opt.</span></code>” Copy the input
file from any of the previous runs and remove the optimization block
from the input, just leave the VMC step. In all three cases, modify the
submission script and submit the run.</p>
<p>Because these simulations will take several minutes to complete, this is
an excellent opportunity to go to
<a class="reference internal" href="#lab-adv-mol-wf-appendix"><span class="std std-ref">Appendix E: Wavefunction XML block</span></a>, “Appendix E: Wavefunction XML
block,” and review the wavefunction XML block used by QMCPACK. When the
simulations are completed, use <code class="docutils literal notranslate"><span class="pre">qmca</span></code> to analyze the output files.
Using your favorite plotting program (e.g., gnu plot), plot the energy
and variance as a function of the Jastrow form.
<a class="reference internal" href="#fig20"><span class="std std-numref">Fig. 20</span></a> shows a typical result for this
calculation. As can be seen, the VMC energy and variance depends
strongly on the form of the Jastrow. Since the DMC error bar is directly
related to the variance of the VMC energy, improving the Jastrow will
always lead to a reduction in the DMC effort. In addition, systematic
approximations (time step, number of walkers, etc.) are also reduced
with improved wavefunctions.</p>
<div class="figure align-center" id="id4">
<span id="fig20"></span><a class="reference internal image-reference" href="_images/lab_advanced_molecules_vmc_jastrow.png"><img alt="_images/lab_advanced_molecules_vmc_jastrow.png" src="_images/lab_advanced_molecules_vmc_jastrow.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 20 </span><span class="caption-text">VMC energy as a function of Jastrow type.</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="generation-of-wavefunctions-from-dft-using-gamess">
<h3>Generation of wavefunctions from DFT using GAMESS<a class="headerlink" href="#generation-of-wavefunctions-from-dft-using-gamess" title="Permalink to this headline">¶</a></h3>
<p>In this section we will use GAMESS to generate wavefunctions for QMCPACK
from DFT calculations. From the top folder, go to
“<code class="docutils literal notranslate"><span class="pre">ex2_slater-jastrow-wf-options/orbitals</span></code>.” To demonstrate the
variation in DMC energies with the choice of DFT orbitals, we will
choose the following set of exchange-correlation functionals (PBE, PBE0,
BLYP, B3LYP). For each functional, make a directory using your preferred
naming convention (e.g., the name of the functional). Go into each
folder and copy a GAMESS input file from
“<code class="docutils literal notranslate"><span class="pre">ex1_first-run-hartree-fock/gms</span></code>.” Rename the file with your
preferred naming convention; we suggest using <code class="docutils literal notranslate"><span class="pre">h2o.[dft].inp</span></code>, where
[dft] is the name of the functional used in the calculation. At this
point, this input file should be identical to the one used to generate
the HF wavefunction in exercise #1. To perform a DFT calculation we only
need to add “DFTTYP” to the <code class="docutils literal notranslate"><span class="pre">$CONTRL</span> <span class="pre">...</span> <span class="pre">$END</span></code> section and set it to the desired functional
type, for example, “DFTTYP=PBE” for a PBE functional. This variable must
be set to (PBE, PBE0, BLYP, B3LYP) to obtain the appropriate functional
in GAMESS. For a complete list of implemented functionals, see the
GAMESS input manual.</p>
</div>
<div class="section" id="optimization-and-dmc-calculations-with-dft-wavefunctions">
<h3>Optimization and DMC calculations with DFT wavefunctions<a class="headerlink" href="#optimization-and-dmc-calculations-with-dft-wavefunctions" title="Permalink to this headline">¶</a></h3>
<p>In this section we will optimize the wavefunction generated in the
previous step and perform DMC calculations. From the top directory, go
to “<code class="docutils literal notranslate"><span class="pre">ex2_slater-jastrow-wf-options/orbitals</span></code>.” The steps required to
achieve this are identical to those used to optimize the wavefunction
with HF orbitals. Make individual folders for each calculation and
obtain the necessary files to perform optimization, for example, VMC and
DMC calculations from “for <code class="docutils literal notranslate"><span class="pre">ex1_first-run-hartree-fock/opt</span></code>” and
“<code class="docutils literal notranslate"><span class="pre">ex1_first-run-hartree-fock/dmc_ts</span></code>.” For each functional, make the
appropriate modifications to the input files and copy the
<code class="docutils literal notranslate"><span class="pre">particleset</span></code> and <code class="docutils literal notranslate"><span class="pre">wavefunction</span></code> files from the appropriate
directory in “<code class="docutils literal notranslate"><span class="pre">ex2_slater-jastrow-wf-options/orbitals/[dft]</span></code>.” We
recommend the following settings: nodes=32, threads=16, (in
optimization) blocks=250, samples=128000, timestep=0.5, 8 optimization
loops, (in VMC) walkers=16, blocks=100, steps=1, substeps=100, (in DMC)
blocks 400, targetWalkers=960, and timestep=0.01. Submit the runs and
analyze the results using <code class="docutils literal notranslate"><span class="pre">qmca</span></code>.</p>
<p>How do the energies compare against each other? How do they compare
against DMC energies with HF orbitals?</p>
</div>
</div>
<div class="section" id="exercise-3-multideterminant-wavefunctions">
<h2>Exercise #3: Multideterminant wavefunctions<a class="headerlink" href="#exercise-3-multideterminant-wavefunctions" title="Permalink to this headline">¶</a></h2>
<p>In this exercise we will study the dependence of the DMC energy on the set of orbitals
and the type of configurations included in a multideterminant wavefunction.</p>
<div class="section" id="generation-of-a-cisd-wavefunctions-using-gamess">
<h3>Generation of a CISD wavefunctions using GAMESS<a class="headerlink" href="#generation-of-a-cisd-wavefunctions-using-gamess" title="Permalink to this headline">¶</a></h3>
<p>In this section we will use GAMESS to generate a multideterminant
wavefunction with configuration interaction with single and double
excitations (CISD). In CISD, the Schrodinger equation is solved exactly
on a basis of determinants including the HF determinant and all its
single and double excitations.</p>
<p>Go to “<code class="docutils literal notranslate"><span class="pre">ex3_multi-slater-jastrow/cisd/gms</span></code>” and you will see input and
output files named <code class="docutils literal notranslate"><span class="pre">h2o.cisd.inp</span></code> and <code class="docutils literal notranslate"><span class="pre">h2o.cisd.out</span></code>. Because of
technical problems with GAMESS in the BGQ architecture of VESTA, we are
unable to use CISD properly in GAMESS. Consequently, the output of the
calculation is already provided in the directory.</p>
<p>There will be time in the next step to study the GAMESS input files and
the description in <a class="reference internal" href="#lab-adv-mol-gamess"><span class="std std-ref">Appendix A: GAMESS input</span></a>, “Appendix A:
GAMESS input.” Since the output is already provided, the only action
needed is to use the converter to generate the appropriate QMCPACK
files.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jobrun_vesta</span> <span class="n">convert4qmc</span> <span class="n">h2o</span><span class="o">.</span><span class="n">cisd</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">ci</span> <span class="n">h2o</span><span class="o">.</span><span class="n">cisd</span><span class="o">.</span><span class="n">out</span> \
<span class="o">-</span><span class="n">readInitialGuess</span> <span class="mi">57</span> <span class="o">-</span><span class="n">threshold</span> <span class="mf">0.0075</span>
</pre></div>
</div>
<p>We used the PRTMO=.T. flag in the GUESS section to include orbitals in
the output file. You should read these orbitals from the output
(-readInitialGuess 40). The highest occupied orbital in any determinant
should be 34, so reading 40 orbitals is a safe choice. In this case, it
is important to rename the XML files with meaningful names, for example,
<code class="docutils literal notranslate"><span class="pre">h2o.cisd.wfs.xml</span></code>. A threshold of 0.0075 is sufficient for the
calculations in the training.</p>
</div>
<div class="section" id="optimization-of-a-multideterminant-wavefunction">
<h3>Optimization of a multideterminant wavefunction<a class="headerlink" href="#optimization-of-a-multideterminant-wavefunction" title="Permalink to this headline">¶</a></h3>
<p>In this section we will optimize the wavefunction generated in the
previous step. There is no difference in the optimization steps if a
single determinant and a multideterminant wavefunction. QMCPACK will
recognize the presence of a multideterminant wavefunction and will
automatically optimize the linear coefficients by default. Go to
“<code class="docutils literal notranslate"><span class="pre">ex3_multi-slater-jastrow/cisd</span></code>” and make a folder called
<code class="docutils literal notranslate"><span class="pre">thres0.01</span></code>. Copy the <code class="docutils literal notranslate"><span class="pre">particleset</span></code> and <code class="docutils literal notranslate"><span class="pre">wavefunction</span></code> files
created in the previous step to the current directory. With your
favorite text editor, open the <code class="docutils literal notranslate"><span class="pre">wavefunction</span></code> file <code class="docutils literal notranslate"><span class="pre">h2o.wfs.xml</span></code>.
Look for the multideterminant XML block and change the “cutoff”
parameter in detlist to 0.01. Then follow the same steps used in Section
9.4.3, “Optimization and DMC calculations with DFT wavefunctions” to
optimize the wavefunction. Similar to this case, design a QMCPACK input
file that performs wavefunction optimization followed by VMC and DMC
calculations. Submit the calculation.</p>
<p>This is a good time to review the GAMESS input file description in
<a class="reference internal" href="#lab-adv-mol-gamess"><span class="std std-ref">Appendix A: GAMESS input</span></a>, “Appendix A. GAMESS input.” When
the run is completed, go to the previous directory and make a new folder
named <code class="docutils literal notranslate"><span class="pre">thres0.0075</span></code>. Repeat the previous steps to optimize the
wavefunction with a cutoff of 0.01, but use a cutoff of 0.0075 this
time. This will increase the number of determinants used in the
calculation. Notice that the “cutoff” parameter in the XML should be
less than the “-threshold 0.0075” flag passed to the converted, which is
further bounded by the PRTTOL flag in the GAMESS input.</p>
<p>After the wavefunction is generated, we are ready to optimize. Instead of starting from an un-optimized wavefunction, we can start from the optimized wavefunction from thres0.01 to speed up convergence. You will need to modify the file and change the cutoff in detlist to 0.0075 with a text editor. Repeat the optimization steps and submit the calculation.</p>
<p>When you are done, use <code class="docutils literal notranslate"><span class="pre">qmca</span></code> to analyze the results. Compare the energies at these two
coefficient cutoffs with the energies obtained with DFT orbitals. Because of the time limitations of this tutorial, it is not practical to optimize the wavefunctions with a smaller cutoff since this would require more samples and longer runs due to the larger number of optimizable parameters. <a class="reference internal" href="#fig21"><span class="std std-numref">Fig. 21</span></a> shows the results of such exercise: the DMC energy as a function of the cutoff in the wavefunction. As can be seen, a large improvement in the energy is obtained as the number of configurations is increased.</p>
<div class="figure align-center" id="id5">
<span id="fig21"></span><a class="reference internal image-reference" href="_images/lab_advanced_molecules_dmc_ci_cisd.png"><img alt="_images/lab_advanced_molecules_dmc_ci_cisd.png" src="_images/lab_advanced_molecules_dmc_ci_cisd.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 21 </span><span class="caption-text">DMC energy as a function of the sum of the square of CI coefficients from CISD.</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="cisd-casci-and-soci">
<h3>CISD, CASCI, and SOCI<a class="headerlink" href="#cisd-casci-and-soci" title="Permalink to this headline">¶</a></h3>
<p>Go to “<code class="docutils literal notranslate"><span class="pre">ex3_multi-slater-jastrow</span></code>” and inspect the folders for the
remaining wavefunction types: CASCI and SOCI. Follow the steps in the
previous exercise and obtain the optimized wavefunctions for these
determinant choices. Notice that the SOCI GAMESS output is not included
because it is large. Already converted XML inputs can be found in
“<code class="docutils literal notranslate"><span class="pre">ex3_multi-slater-jastrow/soci/thres*</span></code>.”</p>
<p>A CASCI wavefunction is produced from a CI calculation that includes all
the determinants in a complete active space (CAS) calculation, in this
case using the orbitals from a previous CASSCF calculation. In this case
we used a CAS(8,8) active space that includes all determinants generated
by distributing 8 electrons in the lowest 8 orbitals. A SOCI calculation
is similar to the CAS-CI calculation, but in addition to the
determinants in the CAS it also includes all single and double
excitations from all of them, leading to a much larger determinant set.
Since you now have considerable experience optimizing wavefunctions and
calculating DMC energies, we will leave it to you to complete the
remaining tasks on your own. If you need help, refer to previous
exercises in the tutorial. Perform optimizations for both wavefunctions
using cutoffs in the CI expansion of 0.01 an 0.0075. If you have time,
try to optimize the wavefunctions with a cutoff of 0.005. Analyze the
results and plot the energy as a function of cutoff for all three cases:
CISD, CAS-CI, and SOCI.</p>
<p><a class="reference internal" href="#fig21"><span class="std std-numref">Fig. 21</span></a> shows the result of similar calculations using more samples and smaller cutoffs.
The results should be similar to those produced in the tutorial. For reference, the exact
energy of the water molecule with ECPs is approximately -17.276 Ha. From the results of the
tutorial, how does the selection of determinants relate to the expected DMC energy?
What about the choice in the set of orbitals?</p>
</div>
</div>
<div class="section" id="appendix-a-gamess-input">
<span id="lab-adv-mol-gamess"></span><h2>Appendix A: GAMESS input<a class="headerlink" href="#appendix-a-gamess-input" title="Permalink to this headline">¶</a></h2>
<p>In this section we provide a brief description of the GAMESS input needed to produce
trial wavefunction for QMC calculations with QMCPACK. We assume basic familiarity
with GAMESS input structure, particularly regarding the input of atomic coordinates and
the definition of Gaussian basis sets. This section focuses on generation of the output
files needed by the converter tool, <code class="docutils literal notranslate"><span class="pre">convert4qmc</span></code>. For a description of the converter, see <a class="reference internal" href="#lab-adv-mol-convert4qmc"><span class="std std-ref">Appendix B: convert4qmc</span></a>, “Appendix B: convert4qmc.”</p>
<p>Only a subset of the methods available in GAMESS can be used to generate
wavefunctions for QMCPACK, and we restrict our description to these. For
a complete description of all the options and methods available in
GAMESS, please refer to the official documentation at
“<a class="reference external" href="http://www.msg.ameslab.gov/gamess/documentation.html">http://www.msg.ameslab.gov/gamess/documentation.html</a>.”</p>
<p>Currently, <code class="docutils literal notranslate"><span class="pre">convert4qmc</span></code> can process output for the following methods in GAMESS (in
SCFTYP): RHF, ROHF, and MCSCF. Both HF and DFT calculations (any DFT
type) can be used in combination with RHF and ROHF calculations. For MCSCF and CI
calculations, ALDET, ORMAS, and GUGA drivers can be used (details follow).</p>
<div class="section" id="hf-input">
<h3>HF input<a class="headerlink" href="#hf-input" title="Permalink to this headline">¶</a></h3>
<p>The following input will perform a restricted HF calculation on a closed-shell singlet
(multiplicity=1). This will generate RHF orbitals for any molecular system defined in
<code class="docutils literal notranslate"><span class="pre">$DATA</span> <span class="pre">...</span> <span class="pre">$END</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$CONTRL SCFTYP=RHF RUNTYP=ENERGY MULT=1
ISPHER=1 EXETYP=RUN COORD=UNIQUE MAXIT=200 $END
$SYSTEM MEMORY=150000000 $END
$GUESS GUESS=HUCKEL $END
$SCF DIRSCF=.TRUE. $END
$DATA
...
Atomic Coordinates and basis set
...
$END
</pre></div>
</div>
<p>Main options:</p>
<ol class="arabic simple">
<li><p>SCFTYP: Type of SCF method, options: RHF, ROHF, MCSCF, UHF and NONE.</p></li>
<li><p>RUNTYP: Type of run. For QMCPACK wavefunction generation this should
always be ENERGY.</p></li>
<li><p>MULT: Multiplicity of the molecule.</p></li>
<li><p>ISPHER: Use spherical harmonics (1) or Cartesian basis functions
(-1).</p></li>
<li><p>COORD: Input structure for the atomic coordinates in $DATA.</p></li>
</ol>
</div>
<div class="section" id="dft-calculations">
<h3>DFT calculations<a class="headerlink" href="#dft-calculations" title="Permalink to this headline">¶</a></h3>
<p>The main difference between the input for a RHF/ROHF calculation and a DFT calculation
is the definition of the DFTTYP parameter. If this is set in the $CONTROL
section, a DFT calculation will be performed with the appropriate functional. Notice that
although the default values are usually adequate, DFT calculations have many options involving
the integration grids and accuracy settings. Make sure you study the input manual to be
aware of these. Refer to the input manual for a list of the implemented exchange-correlation
functionals.</p>
</div>
<div class="section" id="mcscf">
<h3>MCSCF<a class="headerlink" href="#mcscf" title="Permalink to this headline">¶</a></h3>
<p>MCSCF calculations are performed by setting SCFTYP=MCSCF in the CONTROL
section. If this option is set, an MCSCF section must be added to the input file with the
options for the calculation. An example section for the water molecule used in the tutorial
follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$MCSCF CISTEP=GUGA MAXIT=1000 FULLNR=.TRUE. ACURCY=1.0D-5 $END
</pre></div>
</div>
<p>The most important parameter is CISTEP, which defines the CI package used. The only
options compatible with QMCPACK are: ALDET, GUGA, and ORMAS. Depending on the
package used, additional input sections are needed.</p>
</div>
<div class="section" id="ci">
<h3>CI<a class="headerlink" href="#ci" title="Permalink to this headline">¶</a></h3>
<p>Configuration interaction (full CI, truncated CI, CAS-CI, etc) calculations are performed
by setting <code class="docutils literal notranslate"><span class="pre">SCFTYP=NONE</span></code> and <code class="docutils literal notranslate"><span class="pre">CITYP=GUGA,ALDET,ORMAS</span></code>. Each one of these packages
requires further input sections, which are typically slightly different from the input sections
needed for MCSCF runs.</p>
</div>
<div class="section" id="guga-unitary-group-ci-package">
<h3>GUGA: Unitary group CI package<a class="headerlink" href="#guga-unitary-group-ci-package" title="Permalink to this headline">¶</a></h3>
<p>The GUGA package is the only alternative if one wants CSFs with GAMESS. We subsequently provide a very brief description of the input sections needed to perform MCSCF, CASCI,
truncated CI, and SOCI with this package. For a complete description of these methods and
all the options available, please refer to the GAMESS input manual.</p>
<div class="section" id="guga-mcscf">
<h4>GUGA-MCSCF<a class="headerlink" href="#guga-mcscf" title="Permalink to this headline">¶</a></h4>
<p>The following input section performs a CASCI calculation with a CAS that includes 8
electrons in 8 orbitals (4 DOC and 4 VAL), for example, CAS(8,8). NMCC is the number of frozen
orbitals (doubly occupied orbitals in all determinants), NDOC is the number of double
occupied orbitals in the reference determinant, NVAL is the number of singly occupied
orbitals in the reference (for spin polarized cases), and NVAL is the number of orbitals in
the active space. Since FORS is set to .TRUE., all configurations in the active space will
be included. ISTSYM defines the symmetry of the desired state.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$MCSCF CISTEP=GUGA MAXIT=1000 FULLNR=.TRUE. ACURCY=1.0D-5 $END
$DRT GROUP=C2v NMCC=0 NDOC=4 NALP=0 NVAL=4 ISTSYM=1 MXNINT= 500000 FORS=.TRUE. $END
</pre></div>
</div>
</div>
<div class="section" id="guga-casci">
<h4>GUGA-CASCI<a class="headerlink" href="#guga-casci" title="Permalink to this headline">¶</a></h4>
<p>The following input section performs a CASCI calculation with a CAS that includes 8
electrons in 8 orbitals (4 DOC and 4 VAL), for example, CAS(8,8). NFZC is the number of frozen
orbitals (doubly occupied orbitals in all determinants). All other parameters are identical
to those in the MCSCF input section.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$CIDRT GROUP=C2v NFZC=0 NDOC=4 NALP=0 NVAL=4 NPRT=2 ISTSYM=1 FORS=.TRUE. MXNINT= 500000 $END
$GUGDIA PRTTOL=0.001 CVGTOL=1.0E-5 ITERMX=1000 $END
</pre></div>
</div>
</div>
<div class="section" id="guga-truncated-ci">
<h4>GUGA-truncated CI<a class="headerlink" href="#guga-truncated-ci" title="Permalink to this headline">¶</a></h4>
<p>The following input sections will lead to a truncated CI calculation. In this particular case
it will perform a CISD calculation since IEXCIT is set to 2. Other values in IEXCIT will lead
to different CI truncations; for example, IEXCIT=4 will lead to CISDTQ. Notice that only
the lowest 30 orbitals will be included in the generation of the excited determinants in this
case. For a full CISD calculation, NVAL should be set to the total number of virtual orbitals.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$CIDRT GROUP=C2v NFZC=0 NDOC=4 NALP=0 NVAL=30 NPRT=2 ISTSYM=1 IEXCIT=2 MXNINT= 500000 $END
$GUGDIA PRTTOL=0.001 CVGTOL=1.0E-5 ITERMX=1000 $END
</pre></div>
</div>
</div>
<div class="section" id="guga-soci">
<h4>GUGA-SOCI<a class="headerlink" href="#guga-soci" title="Permalink to this headline">¶</a></h4>
<p>The following input section performs a SOCI calculation with a CAS that includes 8
electrons in 8 orbitals (4 DOC and 4 VAL), for example, CAS(8,8). Since SOCI is set to .TRUE.,
all single and double determinants from all determinants in the CAS(8,8) will be included.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$CIDRT GROUP=C2v NFZC=0 NDOC=4 NALP=0 NVAL=4 NPRT=2 ISTSYM=1 SOCI=.TRUE. NEXT=30 MXNINT= 500000 $END
$GUGDIA PRTTOL=0.001 CVGTOL=1.0E-5 ITERMX=1000 $END
</pre></div>
</div>
</div>
</div>
<div class="section" id="ecp">
<h3>ECP<a class="headerlink" href="#ecp" title="Permalink to this headline">¶</a></h3>
<p>To use ECPs in GAMESS, you must define a <code class="docutils literal notranslate"><span class="pre">{$ECP</span> <span class="pre">...</span> <span class="pre">$END}</span></code>
block. There must be a definition of a potential for every atom in the system, including
symmetry equivalent ones. In addition, they must appear in the particular order expected
by GAMESS. The following example shows an ECP input block for a single water molecule using
BFD ECPs. To turn on the use of ECPs, the option “ECP=READ” must be added to the
CONTROL input block.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ECP
O-QMC GEN 2 1
3
6.00000000 1 9.29793903
55.78763416 3 8.86492204
-38.81978498 2 8.62925665
1
38.41914135 2 8.71924452
H-QMC GEN 0 0
3
1.000000000000 1 25.000000000000
25.000000000000 3 10.821821902641
-8.228005709676 2 9.368618758833
H-QMC
$END
</pre></div>
</div>
</div>
</div>
<div class="section" id="appendix-b-convert4qmc">
<span id="lab-adv-mol-convert4qmc"></span><h2>Appendix B: convert4qmc<a class="headerlink" href="#appendix-b-convert4qmc" title="Permalink to this headline">¶</a></h2>
<p>To generate the particleset and wavefunction XML blocks required by QMCPACK in
calculations with molecular systems, the converter <code class="docutils literal notranslate"><span class="pre">convert4qmc</span></code> must be used. The converter
will read the standard output from the appropriate quantum chemistry calculation and will
generate all the necessary input for QMCPACK. In the following, we describe the main options of the
converter for GAMESS output. In general, there are three ways to use the converter depending
on the type of calculation performed. The minimum syntax for each option is shown subsequently.
For a description of the XML files produced by the converter, see <a class="reference internal" href="#lab-adv-mol-wf-appendix"><span class="std std-ref">Appendix E: Wavefunction XML block</span></a>.</p>
<ol class="arabic">
<li><p>For all single-determinant calculations (HF and DFT with any DFTTYP):</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">convert4qmc</span> <span class="o">-</span><span class="n">gamessAscii</span> <span class="n">single</span> <span class="n">det</span><span class="o">.</span><span class="n">out</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p>single det.out is the standard output generated by GAMESS.</p></li>
</ul>
</li>
<li><p><em>(This option is not recommended. Use the following option to avoid
mistakes.)</em> For multideterminant calculations where the orbitals and
configurations are read from different files (e.g., when using
orbitals from a MCSCF run and configurations from a subsequent CI
run):</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">convert4qmc</span> <span class="o">-</span><span class="n">gamessAscii</span> <span class="n">orbitals</span> <span class="n">multidet</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">ci</span> <span class="n">cicoeff</span>
<span class="n">multidet</span><span class="o">.</span><span class="n">out</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p>orbitals_multidet.out is the standard output from the calculation
that generates the orbitals. cicoeff multidet.out is the standard
output from the calculation that calculates the CI expansion.</p></li>
</ul>
</li>
<li><p>For multideterminant calculations where the orbitals and
configurations are read from the same file, using PRTMO=.T. in the
GUESS input block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">convert4qmc</span> <span class="o">-</span><span class="n">gamessAscii</span> <span class="n">multi</span> <span class="n">det</span><span class="o">.</span><span class="n">out</span> <span class="o">-</span><span class="n">ci</span> <span class="n">multi</span> <span class="n">det</span><span class="o">.</span><span class="n">out</span>
<span class="o">-</span><span class="n">readInitialGuess</span> <span class="n">Norb</span>
</pre></div>
</div>
<ul class="simple">
<li><p>multi_det.out is the standard output from the calculation that
calculates the CI expansion.</p></li>
</ul>
</li>
</ol>
<p>Options:</p>
<ul class="simple">
<li><p><strong>-gamessAscii file.out</strong>: Standard output of GAMESS calculation.
With the exception of determinant configurations and coefficients in
multideterminant calculations, everything else is read from this file
including atom coordinates, basis sets, SPOs, ECPs, number of
electrons, multiplicity, etc.</p></li>
<li><p><strong>-ci file.out</strong>: In multideterminant calculations, determinant
configurations and coefficients are read from this file. Notice that
SPOs are NOT read from this file. Recognized CI packages are ALDET,
GUGA, and ORMAS. Output produced with the GUGA package MUST have the
option “NPRT=2” in the CIDRT or DRT input blocks.</p></li>
<li><p><strong>-threshold cutoff</strong>: Cutoff in multideterminant expansion. Only
configurations with coefficients above this value are printed.</p></li>
<li><p><strong>-zeroCI</strong>: Sets to zero the CI coefficients of all determinants,
with the exception of the first one.</p></li>
<li><p><strong>-readInitialGuess Norb</strong>: Reads Norb initial orbitals (“INITIAL
GUESS ORBITALS”) from GAMESS output. These are orbitals generated by
the GUESS input block and printed with the option “PRTMO=.T.”. Notice
that this is useful only in combination with the option
“GUESS=MOREAD” and in cases where the orbitals are not modified in
the GAMESS calculation, e.g. CI runs. This is the recommended option
in all CI calculations.</p></li>
<li><p><strong>-NaturalOrbitals Norb</strong>: Read Norb “NATURAL ORBITALS” from GAMESS
output. The natural orbitals must exists in the output, otherwise the
code aborts.</p></li>
<li><p><strong>-add3BodyJ</strong>: Adds 3-body Jastrow terms (e-e-I) between electron
pairs (both same spin and opposite spin terms) and all ion species in
the system. The radial function is initialized to zero, and the
default cutoff is 10.0 bohr. The converter will add a 1- and 2-body
Jastrow to the wavefunction block by default.</p></li>
</ul>
<div class="section" id="useful-notes">
<h3>Useful notes<a class="headerlink" href="#useful-notes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>The type of SPOs read by the converter depends on the type of
calculation and on the options used. By default, when neither
-readInitialGuess nor -NaturalOrbitals are used, the following
orbitals are read in each case (notice that -readInitialGuess or
-NaturalOrbitals are mutually exclusive):</p>
<ul>
<li><p>RHF and ROHF: “EIGENVECTORS”</p></li>
<li><p>MCSCF: “MCSCF OPTIMIZED ORBITALS”</p></li>
<li><p>GUGA, ALDET, ORMAS: Cannot read orbitals without -readInitialGuess
or -NaturalOrbitals options.</p></li>
</ul>
</li>
<li><p>The SPOs and printed CI coefficients in MCSCF calculations are not
consistent in GAMESS. The printed CI coefficients correspond to the
next-to-last iteration; they are not recalculated with the final
orbitals. So to get appropriate CI coefficients from MCSCF
calculations, a subsequent CI (no SCF) calculation is needed to
produce consistent orbitals. In principle, it is possible to read the
orbitals from the MCSCF output and the CI coefficients and
configurations from the output of the following CI calculations. This
could lead to problems in principle since GAMESS will rotate initial
orbitals by default to obtain an initial guess consistent with the
symmetry of the molecule. This last step is done by default and can
change the orbitals reported in the MCSCF calculation before the CI
is performed. To avoid this problem, we highly recommend using the
preceding option #3 to read all the information from the output of
the CI calculation; this requires the use of “PRTMO=.T.” in the GUESS
input block. Since the orbitals are printed after any symmetry
rotation, the resulting output will always be consistent.</p></li>
</ul>
</div>
</div>
<div class="section" id="appendix-c-wavefunction-optimization-xml-block">
<span id="lab-adv-mol-opt-appendix"></span><h2>Appendix C: Wavefunction optimization XML block<a class="headerlink" href="#appendix-c-wavefunction-optimization-xml-block" title="Permalink to this headline">¶</a></h2>
<div class="literal-block-wrapper docutils container" id="listing-60">
<div class="code-block-caption"><span class="caption-number">Listing 60 </span><span class="caption-text">Sample XML optimization block.</span><a class="headerlink" href="#listing-60" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">&lt;</span><span class="n">loop</span> <span class="nb">max</span><span class="o">=</span><span class="s2">&quot;10&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">qmc</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span> <span class="n">move</span><span class="o">=</span><span class="s2">&quot;pbyp&quot;</span> <span class="n">checkpoint</span><span class="o">=</span><span class="s2">&quot;-1&quot;</span> <span class="n">gpu</span><span class="o">=</span><span class="s2">&quot;no&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;blocks&quot;</span><span class="o">&gt;</span>     <span class="mi">10</span>  <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;warmupsteps&quot;</span><span class="o">&gt;</span> <span class="mi">25</span> <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;steps&quot;</span><span class="o">&gt;</span> <span class="mi">1</span> <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;substeps&quot;</span><span class="o">&gt;</span> <span class="mi">20</span> <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;timestep&quot;</span><span class="o">&gt;</span> <span class="mf">0.5</span> <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;samples&quot;</span><span class="o">&gt;</span> <span class="mi">10240</span>  <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">cost</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;energy&quot;</span><span class="o">&gt;</span>                   <span class="mf">0.95</span> <span class="o">&lt;/</span><span class="n">cost</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">cost</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;unreweightedvariance&quot;</span><span class="o">&gt;</span>     <span class="mf">0.0</span> <span class="o">&lt;/</span><span class="n">cost</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">cost</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;reweightedvariance&quot;</span><span class="o">&gt;</span>       <span class="mf">0.05</span> <span class="o">&lt;/</span><span class="n">cost</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;useDrift&quot;</span><span class="o">&gt;</span>  <span class="n">yes</span> <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;bigchange&quot;</span><span class="o">&gt;</span><span class="mf">10.0</span><span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">estimator</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;LocalEnergy&quot;</span> <span class="n">hdf5</span><span class="o">=</span><span class="s2">&quot;no&quot;</span><span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;usebuffer&quot;</span><span class="o">&gt;</span> <span class="n">yes</span> <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;nonlocalpp&quot;</span><span class="o">&gt;</span> <span class="n">yes</span> <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;MinMethod&quot;</span><span class="o">&gt;</span><span class="n">quartic</span><span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;exp0&quot;</span><span class="o">&gt;-</span><span class="mi">6</span><span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;alloweddifference&quot;</span><span class="o">&gt;</span> <span class="mf">1.0e-5</span> <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;stepsize&quot;</span><span class="o">&gt;</span>  <span class="mf">0.15</span> <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;nstabilizers&quot;</span><span class="o">&gt;</span> <span class="mi">1</span> <span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">qmc</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">loop</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<p>Options:</p>
<ul class="simple">
<li><p>bigchange: (default 50.0) Largest parameter change allowed</p></li>
<li><p>usebuffer: (default no) Save useful information during VMC</p></li>
<li><p>nonlocalpp: (default no) Include nonlocal energy on 1-D min</p></li>
<li><p>MinMethod: (default quartic) Method to calculate magnitude of
parameter change quartic: fit quartic polynomial to four values of
the cost function obtained using reweighting along chosen direction
linemin: direct line minimization using reweighting rescale: no 1-D
minimization. Uses Umrigars suggestions.</p></li>
<li><p>stepsize: (default 0.25) Step size in either quartic or linemin
methods.</p></li>
<li><p>alloweddifference: (default 1e-4) Allowed increase in energy</p></li>
<li><p>exp0: (default -16.0) Initial value for stabilizer (shift to diagonal
of H). Actual value of stabilizer is 10 exp0</p></li>
<li><p>nstabilizers: (default 3) Number of stabilizers to try</p></li>
<li><p>stabilizaterScale: (default 2.0) Increase in value of exp0 between
iterations.</p></li>
<li><p>max its: (default 1) Number of inner loops with same sample</p></li>
<li><p>minwalkers: (default 0.3) Minimum value allowed for the ratio of
effective samples to actual number of walkers in a reweighting step.
The optimization will stop if the effective number of walkers in any
reweighting calculation drops below this value. Last set of
acceptable parameters are kept.</p></li>
<li><p>maxWeight: (defaul 1e6) Maximum weight allowed in reweighting. Any
weight above this value will be reset to this value.</p></li>
</ul>
<p>Recommendations:</p>
<ul class="simple">
<li><p>Set samples to equal to (#threads)*blocks.</p></li>
<li><p>Set steps to 1. Use substeps to control correlation between samples.</p></li>
<li><p>For cases where equilibration is slow, increase both substeps and
warmupsteps.</p></li>
<li><p>For hard cases (e.g., simultaneous optimization of long MSD and
3-Body J), set exp0 to 0 and do a single inner iteration (max its=1)
per sample of configurations.</p></li>
</ul>
</div>
<div class="section" id="appendix-d-vmc-and-dmc-xml-block">
<span id="lab-adv-mol-vmcdmc-appendix"></span><h2>Appendix D: VMC and DMC XML block<a class="headerlink" href="#appendix-d-vmc-and-dmc-xml-block" title="Permalink to this headline">¶</a></h2>
<div class="literal-block-wrapper docutils container" id="listing-61">
<div class="code-block-caption"><span class="caption-number">Listing 61 </span><span class="caption-text">Sample XML blocks for VMC and DMC calculations.</span><a class="headerlink" href="#listing-61" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">&lt;</span><span class="n">qmc</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;vmc&quot;</span> <span class="n">move</span><span class="o">=</span><span class="s2">&quot;pbyp&quot;</span> <span class="n">checkpoint</span><span class="o">=</span><span class="s2">&quot;-1&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;useDrift&quot;</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;warmupsteps&quot;</span><span class="o">&gt;</span><span class="mi">100</span><span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;blocks&quot;</span><span class="o">&gt;</span><span class="mi">100</span><span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;steps&quot;</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;substeps&quot;</span><span class="o">&gt;</span><span class="mi">20</span><span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;walkers&quot;</span><span class="o">&gt;</span><span class="mi">30</span><span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;timestep&quot;</span><span class="o">&gt;</span><span class="mf">0.3</span><span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">estimator</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;LocalEnergy&quot;</span> <span class="n">hdf5</span><span class="o">=</span><span class="s2">&quot;no&quot;</span><span class="o">/&gt;</span>
  <span class="o">&lt;/</span><span class="n">qmc</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">qmc</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;dmc&quot;</span> <span class="n">move</span><span class="o">=</span><span class="s2">&quot;pbyp&quot;</span> <span class="n">checkpoint</span><span class="o">=</span><span class="s2">&quot;-1&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;nonlocalmoves&quot;</span><span class="o">&gt;</span><span class="n">yes</span><span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;targetWalkers&quot;</span><span class="o">&gt;</span><span class="mi">1920</span><span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;blocks&quot;</span><span class="o">&gt;</span><span class="mi">100</span><span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;steps&quot;</span><span class="o">&gt;</span><span class="mi">100</span><span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;timestep&quot;</span><span class="o">&gt;</span><span class="mf">0.1</span><span class="o">&lt;/</span><span class="n">parameter</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">estimator</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;LocalEnergy&quot;</span> <span class="n">hdf5</span><span class="o">=</span><span class="s2">&quot;no&quot;</span><span class="o">/&gt;</span>
  <span class="o">&lt;/</span><span class="n">qmc</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<p>General Options:</p>
<ul class="simple">
<li><p><strong>move</strong>: (default “walker”) Type of electron move. Options: “pbyp”
and “walker.”</p></li>
<li><p><strong>checkpoint</strong>: (default “-1”) (If &gt; 0) Generate checkpoint files
with given frequency. The calculations can be restarted/continued
with the produced checkpoint files.</p></li>
<li><p><strong>useDrift</strong>: (default “yes”) Defines the sampling mode. useDrift =
“yes” will use Langevin acceleration to sample the VMC and DMC
distributions, while useDrift=“no” will use random displacements in a
box.</p></li>
<li><p><strong>warmupSteps</strong>: (default 0) Number of steps warmup steps at the
beginning of the calculation. No output is produced for these steps.</p></li>
<li><p><strong>blocks</strong>: (default 1) Number of blocks (outer loop).</p></li>
<li><p><strong>steps</strong>: (default 1) Number of steps per blocks (middle loop).</p></li>
<li><p><strong>sub steps</strong>: (default 1) Number of substeps per step (inner loop).
During substeps, the local energy is not evaluated in VMC
calculations, which leads to faster execution. In VMC calculations,
set substeps to the average autocorrelation time of the desired
quantity.</p></li>
<li><p><strong>time step</strong>: (default 0.1) Electronic time step in bohr.</p></li>
<li><p><strong>samples</strong>: (default 0) Number of walker configurations saved during
the current calculation.</p></li>
<li><p><strong>walkers</strong>: (default #threads) In VMC, sets the number of walkers
per node. The total number of walkers in the calculation will be
equal to walkers*(# nodes).</p></li>
</ul>
<p>Options unique to DMC:</p>
<ul class="simple">
<li><p><strong>targetWalkers</strong>: (default #walkers from previous calculation, e.g.,
VMC). Sets the target number of walkers. The actual population of
walkers will fluctuate around this value. The walkers will be
distributed across all the nodes in the calculation. On a given node,
the walkers are split across all the threads in the system.</p></li>
<li><p><strong>nonlocalmoves</strong>: (default “no”) Set to “yes” to turns on the use of
Casula’s T-moves.</p></li>
</ul>
</div>
<div class="section" id="appendix-e-wavefunction-xml-block">
<span id="lab-adv-mol-wf-appendix"></span><h2>Appendix E: Wavefunction XML block<a class="headerlink" href="#appendix-e-wavefunction-xml-block" title="Permalink to this headline">¶</a></h2>
<div class="literal-block-wrapper docutils container" id="listing-62">
<div class="code-block-caption"><span class="caption-number">Listing 62 </span><span class="caption-text">Basic framework for a single-determinant determinantset XML block.</span><a class="headerlink" href="#listing-62" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">&lt;</span><span class="n">wavefunction</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;psi0&quot;</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;e&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">determinantset</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;MolecularOrbital&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;LCAOBSet&quot;</span>
     <span class="n">source</span><span class="o">=</span><span class="s2">&quot;ion0&quot;</span> <span class="n">transform</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">basisset</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;LCAOBSet&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">atomicBasisSet</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Gaussian-G2&quot;</span> <span class="n">angular</span><span class="o">=</span><span class="s2">&quot;cartesian&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Gaussian&quot;</span> <span class="n">elementType</span><span class="o">=</span><span class="s2">&quot;O&quot;</span> <span class="n">normalized</span><span class="o">=</span><span class="s2">&quot;no&quot;</span><span class="o">&gt;</span>
        <span class="o">...</span>
        <span class="o">&lt;/</span><span class="n">atomicBasisSet</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">basisset</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">slaterdeterminant</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">determinant</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;updet&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;4&quot;</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="n">occupation</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span><span class="o">/&gt;</span>
          <span class="o">&lt;</span><span class="n">coefficient</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;57&quot;</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;updetC&quot;</span><span class="o">&gt;</span>
          <span class="o">...</span>
          <span class="o">&lt;/</span><span class="n">coefficient</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">determinant</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">determinant</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;downdet&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;4&quot;</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="n">occupation</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span><span class="o">/&gt;</span>
          <span class="o">&lt;</span><span class="n">coefficient</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;57&quot;</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;downdetC&quot;</span><span class="o">&gt;</span>
          <span class="o">...</span>
          <span class="o">&lt;/</span><span class="n">coefficient</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">determinant</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">slaterdeterminant</span><span class="o">&gt;</span>

    <span class="o">&lt;/</span><span class="n">determinantset</span><span class="o">&gt;</span>

    <span class="o">&lt;</span><span class="n">jastrow</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;J2&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Two-Body&quot;</span> <span class="n">function</span><span class="o">=</span><span class="s2">&quot;Bspline&quot;</span> <span class="nb">print</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="o">&gt;</span>
    <span class="o">...</span>
    <span class="o">&lt;/</span><span class="n">jastrow</span><span class="o">&gt;</span>

  <span class="o">&lt;/</span><span class="n">wavefunction</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<p>In this section we describe the basic format of a QMCPACK wavefunction XML block.
Everything listed in this section is generated by the appropriate converter tools. Little to
no modification is needed when performing standard QMC calculations. As a result, this
section is meant mainly for illustration purposes. Only experts should attempt to modify
these files (with very few exceptions like the cutoff of CI coefficients and the cutoff in Jastrow
functions) since changes can lead to unexpected results.</p>
<p>A QMCPACK wavefunction XML block is a combination of a determinantset,
which contains the antisymmetric part of the wavefunction and one or
more Jastrow blocks. The syntax of the antisymmetric block depends on
whether the wavefunction is a single determinant or a multideterminant
expansion. <a class="reference internal" href="#listing-62"><span class="std std-ref">Listing 62</span></a> shows the general
structure of the single-determinant case. The determinantset block is
composed of a basisset block, which defines the atomic orbital basis
set, and a slaterdeterminant block, which defines the SPOs and
occupation numbers of the Slater determinant.
<a class="reference internal" href="#listing-63"><span class="std std-ref">Listing 63</span></a> shows a (piece of a) sample
of a slaterdeterminant block. The slaterdeterminant block consists of
two determinant blocks, one for each electron spin. The parameter “size”
in the determinant block refers to the number of SPOs present while the
“size” parameter in the coefficient block refers to the number of atomic
basis functions per SPO.</p>
<div class="literal-block-wrapper docutils container" id="listing-63">
<div class="code-block-caption"><span class="caption-number">Listing 63 </span><span class="caption-text">Sample XML block for the single Slater determinant case.</span><a class="headerlink" href="#listing-63" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="o">&lt;</span><span class="n">slaterdeterminant</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">determinant</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;updet&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;5&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">occupation</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span><span class="o">/&gt;</span>
        <span class="o">&lt;</span><span class="n">coefficient</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;134&quot;</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;updetC&quot;</span><span class="o">&gt;</span>
  <span class="mf">9.55471000000000e-01</span> <span class="o">-</span><span class="mf">3.87000000000000e-04</span>  <span class="mf">6.51140000000000e-02</span>  <span class="mf">2.17700000000000e-03</span>
  <span class="mf">1.43900000000000e-03</span>  <span class="mf">4.00000000000000e-06</span> <span class="o">-</span><span class="mf">4.58000000000000e-04</span> <span class="o">-</span><span class="mf">5.20000000000000e-05</span>
  <span class="o">-</span><span class="mf">2.40000000000000e-05</span>  <span class="mf">6.00000000000000e-06</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span>
  <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span>
  <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span>
  <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span>
  <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span>
  <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span>
  <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span>
  <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">5.26000000000000e-04</span>  <span class="mf">2.63000000000000e-04</span>  <span class="mf">2.63000000000000e-04</span>
  <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">1.27000000000000e-04</span>
  <span class="mf">6.30000000000000e-05</span>  <span class="mf">6.30000000000000e-05</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span>
  <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">3.20000000000000e-05</span>  <span class="mf">1.60000000000000e-05</span>  <span class="mf">1.60000000000000e-05</span>
  <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span> <span class="o">-</span><span class="mf">0.00000000000000e+00</span>  <span class="mf">7.00000000000000e-06</span>
</pre></div>
</div>
</div>
<p><a class="reference internal" href="#listing-64"><span class="std std-ref">Listing 64</span></a> shows the general structure of the multideterminant case.
Similar to the
single-determinant case, the determinantset must contain a basisset block. This definition is
identical to the one described previously. In this case, the definition of the SPOs
must be done independently from the definition of the determinant configurations; the latter
is done in the sposet block, while the former is done on the multideterminant block. Notice
that two sposet sets must be defined, one for each electron spin. The name of each sposet set
is required in the definition of the multideterminant block. The determinants are defined in
terms of occupation numbers based on these orbitals.</p>
<div class="literal-block-wrapper docutils container" id="listing-64">
<div class="code-block-caption"><span class="caption-number">Listing 64 </span><span class="caption-text">Basic framework for a multideterminant determinantset XML block.</span><a class="headerlink" href="#listing-64" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">&lt;</span><span class="n">wavefunction</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;psi0&quot;</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;e&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">determinantset</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;LCAOBSet&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;MolecularOrbital&quot;</span> <span class="n">transform</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;ion0&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">basisset</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;LCAOBSet&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">atomicBasisSet</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Gaussian-G2&quot;</span> <span class="n">angular</span><span class="o">=</span><span class="s2">&quot;cartesian&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Gaussian&quot;</span> <span class="n">elementType</span><span class="o">=</span><span class="s2">&quot;O&quot;</span> <span class="n">normalized</span><span class="o">=</span><span class="s2">&quot;no&quot;</span><span class="o">&gt;</span>
        <span class="o">...</span>
        <span class="o">&lt;/</span><span class="n">atomicBasisSet</span><span class="o">&gt;</span>
        <span class="o">...</span>
      <span class="o">&lt;/</span><span class="n">basisset</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">sposet</span> <span class="n">basisset</span><span class="o">=</span><span class="s2">&quot;LCAOBSet&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;spo-up&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;8&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">occupation</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span><span class="o">/&gt;</span>
        <span class="o">&lt;</span><span class="n">coefficient</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;40&quot;</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;updetC&quot;</span><span class="o">&gt;</span>
        <span class="o">...</span>
<span class="o">&lt;/</span><span class="n">coefficient</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">sposet</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">sposet</span> <span class="n">basisset</span><span class="o">=</span><span class="s2">&quot;LCAOBSet&quot;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;spo-dn&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;8&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">occupation</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span><span class="o">/&gt;</span>
        <span class="o">&lt;</span><span class="n">coefficient</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;40&quot;</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;downdetC&quot;</span><span class="o">&gt;</span>
        <span class="o">...</span>
      <span class="o">&lt;/</span><span class="n">coefficient</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">sposet</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">multideterminant</span> <span class="n">optimize</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span> <span class="n">spo_up</span><span class="o">=</span><span class="s2">&quot;spo-up&quot;</span> <span class="n">spo_dn</span><span class="o">=</span><span class="s2">&quot;spo-dn&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">detlist</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;97&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;CSF&quot;</span> <span class="n">nca</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="n">ncb</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="n">nea</span><span class="o">=</span><span class="s2">&quot;4&quot;</span> <span class="n">neb</span><span class="o">=</span><span class="s2">&quot;4&quot;</span> <span class="n">nstates</span><span class="o">=</span><span class="s2">&quot;8&quot;</span> <span class="n">cutoff</span><span class="o">=</span><span class="s2">&quot;0.001&quot;</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="n">csf</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;CSFcoeff_0&quot;</span> <span class="n">exctLvl</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="n">coeff</span><span class="o">=</span><span class="s2">&quot;0.984378&quot;</span> <span class="n">qchem_coeff</span><span class="o">=</span><span class="s2">&quot;0.984378&quot;</span> <span class="n">occ</span><span class="o">=</span><span class="s2">&quot;22220000&quot;</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">det</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;csf_0-0&quot;</span> <span class="n">coeff</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="n">alpha</span><span class="o">=</span><span class="s2">&quot;11110000&quot;</span> <span class="n">beta</span><span class="o">=</span><span class="s2">&quot;11110000&quot;</span><span class="o">/&gt;</span>
          <span class="o">&lt;/</span><span class="n">csf</span><span class="o">&gt;</span>
          <span class="o">...</span>
        <span class="o">&lt;/</span><span class="n">detlist</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">multideterminant</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">determinantset</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">jastrow</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;J2&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Two-Body&quot;</span> <span class="n">function</span><span class="o">=</span><span class="s2">&quot;Bspline&quot;</span> <span class="nb">print</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="o">&gt;</span>
    <span class="o">...</span>
    <span class="o">&lt;/</span><span class="n">jastrow</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">wavefunction</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<p>There are various options in the multideterminant block that users
should be aware of.</p>
<ul class="simple">
<li><p>cutoff: (IMPORTANT! ) Only configurations with (absolute value)
“qchem coeff” larger than this value will be read by QMCPACK.</p></li>
<li><p>optimize: Turn on/off the optimization of linear CI coefficients.</p></li>
<li><p>coeff: (in csf ) Current coefficient of given configuration. Gets
updated during wavefunction optimization.</p></li>
<li><p>qchem coeff: (in csf ) Original coefficient of given configuration
from GAMESS calculation. This is used when applying a cutoff to the
configurations read from the file. The cutoff is applied on this
parameter and not on the optimized coefficient.</p></li>
<li><p>nca and nab: Number of core orbitals for up/down electrons. A core
orbital is an orbital that is doubly occupied in all determinant
configurations, not to be confused with core electrons. These are not
explicitly listed on the definition of configurations.</p></li>
<li><p>nea and neb: Number of up/down active electrons (those being
explicitly correlated).</p></li>
<li><p>nstates: Number of correlated orbitals.</p></li>
<li><p>size (in detlist ): Contains the number of configurations in the
list.</p></li>
</ul>
<p>The remaining part of the determinantset block is the definition of Jastrow factor. Any
number of these can be defined. <a class="reference internal" href="#listing-65"><span class="std std-ref">Listing 65</span></a> shows a sample Jastrow
block including 1-, 2- and 3-body terms. This is the standard block produced by
<code class="docutils literal notranslate"><span class="pre">convert4qmc</span></code> with the option -add3BodyJ (this particular example is for a water molecule).
Optimization of individual radial functions can be turned on/off using the “optimize”
parameter. It can be added to any coefficients block, even though it is currently not
present in the J1 and J2 blocks.</p>
<div class="literal-block-wrapper docutils container" id="listing-65">
<div class="code-block-caption"><span class="caption-number">Listing 65 </span><span class="caption-text">Sample Jastrow XML block.</span><a class="headerlink" href="#listing-65" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">jastrow</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;J2&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Two-Body&quot;</span> <span class="n">function</span><span class="o">=</span><span class="s2">&quot;Bspline&quot;</span> <span class="nb">print</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">correlation</span> <span class="n">rcut</span><span class="o">=</span><span class="s2">&quot;10&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;10&quot;</span> <span class="n">speciesA</span><span class="o">=</span><span class="s2">&quot;u&quot;</span> <span class="n">speciesB</span><span class="o">=</span><span class="s2">&quot;u&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">coefficients</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;uu&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Array&quot;</span><span class="o">&gt;</span><span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span><span class="o">&lt;/</span><span class="n">coefficients</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">correlation</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">correlation</span> <span class="n">rcut</span><span class="o">=</span><span class="s2">&quot;10&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;10&quot;</span> <span class="n">speciesA</span><span class="o">=</span><span class="s2">&quot;u&quot;</span> <span class="n">speciesB</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">coefficients</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;ud&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Array&quot;</span><span class="o">&gt;</span><span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span><span class="o">&lt;/</span><span class="n">coefficients</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">correlation</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">jastrow</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">jastrow</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;J1&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;One-Body&quot;</span> <span class="n">function</span><span class="o">=</span><span class="s2">&quot;Bspline&quot;</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;ion0&quot;</span> <span class="nb">print</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">correlation</span> <span class="n">rcut</span><span class="o">=</span><span class="s2">&quot;10&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;10&quot;</span> <span class="n">cusp</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="n">elementType</span><span class="o">=</span><span class="s2">&quot;O&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">coefficients</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;eO&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Array&quot;</span><span class="o">&gt;</span><span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span><span class="o">&lt;/</span><span class="n">coefficients</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">correlation</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">correlation</span> <span class="n">rcut</span><span class="o">=</span><span class="s2">&quot;10&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;10&quot;</span> <span class="n">cusp</span><span class="o">=</span><span class="s2">&quot;0&quot;</span> <span class="n">elementType</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">coefficients</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;eH&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Array&quot;</span><span class="o">&gt;</span><span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span><span class="o">&lt;/</span><span class="n">coefficients</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">correlation</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">jastrow</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">jastrow</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;J3&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;eeI&quot;</span> <span class="n">function</span><span class="o">=</span><span class="s2">&quot;polynomial&quot;</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;ion0&quot;</span> <span class="nb">print</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">correlation</span> <span class="n">ispecies</span><span class="o">=</span><span class="s2">&quot;O&quot;</span> <span class="n">especies</span><span class="o">=</span><span class="s2">&quot;u&quot;</span> <span class="n">isize</span><span class="o">=</span><span class="s2">&quot;3&quot;</span> <span class="n">esize</span><span class="o">=</span><span class="s2">&quot;3&quot;</span> <span class="n">rcut</span><span class="o">=</span><span class="s2">&quot;10&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">coefficients</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;uuO&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Array&quot;</span> <span class="n">optimize</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">coefficients</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">correlation</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">correlation</span> <span class="n">ispecies</span><span class="o">=</span><span class="s2">&quot;O&quot;</span> <span class="n">especies1</span><span class="o">=</span><span class="s2">&quot;u&quot;</span> <span class="n">especies2</span><span class="o">=</span><span class="s2">&quot;d&quot;</span> <span class="n">isize</span><span class="o">=</span><span class="s2">&quot;3&quot;</span> <span class="n">esize</span><span class="o">=</span><span class="s2">&quot;3&quot;</span> <span class="n">rcut</span><span class="o">=</span><span class="s2">&quot;10&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">coefficients</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;udO&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Array&quot;</span> <span class="n">optimize</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">coefficients</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">correlation</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">correlation</span> <span class="n">ispecies</span><span class="o">=</span><span class="s2">&quot;H&quot;</span> <span class="n">especies</span><span class="o">=</span><span class="s2">&quot;u&quot;</span> <span class="n">isize</span><span class="o">=</span><span class="s2">&quot;3&quot;</span> <span class="n">esize</span><span class="o">=</span><span class="s2">&quot;3&quot;</span> <span class="n">rcut</span><span class="o">=</span><span class="s2">&quot;10&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">coefficients</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;uuH&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Array&quot;</span> <span class="n">optimize</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">coefficients</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">correlation</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">correlation</span> <span class="n">ispecies</span><span class="o">=</span><span class="s2">&quot;H&quot;</span> <span class="n">especies1</span><span class="o">=</span><span class="s2">&quot;u&quot;</span> <span class="n">especies2</span><span class="o">=</span><span class="s2">&quot;d&quot;</span> <span class="n">isize</span><span class="o">=</span><span class="s2">&quot;3&quot;</span> <span class="n">esize</span><span class="o">=</span><span class="s2">&quot;3&quot;</span> <span class="n">rcut</span><span class="o">=</span><span class="s2">&quot;10&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">coefficients</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;udH&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Array&quot;</span> <span class="n">optimize</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">coefficients</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">correlation</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">jastrow</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<p>This training assumes basic familiarity with the UNIX operating system. In particular,
we use simple scripts written in “csh.” In addition, we assume you have obtained
all the necessary files and executables and that the training files are located
at ${TRAINING TOP}.</p>
<p>The goal of this training is not only to familiarize you with the execution and
options in QMCPACK but also to introduce you to important concepts in QMC calculations and many-body electronic structure calculations.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="lab_condensed_matter.html" class="btn btn-neutral float-right" title="Lab 4: Condensed Matter Calculations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="lab_qmc_basics.html" class="btn btn-neutral float-left" title="Lab 2: QMC Basics" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, QMCPACK Developers

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>